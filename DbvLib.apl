.head 0 +  Application Description: Centura SQLWindows Standard Application Template
.head 1 -  Outline Version - 4.0.28
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000002A0100 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: D4180909B80B1A00
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? No
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.575"
.head 3 -  Top: 0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 6.388"
.head 3 -  Top: 0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  File Include: XSalTab_32.apl
.head 2 -  File Include: XSalscr_32.apl
.head 2 -  File Include: XSalTtp_32.apl
.head 2 -  File Include: XSalTlb_32.apl
.head 2 -  File Include: XSalSpl_32.apl
.head 2 -  File Include: XSalCpt_32.apl
.head 2 -  File Include: XSalUdv_32.apl
.head 2 -  File Include: Microsoft XML.apl
.head 2 -  File Include: qcktabs.apl
.head 2 -  File Include: WindowsSDKFunctions.apl
.head 2 -  File Include: WindowsSDKConstants.apl
.head 2 -  File Include: SonMeter.apl
.head 2 -  File Include: vtcomm.apl
.head 2 -  File Include: vtArray.apl
.head 2 -  File Include: vttblwin.apl
.head 2 -  File Include: vtdos.apl
.head 2 -  File Include: vtstr.apl
.head 2 -  File Include: vtfile.apl
.head 2 -  File Include: printing.apl
.head 2 -  File Include: SalTbl.apl
.head 2 -  File Include: CDK.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  Number: PCCLASS_FIELD_SetCurrent = 1
.head 4 -  Number: PCCLASS_FIELD_GetValue = 2
.head 4 -  Number: PCCLASS_FIELD_COMPONENTEEDITADO = 3
.head 4 -  Number: DB_Insert = 11
.head 4 -  Number: DB_Delete = 22
.head 4 -  Number: DB_Update = 33
.head 4 -  Number: WM_MOUSEWHEEL = 0x020A
.head 4 -  Number: SON_TYPE_Smallint = 1
.head 4 -  String: SON_NAME_Smallint = 'Smallint'
.head 4 -  Number: SON_COLOR_Smallint = COLOR_LightGray
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_Integer = 2
.head 4 -  String: SON_NAME_Integer = 'Integer'
.head 4 -  Number: SON_COLOR_Integer = COLOR_Maize
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_Decimal = 3
.head 4 -  String: SON_NAME_Decimal = 'Decimal'
.head 4 -  Number: SON_COLOR_Decimal = COLOR_Sky
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_DateTime = 4
.head 4 -  String: SON_NAME_DateTime = 'Date/Time'
.head 4 -  Number: SON_COLOR_DateTime = 12829685
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_Char = 5
.head 4 -  String: SON_NAME_Char = 'Char'
.head 4 -  Number: SON_COLOR_Char = COLOR_LightGray
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_Varchar2 = 6
.head 4 -  String: SON_NAME_Varchar2 = 'Varchar2'
.head 4 -  Number: SON_COLOR_Varchar2 = COLOR_LightGreen
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_Blob = 7
.head 4 -  String: SON_NAME_Blob = 'Blob'
.head 4 -  Number: SON_COLOR_Blob = 16435450
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_Clob = 8
.head 4 -  String: SON_NAME_Clob = 'Clob'
.head 4 -  Number: SON_COLOR_Clob = COLOR_LightPeriwinkle
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_Long = 9
.head 4 -  String: SON_NAME_Long = 'Long'
.head 4 -  Number: SON_COLOR_Long = 6579455
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_Varbinary = 10
.head 4 -  String: SON_NAME_Varbinary = 'Varbinary'
.head 4 -  Number: SON_COLOR_Varbinary = 15651031
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_Autoincrement = 11
.head 4 -  String: SON_NAME_Autoincrement = 'Autoincrement'
.head 4 -  Number: SON_COLOR_Autoincrement = 10005498
.head 4 -  ! ! !
.head 4 -  Number: SON_TYPE_Blob_Java = 12
.head 4 -  String: SON_NAME_Blob_Java = 'Blob Java'
.head 4 -  Number: SON_COLOR_Blob_Java = COLOR_Salmon
.head 4 -  ! ! ! ! Constantes de Controle de Erro
.head 4 -  Number: ERRO = 0
.head 4 -  Number: ERRO_SQL = 1
.head 4 -  Number: ERRO_INTEGRIDADE = 2
.head 4 -  Number: ERRO_FATAL = 3
.head 3 -  Enumerations
.head 2 -  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 4214296097
0000: 120100006D000000 0000000000000000 02000009000000B8 0300001019000000
0020: 010000FE00FFA3D1 030019B5000100FF FF68EA03001900ED 0100FF3F03045800
0040: 00190001FB00FF8F 1C0400D6190001FE 00FFA335040019B5 000100FFFF684E04
0060: 001900ED0100FF3F 67045A00190001FB 00FF8F8004005619 000100FE00FF03
.enddata
.head 3 -  Window Handle: hWndToolBar
.head 3 -  Window Handle: hWndDataFieldAnterior
.head 3 -  Window Handle: hWndValidate
.head 3 -  Sql Handle: hSql
.head 3 -  Sql Handle: hSql2
.head 3 -  Sql Handle: hSql3
.head 3 -  Number: nFetch
.head 3 -  Number: nFetch1
.head 3 -  Number: nSonCorObjetoSelecionado
.head 3 -  String: sJanelaAtual
.head 3 -  Number: nJanelaHandle
.head 3 -  Boolean: bDestroyForm
.head 3 -  String: sgCaminhoImagens
.head 3 -  FunctionalVar: oConfiguracao
.head 4 -  Class: fcConfiguracao
.head 3 -  FunctionalVar: oErro
.head 4 -  Class: cErro
.head 3 -  Number: ngAmbiente
.head 2 +  Internal Functions
.head 3 +  Function: RetiraMarcasGeral
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sValor
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sValor = VisStrSubstitute( sValor, '.', '' )
.head 5 -  Set sValor = VisStrSubstitute( sValor, '-', '' )
.head 5 -  Set sValor = VisStrSubstitute( sValor, '/', '' )
.head 5 -  Set sValor = VisStrSubstitute( sValor, '=', '' )
.head 5 -  Set sValor = VisStrSubstitute( sValor, ';', '' )
.head 5 -  Set sValor = VisStrSubstitute( sValor, ':', '' )
.head 5 -  Set sValor = VisStrSubstitute( sValor, 'º', '' )
.head 5 -  Set sValor = VisStrSubstitute( sValor, ',', '' )
.head 5 -  Set sValor = VisStrSubstitute( sValor, '"', '' )
.head 5 -  Set sValor = VisStrSubstitute( sValor, '\'', '' )
.head 5 -  Return sValor
.head 3 +  Function: SalWindowRight
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndJanela
.head 5 -  Window Handle: hWndPai
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nX
.head 5 -  Number: nY
.head 5 -  Number: nX2
.head 5 -  Number: nY2
.head 5 -  Number: nXPai
.head 5 -  Number: nYPai
.head 5 -  Number: nX2Pai
.head 5 -  Number: nY2Pai
.head 4 +  Actions
.head 5 -  Call GetWindowRect( hWndJanela, nX, nY, nX2, nY2 )
.head 5 -  Call GetWindowRect( hWndPai, nXPai, nYPai, nX2Pai, nY2Pai )
.head 5 -  !
.head 5 -  Set nX = (nX2Pai - nXPai) - (nX2 - nX) - 20
.head 5 -  !
.head 5 -  Set nX = SalPixelsToFormUnits ( hWndJanela, nX, FALSE )
.head 5 -  Call SalGetWindowLoc( hWndJanela, nX2, nY )
.head 5 -  Call SalSetWindowLoc( hWndJanela, nX, nY )
.head 3 +  Function: SalMsgErro
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: s
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalMessageBox( s, 'Erro', MB_IconStop )
.head 5 -  Return TRUE
.head 3 +  Function: SalMsgExclama
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: s
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalMessageBox( s , 'Atenção', 48 )
.head 5 -  Return TRUE
.head 3 +  Function: SalMsgPergunta
.head 4 -  Description: Retorna TRUE Para Sim e FALSE para NAO
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: s
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalMessageBox( s, 'Atenção', MB_IconQuestion | MB_YesNo ) = IDYES
.head 6 -  Return TRUE
.head 5 -  Return FALSE
.head 3 +  Function: isNullNumber
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: npVariavel
.head 5 -  Number: npRetornoCasoNulo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If npVariavel = NUMBER_Null
.head 6 -  Return npRetornoCasoNulo
.head 5 -  Return npVariavel
.head 3 +  Function: isNullString
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: spVariavel
.head 5 -  String: spRetornoCasoNulo
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If spVariavel = STRING_Null
.head 6 -  Return spRetornoCasoNulo
.head 5 -  Return spVariavel
.head 3 -  ! ! --- Complementos SAL e outras
.head 3 +  Function: SalTblCountRowX
.head 4 -  Description: Retorna o Numero de Linhas de uma tabela
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTabela
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nConta
.head 4 +  Actions
.head 5 -  Set nConta = 0
.head 5 +  While SalTblSetContext( hWndTabela, nConta )
.head 6 -  Set nConta = nConta + 1
.head 5 -  Return nConta
.head 3 +  Function: SalTblCountRow 
.head 4 -  Description: Retorna o numero de linhas existente em uma tabela.

NOTA: Esta funcao nao pede ser usada quando uma tabela for populada por
SalTblPopulate ou
Tabelas criadas com colunas dinamicas, etc
Para estes casos vc deve usar SalTblCountRowX
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTbl
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinha
.head 4 +  Actions
.head 5 -  Set nLinha = TBL_MaxRow
.head 5 -  Call SalTblFindPrevRow( hWndTbl, nLinha, 0, 0 )
.head 5 +  If nLinha = TBL_MaxRow
.head 6 -  Return 0
.head 5 -  Return nLinha + 1
.head 3 +  Function: SalTblBuscaBinariaSelect
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: tblTabela	! -- Hendle da Tabela
.head 5 -  Number: nIDCol		! -- Numero da coluna a a ser comparada
.head 5 -  Number: nPrimeiro		! -- Primeira linta da tabela
.head 5 -  Number: nUltimo		! -- Numero da maior linha da tabela
.head 5 -  String: sElemento		! -- Elemente a ser procurado na tabela
.head 5 -  Boolean: bProcuraMais	! -- Deve ser: 0 se na tabela existir somente um sElemento, 1 se ouver mais de um
.head 5 -  Boolean: bMeiaPalavra	! -- Deve ser: 1 quando para a procura parar quanco for encontrado a palavra no inicio de uma frase
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sElemenTbl
.head 5 -  Number: nLinha
.head 5 -  Number: nTamanho
.head 4 +  Actions
.head 5 -  Set sElemento = SalStrUpperX( SalStrTrimX( sElemento ) )
.head 5 -  Set nTamanho = SalStrLength( sElemento )
.head 5 +  Loop
.head 6 +  If nPrimeiro > nUltimo
.head 7 -  Return -1
.head 6 -  Set nLinha = SalNumberTruncate( ( nPrimeiro + nUltimo ) / 2, 20, 0 )
.head 6 +  If SalTblSetContext( tblTabela, nLinha )
.head 7 -  Call SalTblGetColumnText( tblTabela, nIDCol, sElemenTbl )
.head 7 -  Set sElemenTbl = SalStrUpperX( SalStrTrimX( sElemenTbl ) )
.head 7 +  If bMeiaPalavra
.head 8 -  Set sElemenTbl = SalStrLeftX( sElemenTbl, nTamanho )
.head 7 -  !
.head 7 +  If sElemento = sElemenTbl
.head 8 -  Break
.head 7 +  Else If sElemento  > sElemenTbl
.head 8 -  Set nPrimeiro = nLinha + 1
.head 7 +  Else
.head 8 -  Set nUltimo = nLinha - 1
.head 6 +  Else
.head 7 -  Return -1
.head 5 +  If bProcuraMais
.head 6 +  While SalTblSetContext( tblTabela, nLinha )
.head 7 -  Call SalTblGetColumnText( tblTabela, nIDCol, sElemenTbl )
.head 7 -  Set sElemenTbl = SalStrUpperX( SalStrTrimX( sElemenTbl ) )
.head 7 +  If bMeiaPalavra
.head 8 -  Set sElemenTbl = SalStrLeftX( sElemenTbl, nTamanho )
.head 7 -  !
.head 7 +  If sElemento != sElemenTbl
.head 8 -  Set nLinha = nLinha + 1
.head 8 -  Call SalTblSetContext( tblTabela, nLinha )
.head 8 -  Break
.head 7 -  Set nLinha = nLinha - 1
.head 7 +  If nLinha < 0
.head 8 -  Set nLinha = 0
.head 8 -  Break
.head 5 -  Return nLinha
.head 3 +  Function: SalTblLinhaDuplicada
.head 4 -  Description: Verifica se existe na tabela alguma linha igual à desejada.
Serão verificadas as colunas especificadas em sColunas -> '1,4,6,7' ou 'colCodigo,colNome'
Se sColunas é nulo, serão comparadas todas as colunas.
Retorno:
	nLinha 	-> Posição da Linha repetida
	-1 	-> Não existem linhas duplicadas
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: tblTabela
.head 5 -  Number: nLinhaParam
.head 5 -  String: sColunas
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinha
.head 5 -  Number: nLinhaAtual
.head 5 -  Number: nColuna
.head 5 -  Number: nTotalColunas
.head 5 -  String: saValores[*]
.head 5 -  String: sValor
.head 5 -  Window Handle: hWndColuna
.head 5 -  Boolean: bIgual
.head 5 -  Boolean: bOk
.head 5 -  String: saColunas[*]
.head 5 -  Number: naColunas[*]
.head 5 -  Number: nCol
.head 4 +  Actions
.head 5 -  Set nLinhaAtual = SalTblQueryContext( tblTabela )
.head 5 -  !
.head 5 -  Set nLinha = 0
.head 5 -  Call SalTblSetContext( tblTabela, nLinhaParam )
.head 5 -  !
.head 5 -  Set nTotalColunas = SalStrTokenize( sColunas, '', ',', saColunas )
.head 5 -  Set nCol = 0
.head 5 -  Set nColuna = 1
.head 5 -  Set hWndColuna = SalTblGetColumnWindow( tblTabela, nColuna, COL_GetPos )
.head 5 +  While hWndColuna != hWndNULL
.head 6 -  Set bOk = FALSE
.head 6 +  If VisArrayFindString( saColunas, SalNumberToStrX( nColuna, 0 ) ) >= 0
.head 7 -  Set bOk = TRUE
.head 6 +  Else
.head 7 -  Call SalGetItemName( hWndColuna, sValor )
.head 7 +  If VisArrayFindString( saColunas, SalStrTrimX( sValor ) ) >= 0
.head 8 -  Set bOk = TRUE
.head 6 +  If bOk
.head 7 -  Call SalTblGetColumnText( tblTabela, nColuna, saValores[ nCol ] )
.head 7 -  Set naColunas[ nCol ] = nColuna
.head 7 -  Set nCol = nCol + 1
.head 6 -  Set nColuna = nColuna + 1
.head 6 -  Set hWndColuna = SalTblGetColumnWindow( tblTabela, nColuna, COL_GetPos )
.head 5 -  Set nTotalColunas = nCol
.head 5 -  !
.head 5 -  !
.head 5 -  Set nLinha = 0
.head 5 +  While SalTblSetContext( tblTabela, nLinha )
.head 6 +  If nLinha != nLinhaParam
.head 7 -  Set bIgual = TRUE
.head 7 -  Set nColuna = 0
.head 7 +  While nColuna < nTotalColunas
.head 8 -  Call SalTblGetColumnText( tblTabela, naColunas[ nColuna ], sValor )
.head 8 +  If saValores[ nColuna ] != sValor
.head 9 -  Set bIgual = FALSE
.head 9 -  Break
.head 8 -  Set nColuna = nColuna + 1
.head 7 +  If bIgual
.head 8 -  Call SalTblSetFlagsAnyRows( tblTabela, ROW_Selected, FALSE, 0, 0 )
.head 8 -  Call SalTblSetRowFlags( tblTabela, nLinhaParam, ROW_Selected, TRUE )
.head 8 -  Call SalTblSetRowFlags( tblTabela, nLinha, ROW_Selected, TRUE )
.head 8 -  Call SalTblScroll( tblTabela, nLinha, hWndNULL, TBL_ScrollTop  )
.head 8 -  Call SalTblSetContext( tblTabela, nLinhaAtual )
.head 8 -  Return nLinha
.head 6 -  Set nLinha = nLinha + 1
.head 5 -  Call SalTblSetContext( tblTabela, nLinhaAtual )
.head 5 -  Return -1
.head 3 +  Function: SalTblAlgumaLinhaDuplicada
.head 4 -  Description: Verifica se existe na tabela alguma linha duplicada.
Serão verificadas as colunas especificadas em sColunas -> '1,4,6,7' ou 'colCodigo,colNome'
Se sColunas é nulo, serão comparadas todas as colunas.
Se bUsarCores = TRUE -> As linhas duplicadas serão agrupadas em cores (até 10 grupos)
Retorno:  TRUE se existe linha duplicada
	FALSE se não existe nenhuma linha duplicada
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: tblTabela
.head 5 -  String: sColunas
.head 5 -  Boolean: bUsarCores
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Linhas
.head 5 -  Number: nLinha
.head 5 -  Number: nLinha2
.head 5 -  Number: nLinhaAtual
.head 5 -  Number: nLinhaDup
.head 5 -  ! Coluna
.head 5 -  Boolean: bIgual
.head 5 -  Boolean: bOk
.head 5 -  Number: nCol
.head 5 -  Number: nColuna
.head 5 -  Number: nTotalColunas
.head 5 -  Number: naColunas[*]
.head 5 -  Number: naLinhasDuplicadas[*]
.head 5 -  String: sValor
.head 5 -  String: saColunas[*]
.head 5 -  String: saValores[*]
.head 5 -  String: saValoresOrigem[*]
.head 5 -  Window Handle: hWndColuna
.head 5 -  !
.head 5 -  Number: nCor
.head 5 -  Number: nIndCor
.head 5 -  Number: naCores[*]
.head 4 +  Actions
.head 5 +  If bUsarCores
.head 6 -  Set naCores[0] = SalColorFromRGB( 250, 250, 150 )
.head 6 -  Set naCores[1] = SalColorFromRGB( 200, 200, 250 )
.head 6 -  Set naCores[2] = SalColorFromRGB( 150, 255, 150 )
.head 6 -  Set naCores[3] = SalColorFromRGB( 250, 150, 150 )
.head 6 -  Set naCores[4] = COLOR_LightGray
.head 6 -  Set naCores[5] = COLOR_LightAqua
.head 6 -  Set naCores[6] = COLOR_LightGreen
.head 6 -  Set naCores[7] = COLOR_LightPeriwinkle
.head 6 -  Set naCores[8] = COLOR_Maize
.head 6 -  Set naCores[9] = COLOR_Marigold
.head 6 -  Set nIndCor  = 0
.head 5 -  Set nLinhaAtual = SalTblQueryContext( tblTabela )
.head 5 -  !
.head 5 -  Set nTotalColunas = SalStrTokenize( sColunas, '', ',', saColunas )
.head 5 -  Set nCol = 0
.head 5 -  Set nColuna = 1
.head 5 -  Set hWndColuna = SalTblGetColumnWindow( tblTabela, nColuna, COL_GetPos )
.head 5 +  While hWndColuna != hWndNULL
.head 6 -  Set bOk = FALSE
.head 6 +  If sColunas = STRING_Null
.head 7 -  Set bOk = TRUE
.head 6 +  Else
.head 7 +  If VisArrayFindString( saColunas, SalNumberToStrX( nColuna, 0 ) ) >= 0
.head 8 -  Set bOk = TRUE
.head 7 +  Else
.head 8 -  Call SalGetItemName( hWndColuna, sValor )
.head 8 +  If VisArrayFindString( saColunas, SalStrTrimX( sValor ) ) >= 0
.head 9 -  Set bOk = TRUE
.head 6 +  If bOk
.head 7 -  Set naColunas[ nCol ] = nColuna
.head 7 -  Set nCol = nCol + 1
.head 6 -  Set nColuna = nColuna + 1
.head 6 -  Set hWndColuna = SalTblGetColumnWindow( tblTabela, nColuna, COL_GetPos )
.head 5 -  Set nTotalColunas = nCol
.head 5 -  !
.head 5 -  !
.head 5 -  Set nLinha = 0
.head 5 -  Set nLinhaDup = 0
.head 5 +  While SalTblSetContext( tblTabela, nLinha )
.head 6 -  !
.head 6 -  Set nColuna = 0
.head 6 +  While nColuna < nTotalColunas
.head 7 -  Call SalTblGetColumnText( tblTabela, naColunas[ nColuna ], saValoresOrigem[ nColuna ] )
.head 7 -  Set nColuna = nColuna + 1
.head 6 -  !
.head 6 +  If VisArrayFindNumber( naLinhasDuplicadas, nLinha ) < 0
.head 7 +  If bUsarCores
.head 8 -  Call XSalTblSetRowBackColor( tblTabela, nLinha, COLOR_White )
.head 7 -  Set nLinha2 = nLinha + 1
.head 7 +  While SalTblSetContext( tblTabela, nLinha2 )
.head 8 -  Set bIgual = TRUE
.head 8 -  Set nColuna = 0
.head 8 +  While nColuna < nTotalColunas
.head 9 -  Call SalTblGetColumnText( tblTabela, naColunas[ nColuna ], saValores[ nColuna ] )
.head 9 +  If saValores[ nColuna ] != saValoresOrigem[ nColuna ]
.head 10 -  Set bIgual = FALSE
.head 10 -  Break
.head 9 -  Set nColuna = nColuna + 1
.head 8 +  If bIgual
.head 9 +  If VisArrayFindNumber( naLinhasDuplicadas, nLinha ) < 0
.head 10 -  Set naLinhasDuplicadas[ nLinhaDup ] = nLinha
.head 10 -  Set nLinhaDup = nLinhaDup + 1
.head 10 +  If bUsarCores
.head 11 -  Set nCor = naCores[ nIndCor ]
.head 11 -  Set nIndCor = nIndCor + 1
.head 11 -  Call XSalTblSetRowBackColor( tblTabela, nLinha, nCor )
.head 9 +  If bUsarCores
.head 10 -  Call XSalTblSetRowBackColor( tblTabela, nLinha2, nCor )
.head 9 -  Set naLinhasDuplicadas[ nLinhaDup ] = nLinha2
.head 9 -  Set nLinhaDup = nLinhaDup + 1
.head 8 -  Set nLinha2 = nLinha2 + 1
.head 6 -  !
.head 6 -  Set nLinha = nLinha + 1
.head 5 -  !
.head 5 -  ! Call SalTblSetContext( tblTabela, nLinhaAtual )
.head 5 +  If nLinhaDup > 0
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: SalTblFundoBranco
.head 4 -  Description: Define a cor branca como fundo de todas as linhas da tabela
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: tblTabela
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinha
.head 5 -  Number: nLinhaAtual
.head 4 +  Actions
.head 5 -  Set nLinhaAtual = SalTblQueryContext( tblTabela )
.head 5 -  Set nLinha = 0
.head 5 +  While SalTblSetContext( tblTabela, nLinha )
.head 6 -  Call XSalTblSetRowBackColor( tblTabela, nLinha, COLOR_White )
.head 6 -  Set nLinha = nLinha + 1
.head 5 -  Call SalTblSetContext( tblTabela, nLinhaAtual )
.head 3 +  Function: SalTblColCount
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nColCount
.head 5 -  Window Handle: hWndCol
.head 4 +  Actions
.head 5 -  Set nColCount = 1
.head 5 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nColCount, COL_GetPos )
.head 5 +  While hWndCol != hWndNULL
.head 6 -  Set nColCount = nColCount + 1
.head 6 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nColCount, COL_GetPos )
.head 5 -  Set nColCount = nColCount - 1
.head 5 -  Return nColCount
.head 3 +  Function: SalTblToString
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTabela
.head 5 -  String: sTagLinha
.head 5 -  String: sTagColuna
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nColCount
.head 5 -  Number: nIndice
.head 5 -  Number: nLinha
.head 5 -  String: sTabela
.head 5 -  String: sValor
.head 4 +  Actions
.head 5 -  Set nColCount = SalTblColCount( )
.head 5 -  Set nLinha = 0
.head 5 -  Set sTabela = ''
.head 5 +  While SalTblSetContext( hWndItem, nLinha )
.head 6 -  Set sTabela = sTabela || '<' || sTagLinha || '>'
.head 6 -  Set nIndice = 1
.head 6 +  While nIndice <= nColCount
.head 7 -  Call SalTblGetColumnText( hWndItem, nIndice, sValor )
.head 7 -  Set sTabela = sTabela || '<' || sTagColuna || '>' || sValor || '</' || sTagColuna || '>'
.head 7 -  Set nIndice = nIndice + 1
.head 6 -  Set sTabela = sTabela || '</' || sTagLinha || '>'
.head 6 -  Set nLinha = nLinha + 1
.head 5 -  Return sTabela
.head 3 +  Function: SalTblPopulateFromString
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTabela
.head 5 -  String: sTagLinha
.head 5 -  String: sTagColuna
.head 5 -  String: sConteudo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinha
.head 5 -  Number: nColuna
.head 5 -  Number: nTotalColunas
.head 5 -  Number: nTotalLinhas
.head 5 -  String: sLinha
.head 5 -  String: sValor
.head 5 -  String: saLinhas[*]
.head 5 -  String: saValores[*]
.head 4 +  Actions
.head 5 -  Call SalTblReset( hWndTabela )
.head 5 -  Set nTotalLinhas = SonStrTokenize( sConteudo, '<' || sTagLinha || '>', '</' || sTagLinha || '>', saLinhas )
.head 5 -  Set nLinha = 0
.head 5 +  While nLinha < nTotalLinhas
.head 6 -  Call SalTblInsertRow( hWndTabela, TBL_MaxRow )
.head 6 -  Set nTotalColunas =  SonStrTokenize( saLinhas[nLinha], '<' || sTagColuna || '>', '</' || sTagColuna || '>', saValores )
.head 6 -  Set nColuna = 0
.head 6 +  While nColuna < nTotalColunas
.head 7 -  Call SalTblSetColumnText( hWndTabela, nColuna+1, saValores[nColuna] )
.head 7 -  Set nColuna = nColuna + 1
.head 6 -  Set nLinha = nLinha + 1
.head 3 +  Function: SalTblProcessaFormulaBase
.head 4 -  Description: Processa uma formula matemática nas linhas da tabela para as colunas de destino no vetor naColunasDestino
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: tblTabela
.head 5 -  Number: nColunaCodigoLinha
.head 5 -  Number: nColunaFormula
.head 5 -  Number: nLinhaAtual
.head 5 -  Number: naColunaResultado[*]
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nMax
.head 5 -  Number: nIndice
.head 5 -  Number: nLinhaPos
.head 5 -  Number: nLinhaProcessar
.head 5 -  Number: nValor
.head 5 -  Number: nValorLinha
.head 5 -  Number: nOperacao
.head 5 -  Number: nIndiceColunaResultado
.head 5 -  String: sFormula
.head 5 -  String: sToken
.head 5 -  String: sTokenNext
.head 5 -  String: saTokens[*]
.head 5 -  String: saValue[*]
.head 5 -  String: sValor
.head 5 -  Date/Time: dt1
.head 5 -  Window Handle: hWnd1
.head 5 -  String: sExpressao
.head 5 -  String: sFormulaDestino
.head 5 -  Number: nTotalColunasResultado
.head 4 +  Actions
.head 5 -  Call SalTblSetContext( tblTabela, nLinhaAtual )
.head 5 -  Call SalTblGetColumnText( tblTabela, nColunaFormula, sFormula )
.head 5 +  If sFormula != ''
.head 6 +  If 1
.head 7 -  Set nIndice = 0
.head 7 -  Set saTokens[ nIndice ] = '+'
.head 7 -  Set nIndice = nIndice + 1
.head 7 -  Set saTokens[ nIndice ] = '-'
.head 7 -  Set nIndice = nIndice + 1
.head 7 -  Set saTokens[ nIndice ] = '*'
.head 7 -  Set nIndice = nIndice + 1
.head 7 -  Set saTokens[ nIndice ] = '/'
.head 7 -  Set nIndice = nIndice + 1
.head 7 -  Set saTokens[ nIndice ] = '('
.head 7 -  Set nIndice = nIndice + 1
.head 7 -  Set saTokens[ nIndice ] = ')'
.head 7 -  Set nIndice = nIndice + 1
.head 7 -  Set saTokens[ nIndice ] = ' '
.head 6 -  Call SalArrayGetUpperBound( naColunaResultado, 1, nTotalColunasResultado )
.head 6 -  Set nValor = 0
.head 6 -  Set nMax =  SalStrLength( sFormula )
.head 6 -  Set nIndice = 0
.head 6 -  Call SalArraySetUpperBound( saValue, 1, -1 )
.head 6 -  Set sExpressao = ''
.head 6 +  While nIndice < nMax
.head 7 -  Set sToken = SalStrMidX( sFormula, nIndice, 1 )
.head 7 +  If VisArrayFindString( saTokens, sToken ) < 0
.head 8 -  Set nIndice = nIndice + 1
.head 8 -  Set sTokenNext = SalStrMidX( sFormula, nIndice, 1 )
.head 8 -  Set sExpressao = sToken
.head 8 +  While VisArrayFindString( saTokens, sTokenNext ) < 0 or sTokenNext = ''
.head 9 -  Set sExpressao = sExpressao || sTokenNext
.head 9 -  Set nIndice = nIndice + 1
.head 9 -  Set sTokenNext = SalStrMidX( sFormula, nIndice, 1 )
.head 9 +  If sTokenNext = '' and nIndice >= nMax
.head 10 -  Break
.head 8 -  Set nIndice = nIndice - 1
.head 8 +  If sExpressao != ''
.head 9 -  Set nLinhaPos = SalStrToNumber( sExpressao )
.head 9 -  Set nLinhaProcessar = VisTblFindNumber( tblTabela, 0, SalTblGetColumnWindow( tblTabela, nColunaCodigoLinha, COL_GetPos ), nLinhaPos )
.head 9 +  If nLinhaProcessar != -1
.head 10 -  Call SalTblGetColumnText( tblTabela, nColunaFormula, sFormulaDestino )
.head 10 -  Call SalTblGetColumnText( tblTabela, naColunaResultado[ 0 ], sValor )
.head 10 -  ! Verificando se tem q processar filho - teste pela primeira coluna de resultado
.head 10 +  If sFormulaDestino != '' and sValor = ''
.head 11 -  Call SalTblProcessaFormulaBase( tblTabela, nColunaCodigoLinha, nColunaFormula, nLinhaProcessar, naColunaResultado )
.head 10 -  !
.head 10 -  !
.head 10 -  Set nIndiceColunaResultado = 0
.head 10 +  While nIndiceColunaResultado <= nTotalColunasResultado
.head 11 -  Call SalTblGetColumnText( tblTabela, naColunaResultado[ nIndiceColunaResultado ], sValor )
.head 11 -  Set saValue[ nIndiceColunaResultado ] = saValue[ nIndiceColunaResultado ] || SalNumberToStrX( SalStrToNumber( sValor ), 5 )
.head 11 -  Set nIndiceColunaResultado = nIndiceColunaResultado + 1
.head 10 -  ! Set sToken = SalNumberToStrX( SalStrToNumber( sValor ), 5 )
.head 7 +  Else
.head 8 -  Set nIndiceColunaResultado = 0
.head 8 +  While nIndiceColunaResultado <= nTotalColunasResultado
.head 9 -  Set saValue[ nIndiceColunaResultado ] = saValue[ nIndiceColunaResultado ] || sToken
.head 9 -  Set nIndiceColunaResultado = nIndiceColunaResultado + 1
.head 7 -  Set nIndice = nIndice + 1
.head 6 -  Set nIndiceColunaResultado = 0
.head 6 +  While nIndiceColunaResultado <= nTotalColunasResultado
.head 7 +  If SalCompileAndEvaluate( VisStrSubstitute( saValue[ nIndiceColunaResultado ], ',', '.' ), nLinhaPos, nIndice, nValor, sValor, dt1, hWnd1, TRUE, SalContextCurrent () )
.head 8 -  Call SalTblSetContext( tblTabela, nLinhaAtual )
.head 8 -  Call SalTblSetColumnText( tblTabela, naColunaResultado[ nIndiceColunaResultado ], SalNumberToStrX( nValor, 5 ) )
.head 7 -  Set nIndiceColunaResultado = nIndiceColunaResultado + 1
.head 3 +  Function: SalTblProcessaFormula
.head 4 -  Description: Processa uma formula matemática nas linhas da tabela para todas a coluna informada em nColunaDestino
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: tblTabela
.head 5 -  Number: nColunaCodigoLinha
.head 5 -  Number: nColunaFormula
.head 5 -  Number: nLinhaAtual
.head 5 -  Number: nColunaDestino
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: naColunas[*]
.head 4 +  Actions
.head 5 -  Call SalArraySetUpperBound( naColunas, 1, -1 )
.head 5 -  Set naColunas[ 0 ] = nColunaDestino
.head 5 -  Call SalTblProcessaFormulaBase( tblTabela, nColunaCodigoLinha, nColunaFormula, nLinhaAtual, naColunas )
.head 3 +  Function: SalTblProcessaFormulaVariasColunas
.head 4 -  Description: Processa uma formula matemática nas linhas da tabela para todas as colunas informadas em sColunasDestino (Separadas por virgula)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: tblTabela
.head 5 -  Number: nColunaCodigoLinha
.head 5 -  Number: nColunaFormula
.head 5 -  Number: nLinhaAtual
.head 5 -  String: sColunasDestino
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: saTokes[*]
.head 5 -  Number: nMax
.head 5 -  Number: nLinha
.head 5 -  Number: nColuna
.head 5 -  Number: naColunas[*]
.head 4 +  Actions
.head 5 -  Set nMax = SalStrTokenize( sColunasDestino, '', ',', saTokes )
.head 5 -  Set nLinha = 0
.head 5 +  While nLinha <= nMax
.head 6 +  If SalStrTrimX( saTokes[ nLinha ] ) != ''
.head 7 -  Set naColunas[ nColuna ] = SalStrToNumber( saTokes[ nLinha ] )
.head 7 -  Set nColuna = nColuna + 1
.head 6 -  Set nLinha = nLinha + 1
.head 5 -  !
.head 5 -  Call SalTblProcessaFormulaBase( tblTabela, nColunaCodigoLinha, nColunaFormula, nLinhaAtual, naColunas )
.head 3 +  Function: SonTblFindString
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTabela
.head 5 -  Number: nLinha
.head 5 -  Window Handle: hWndColuna
.head 5 -  String: sTexto
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sValor
.head 4 +  Actions
.head 5 -  Set nLinha = 0
.head 5 +  While SalTblSetContext( hWndTabela, nLinha )
.head 6 -  Call SalTblGetColumnText( hWndTabela, SalTblGetColumnIDX( hWndTabela, hWndColuna ), sValor )
.head 6 +  If SalStrUpperX( sValor ) = SalStrUpperX( sTexto )
.head 7 -  Return nLinha
.head 6 -  Set nLinha = nLinha + 1
.head 5 -  Return -1
.head 3 +  Function: SonTblMoveRow
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: tblTabelaParametro
.head 5 -  Number: nLinhaMover
.head 5 -  Boolean: bLinhaAcima	 	!TRUE para Linha acima e FALSE para Linha abaixo
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinhaAux
.head 5 -  Number: nColuna
.head 5 -  String: sValorOrigem[*]
.head 5 -  String: sValorDestino[*]
.head 4 +  Actions
.head 5 +  If bLinhaAcima
.head 6 +  If nLinhaMover = 0
.head 7 -  Call SalMessageBox( 'Primeira Linha da Tabela', 'Atenção', MB_Ok | MB_IconExclamation )
.head 7 -  Return FALSE
.head 6 -  Set nLinhaAux = nLinhaMover - 1
.head 5 +  Else
.head 6 -  Set nLinhaAux = nLinhaMover + 1
.head 6 +  If Not SalTblSetContext( tblTabelaParametro, nLinhaAux )
.head 7 -  Call SalMessageBox( 'Última Linha da Tabela', 'Atenção', MB_Ok | MB_IconExclamation )
.head 7 -  Return FALSE
.head 5 -  ! Lê Dados da Linha a Mover
.head 5 -  Call SalTblSetContext( tblTabelaParametro, nLinhaMover )
.head 5 -  Set nColuna = 1
.head 5 +  While SalTblGetColumnWindow( tblTabelaParametro, nColuna, COL_GetID ) != hWndNULL
.head 6 -  Call SalTblGetColumnText( tblTabelaParametro, nColuna, sValorOrigem[nColuna-1] )
.head 6 -  Set nColuna = nColuna + 1
.head 5 -  ! Lê Dados da Linha de Destino
.head 5 -  Call SalTblSetContext( tblTabelaParametro, nLinhaAux )
.head 5 -  Set nColuna = 1
.head 5 +  While SalTblGetColumnWindow( tblTabelaParametro, nColuna, COL_GetID ) != hWndNULL
.head 6 -  Call SalTblGetColumnText( tblTabelaParametro, nColuna, sValorDestino[nColuna-1] )
.head 6 -  Set nColuna = nColuna + 1
.head 5 -  ! Escreve Dados da Linha a Mover Na Nova Linha
.head 5 -  Set nColuna = 1
.head 5 +  While SalTblGetColumnWindow( tblTabelaParametro, nColuna, COL_GetID ) != hWndNULL
.head 6 -  Call SalTblSetColumnText( tblTabelaParametro, nColuna, sValorOrigem[nColuna-1] )
.head 6 -  Set nColuna = nColuna + 1
.head 5 -  ! Escreve Dados da Linha de Destino na Linha a Mover
.head 5 -  Call SalTblSetContext( tblTabelaParametro, nLinhaMover )
.head 5 -  Set nColuna = 1
.head 5 +  While SalTblGetColumnWindow( tblTabelaParametro, nColuna, COL_GetID ) != hWndNULL
.head 6 -  Call SalTblSetColumnText( tblTabelaParametro, nColuna, sValorDestino[nColuna-1] )
.head 6 -  Set nColuna = nColuna + 1
.head 5 -  Call SalTblSetFlagsAnyRows( tblTabelaParametro, ROW_Selected | ROW_MarkDeleted | ROW_Edited, FALSE, 0, 0  )
.head 5 -  Call SalTblSetContext( tblTabelaParametro, nLinhaAux )
.head 5 -  Call SalTblSetRowFlags( tblTabelaParametro, nLinhaAux, ROW_Selected, TRUE )
.head 5 -  Return TRUE
.head 3 +  Function: SalTblCopyRow
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: tblTabelaParametro
.head 5 -  Number: nLinhaCopiar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinhaAux
.head 5 -  Number: nColuna
.head 5 -  String: sValorOrigem[*]
.head 4 +  Actions
.head 5 -  ! Lê Dados da Linha a Copiar
.head 5 +  If SalTblSetContext( tblTabelaParametro, nLinhaCopiar )
.head 6 -  Set nColuna = 1
.head 6 +  While SalTblGetColumnWindow( tblTabelaParametro, nColuna, COL_GetID ) != hWndNULL
.head 7 -  Call SalTblGetColumnText( tblTabelaParametro, nColuna, sValorOrigem[nColuna-1] )
.head 7 -  Set nColuna = nColuna + 1
.head 6 -  ! Insere Dados na Linha de Destino
.head 6 -  Set nLinhaAux = SalTblInsertRow( tblTabelaParametro, TBL_MaxRow )
.head 6 -  Set nColuna = 1
.head 6 +  While SalTblGetColumnWindow( tblTabelaParametro, nColuna, COL_GetID ) != hWndNULL
.head 7 -  Call SalTblSetColumnText( tblTabelaParametro, nColuna, sValorOrigem[nColuna-1] )
.head 7 -  Set nColuna = nColuna + 1
.head 6 -  Call SalTblSetContext( tblTabelaParametro, nLinhaAux )
.head 6 -  Call SalTblSetRowFlags( tblTabelaParametro, nLinhaAux, ROW_Selected, TRUE )
.head 6 -  Return TRUE
.head 5 -  Return FALSE
.head 3 +  Function: SalTblGetColumnID
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTbl
.head 5 -  String: sNomeColuna
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNomeCol
.head 5 -  Number: nID
.head 5 -  Number: nPos
.head 5 -  Window Handle: hWndCol
.head 4 +  Actions
.head 5 -  Set nPos = SalStrScan( sNomeColuna, '.' )
.head 5 +  If nPos >= 0
.head 6 -  Set sNomeColuna = SalStrMidX( sNomeColuna, nPos+1, SalStrLength( sNomeColuna ) )
.head 5 -  Set nID = 1
.head 5 +  Loop
.head 6 -  Set hWndCol = SalTblGetColumnWindow( hWndTbl, nID, COL_GetID )
.head 6 +  If hWndCol = hWndNULL
.head 7 -  Return 0
.head 6 -  Call SalGetItemName( hWndCol, sNomeCol )
.head 6 +  If sNomeColuna = sNomeCol
.head 7 -  Return nID
.head 6 -  Set nID = nID + 1
.head 3 +  Function: SalTblGetColumnIDX
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTbl
.head 5 -  Window Handle: hWndCol
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNomeCol
.head 5 -  Number: nID
.head 5 -  Number: nPos
.head 5 -  Window Handle: hWndColAux
.head 4 +  Actions
.head 5 -  Set nID = 1
.head 5 +  Loop
.head 6 -  Set hWndColAux = SalTblGetColumnWindow( hWndTbl, nID, COL_GetID )
.head 6 +  If hWndColAux = hWndNULL
.head 7 -  Return 0
.head 6 +  If hWndCol = hWndColAux
.head 7 -  Return nID
.head 6 -  Set nID = nID + 1
.head 3 +  Function: SalTblGetColumnString
.head 4 -  Description: Retorna o valor da coluna informada
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Window Handle: hpWndTbl
.head 5 +  Number: npColuna
.head 6 -  ! ID da Coluna
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sValor
.head 4 +  Actions
.head 5 +  If SalTblGetColumnText( hpWndTbl, npColuna, sValor )
.head 6 -  Return sValor
.head 5 +  Else
.head 6 -  Return ''
.head 3 +  Function: SalTblGetColumnNumber
.head 4 -  Description: Retorna o valor da coluna informada
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: hpWndTbl
.head 5 +  Number: npColuna
.head 6 -  ! ID da Coluna
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sValor
.head 4 +  Actions
.head 5 +  If SalTblGetColumnText( hpWndTbl, npColuna, sValor )
.head 6 -  Return SalStrToNumber( sValor )
.head 5 +  Else
.head 6 -  Return NUMBER_Null
.head 3 +  Function: SalTblGetColumnDateTime 
.head 4 -  Description: Retorna o valor da coluna informada
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Window Handle: hpWndTbl
.head 5 +  Number: npColuna
.head 6 -  ! ID da Coluna
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sValor
.head 5 -  String: sPicture
.head 5 -  Date/Time: dtValor
.head 5 -  ! Number: nFormat
.head 5 -  Window Handle: hWndCol
.head 4 +  Actions
.head 5 +  If SalTblGetColumnText( hpWndTbl, npColuna, sValor )
.head 6 -  Set hWndCol = SalTblGetColumnWindow( hpWndTbl, npColuna, COL_GetID )
.head 6 +  Select Case SalFmtGetFormat( hWndCol )
.head 7 +  Case FMT_Format_Date
.head 8 -  Set dtValor = SalStrToDate( sValor )
.head 8 -  Break
.head 7 +  Case FMT_Format_DateTime
.head 8 -  Set dtValor = SalStrToDate( sValor )
.head 8 -  Break
.head 7 +  Case FMT_Format_Picture
.head 8 +  If SalFmtGetPicture( hWndCol, sPicture )
.head 9 +  If SalFmtIsValidPicture( sPicture, FMT_Pic_DateTime )
.head 10 -  Set dtValor = SalStrToDate( sValor )
.head 9 +  Else
.head 10 -  Set dtValor = DATETIME_Null
.head 8 +  Else
.head 9 -  Set dtValor = SalStrToDate( sValor )
.head 8 -  Break
.head 7 +  Case FMT_Format_Time
.head 8 -  Set dtValor = SalStrToDate( sValor )
.head 8 -  Break
.head 7 +  Default
.head 8 -  Set dtValor = SalStrToDate( sValor )
.head 8 -  Break
.head 6 -  Return dtValor
.head 5 +  Else
.head 6 -  Return DATETIME_Null
.head 3 +  Function: SalTblSetColumnNumber
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hpWndTbl
.head 5 +  Number: npColuna
.head 6 -  ! ID da Coluna
.head 5 -  Number: npValor
.head 5 -  Number: npDecimal
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SalTblSetColumnText( hpWndTbl, npColuna, SalNumberToStrX( npValor, npDecimal ) )
.head 3 +  Function: SalTblSetColumnDateTime
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hpWndTbl
.head 5 +  Number: npColuna
.head 6 -  ! ID da Coluna
.head 5 -  Date/Time: dtpValor
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sValor
.head 5 -  String: sPicture
.head 5 -  Window Handle: hWndCol
.head 4 +  Actions
.head 5 -  Set hWndCol = SalTblGetColumnWindow( hpWndTbl, npColuna, COL_GetID )
.head 5 +  Select Case SalFmtGetFormat( hWndCol )
.head 6 +  Case FMT_Format_Date
.head 7 -  Call SalDateToStr( dtpValor, sValor )
.head 7 -  Break
.head 6 +  Case FMT_Format_DateTime
.head 7 -  Call SalDateToStr( dtpValor, sValor )
.head 7 -  Break
.head 6 +  Case FMT_Format_Picture
.head 7 +  If SalFmtGetPicture( hWndCol, sPicture )
.head 8 +  If SalFmtIsValidPicture( sPicture, FMT_Pic_DateTime )
.head 9 -  Set sValor = SalFmtFormatDateTime( dtpValor, sPicture )
.head 8 +  Else
.head 9 -  Call SalDateToStr( dtpValor, sValor )
.head 7 +  Else
.head 8 -  Call SalDateToStr( dtpValor, sValor )
.head 7 -  Break
.head 6 +  Case FMT_Format_Time
.head 7 -  Call SalDateToStr( dtpValor, sValor )
.head 7 -  Break
.head 6 +  Default
.head 7 -  Call SalDateToStr( dtpValor, sValor )
.head 7 -  Break
.head 5 -  Return SalTblSetColumnText( hpWndTbl, npColuna, sValor )
.head 3 +  Function: SonStrTokenize
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Receive String: sValor
.head 5 -  String: sDelimitadorInicio
.head 5 -  String: sDelimitadorFim
.head 5 -  Receive String: saValores[*]
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nColuna
.head 5 -  Number: nInicio
.head 5 -  Number: nFim
.head 4 +  Actions
.head 5 -  Call SalArraySetUpperBound( saValores, 1, -1 )
.head 5 -  Set nInicio = SalStrScan( sValor, sDelimitadorInicio )
.head 5 +  While nInicio >= 0
.head 6 -  Set nFim = SalStrScan( sValor, sDelimitadorFim )
.head 6 -  Set saValores[ nColuna ] = SalStrMidX( sValor, nInicio + SalStrLength( sDelimitadorInicio ), nFim - nInicio - SalStrLength( sDelimitadorInicio ) )
.head 6 -  Set sValor = SalStrRightX( sValor, SalStrLength( sValor ) - nFim - SalStrLength( sDelimitadorFim ) )
.head 6 -  Set nInicio = SalStrScan( sValor, sDelimitadorInicio )
.head 6 -  Set nColuna = nColuna + 1
.head 5 -  Return nColuna
.head 3 +  Function: SalRandomString
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nTamanho
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sRandom
.head 5 -  Number: nChar
.head 5 -  Number: nQtdeChars
.head 4 +  Actions
.head 5 -  Set nQtdeChars = 0
.head 5 -  Set sRandom = ''
.head 5 +  While nQtdeChars < nTamanho
.head 6 -  Set nChar = SalNumberRandom( )
.head 6 +  While ( nChar <= 47 ) Or ( nChar >= 58 And nChar <= 64 ) Or ( nChar >= 90 )
.head 7 -  Set nChar = SalNumberRandom( )
.head 6 -  Set sRandom = sRandom || SalNumberToChar( nChar )
.head 6 -  Set nQtdeChars = nQtdeChars + 1
.head 5 -  Return sRandom
.head 3 +  Function: SalStrRandom
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nTamanho
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SalRandomString( nTamanho )
.head 3 +  Function: SonStrToNumber
.head 4 -  Description: converte uma strig para number.
Essa função trata os casos com string que contém o separador decimal diferente do que está configurado na máquina
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sNumberParam
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sParteNumber
.head 5 -  String: sParteDecimal
.head 5 -  Number: nQtdeDecimal
.head 5 -  Number: nNumberRetur
.head 4 +  Actions
.head 5 +  If SalStrScan( sNumberParam, ',' ) != -1 Or SalStrScan( sNumberParam, '.' ) != -1
.head 6 -  Set sNumberParam = SalStrTrimX( sNumberParam ) || '00000'
.head 5 +  Else
.head 6 -  Set sNumberParam = SalStrTrimX( sNumberParam )
.head 5 -  !
.head 5 +  If SalStrLength( sNumberParam ) = 0
.head 6 -  Return NUMBER_Null
.head 5 +  If SalStrLength( sNumberParam ) > 0 and SalStrToNumber( sNumberParam ) > 0
.head 6 -  Return SalStrToNumber( sNumberParam )
.head 5 -  ! pesquisa se o separador decimal é ',' (vígula)
.head 5 +  If SalStrScan( sNumberParam, ',' ) != -1
.head 6 -  Set sParteNumber = SalStrMidX( sNumberParam, 0, SalStrScan( sNumberParam, ',' ) )
.head 6 -  Set sParteDecimal = SalStrMidX( sNumberParam, SalStrScan( sNumberParam, ',' ) + 1, SalStrLength( sNumberParam ) )
.head 5 +  Else If SalStrScan( sNumberParam, '.' ) != -1
.head 6 -  Set sParteNumber = SalStrMidX( sNumberParam, 0, SalStrScan( sNumberParam, '.' ) )
.head 6 -  Set sParteDecimal = SalStrMidX( sNumberParam, SalStrScan( sNumberParam, '.' ) + 1, SalStrLength( sNumberParam ) )
.head 5 -  Set nQtdeDecimal = SalStrToNumber( '1' || SalStrRepeatX( '0', SalStrLength( sParteDecimal ) ) )
.head 5 -  Set nNumberRetur = SalStrToNumber( sParteNumber || sParteDecimal ) / nQtdeDecimal
.head 5 -  Return nNumberRetur
.head 3 +  Function: ttAttachWindow
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: BOOL
.head 4 +  Parameters
.head 5 -  Window Handle: HWND
.head 5 -  String: LPCSTR
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 -  Actions
.head 4 -  ! Export Ordinal: 0
.head 3 +  Function: ttDetachWindow
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: BOOL
.head 4 +  Parameters
.head 5 -  Window Handle: HWND
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 -  Actions
.head 4 -  ! Export Ordinal: 0
.head 3 +  Function: ttFindWindow
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: BOOL
.head 4 +  Parameters
.head 5 -  Window Handle: HWND
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 -  Actions
.head 4 -  ! Export Ordinal: 0
.head 3 +  Function: ttSetDynamicTipText
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean: BOOL
.head 4 +  Parameters
.head 5 -  String: LPCSTR
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 -  Actions
.head 4 -  ! Export Ordinal: 0
.head 3 +  Function: SalGaranteNumero
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sTexto
.head 5 -  Boolean: nComSeparador
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLetra
.head 5 -  String: sLetra
.head 5 -  String: sRetorno
.head 4 +  Actions
.head 5 -  Set nLetra = 0
.head 5 +  While SalStrMid( sTexto, nLetra,  1, sLetra )
.head 6 -  Set nLetra = nLetra + 1
.head 6 +  If (sLetra = ',' or sLetra = '.' ) and nComSeparador = 1
.head 7 -  Set sRetorno = sRetorno || sLetra
.head 6 +  If sLetra = '0' or sLetra = '1' or sLetra = '2' or sLetra = '3' or sLetra = '4' or sLetra = '5' or sLetra = '6' or sLetra = '7' or sLetra = '8' or sLetra = '9'
.head 7 -  Set sRetorno = sRetorno || sLetra
.head 5 -  Return sRetorno
.head 3 +  Function: SonDataTypeListPopulate
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndLista
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLinha
.head 4 +  Actions
.head 5 -  Call SalListClear( hWndLista )
.head 5 -  ! Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Smallint, 0 ) || ' - ' || SON_NAME_Smallint )
.head 5 -  Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Integer, 0 ) || ' - ' || SON_NAME_Integer )
.head 5 -  Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Decimal, 0 ) || ' - ' || SON_NAME_Decimal )
.head 5 -  Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_DateTime, 0 ) || ' - ' || SON_NAME_DateTime )
.head 5 -  ! Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Char, 0 ) || ' - ' || SON_NAME_Char )
.head 5 -  Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Varchar2, 0 ) || ' - ' || SON_NAME_Varchar2 )
.head 5 -  ! Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Blob, 0 ) || ' - ' || SON_NAME_Blob )
.head 5 -  ! Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Clob, 0 ) || ' - ' || SON_NAME_Clob )
.head 5 -  ! Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Long, 0 ) || ' - ' || SON_NAME_Long )
.head 5 -  ! Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Varbinary, 0 ) || ' - ' || SON_NAME_Varbinary )
.head 5 -  Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Autoincrement, 0 ) || ' - ' || SON_NAME_Autoincrement )
.head 5 -  ! Call SalListAdd( hWndLista, SalNumberToStrX( SON_TYPE_Blob_Java, 0 ) || ' - ' || SON_NAME_Blob_Java )
.head 3 +  Function: SonDataTypeGetStr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nDado
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  Select Case nDado
.head 6 +  Case SON_TYPE_Smallint
.head 7 -  Return SON_NAME_Smallint
.head 6 +  Case SON_TYPE_Integer
.head 7 -  Return SON_NAME_Integer
.head 6 +  Case SON_TYPE_Decimal
.head 7 -  Return SON_NAME_Decimal
.head 6 +  Case SON_TYPE_DateTime
.head 7 -  Return SON_NAME_DateTime
.head 6 +  Case SON_TYPE_Char
.head 7 -  Return SON_NAME_Char
.head 6 +  Case SON_TYPE_Varchar2
.head 7 -  Return SON_NAME_Varchar2
.head 6 +  Case SON_TYPE_Blob
.head 7 -  Return SON_NAME_Blob
.head 6 +  Case SON_TYPE_Clob
.head 7 -  Return SON_NAME_Clob
.head 6 +  Case SON_TYPE_Long
.head 7 -  Return SON_NAME_Long
.head 6 +  Case SON_TYPE_Varbinary
.head 7 -  Return SON_NAME_Varbinary
.head 6 +  Case SON_TYPE_Autoincrement
.head 7 -  Return SON_NAME_Autoincrement
.head 6 +  Case SON_TYPE_Blob_Java
.head 7 -  Return SON_NAME_Blob_Java
.head 3 +  Function: SonDataTypeGetNumber
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sDado
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nAns
.head 4 +  Actions
.head 5 -  Set nAns = SalStrScan( sDado, ' - ' )
.head 5 +  If nAns >= 0
.head 6 -  Return SalStrToNumber( SalStrLeftX( sDado, nAns ) )
.head 5 +  Else
.head 6 +  If sDado = SON_NAME_Smallint
.head 7 -  Return SON_TYPE_Smallint
.head 6 +  If sDado = SON_NAME_Integer
.head 7 -  Return SON_TYPE_Integer
.head 6 +  If sDado = SON_NAME_Decimal
.head 7 -  Return SON_TYPE_Decimal
.head 6 +  If sDado = SON_NAME_DateTime
.head 7 -  Return SON_TYPE_DateTime
.head 6 +  If sDado = SON_NAME_Char
.head 7 -  Return SON_TYPE_Char
.head 6 +  If sDado = SON_NAME_Varchar2
.head 7 -  Return SON_TYPE_Varchar2
.head 6 +  If sDado = SON_NAME_Blob
.head 7 -  Return SON_TYPE_Blob
.head 6 +  If sDado = SON_NAME_Clob
.head 7 -  Return SON_TYPE_Clob
.head 6 +  If sDado = SON_NAME_Long
.head 7 -  Return SON_TYPE_Long
.head 6 +  If sDado = SON_NAME_Varbinary
.head 7 -  Return SON_TYPE_Varbinary
.head 6 +  If sDado = SON_NAME_Autoincrement
.head 7 -  Return SON_TYPE_Autoincrement
.head 6 +  If sDado = SON_NAME_Blob_Java
.head 7 -  Return SON_TYPE_Blob_Java
.head 5 -  Return -1
.head 3 +  Function: SonDataTypeGetColor
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nDado
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  Select Case nDado
.head 6 +  Case SON_TYPE_Smallint
.head 7 -  Return SON_COLOR_Smallint
.head 6 +  Case SON_TYPE_Integer
.head 7 -  Return SON_COLOR_Integer
.head 6 +  Case SON_TYPE_Decimal
.head 7 -  Return SON_COLOR_Decimal
.head 6 +  Case SON_TYPE_DateTime
.head 7 -  Return SON_COLOR_DateTime
.head 6 +  Case SON_TYPE_Char
.head 7 -  Return SON_COLOR_Char
.head 6 +  Case SON_TYPE_Varchar2
.head 7 -  Return SON_COLOR_Varchar2
.head 6 +  Case SON_TYPE_Blob
.head 7 -  Return SON_COLOR_Blob
.head 6 +  Case SON_TYPE_Clob
.head 7 -  Return SON_COLOR_Clob
.head 6 +  Case SON_TYPE_Long
.head 7 -  Return SON_COLOR_Long
.head 6 +  Case SON_TYPE_Varbinary
.head 7 -  Return SON_COLOR_Varbinary
.head 6 +  Case SON_TYPE_Autoincrement
.head 7 -  Return SON_COLOR_Autoincrement
.head 6 +  Case SON_TYPE_Blob_Java
.head 7 -  Return SON_COLOR_Blob_Java
.head 3 +  Function: SonDateMesGetDif
.head 4 -  Description: Retorna a diferença em meses, entre duas datas
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Date/Time: dtpDataMaior
.head 5 -  Date/Time: dtpDataMenor
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dtMaior
.head 5 -  Date/Time: dtMenor
.head 5 -  Number: nDiferenca
.head 4 +  Actions
.head 5 -  Set dtMaior = SalDateMonthBegin( dtpDataMaior )
.head 5 -  Set dtMenor = SalDateMonthBegin( dtpDataMenor )
.head 5 -  Set nDiferenca = 0
.head 5 +  While dtMaior > dtMenor
.head 6 -  Set dtMaior = SalDateMonthBegin( (dtMaior - 1) )
.head 6 -  Set nDiferenca = nDiferenca + 1
.head 5 -  Return nDiferenca
.head 3 +  Function: SonDateMesSoma
.head 4 -  Description: Retorna o resultado da soma de uma data com a quantidade de meses informada
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  Date/Time: dtpData
.head 5 -  Number: npMeses
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Date/Time: dtData
.head 5 -  Number: nDias
.head 5 -  Number: nMeses
.head 4 +  Actions
.head 5 -  Set dtData = SalDateMonthBegin( dtpData )
.head 5 -  Set nDias = SalDateDay( dtpData )
.head 5 -  Set nMeses = npMeses
.head 5 -  !
.head 5 +  While nMeses > 0
.head 6 -  Set dtData = SalDateMonthBegin( (dtData + 32 ) )
.head 6 -  Set nMeses = nMeses - 1
.head 5 +  If nDias >=28
.head 6 -  Set dtData = SalDateMonthBegin( (dtData + 32 ) ) - 1
.head 5 +  Else
.head 6 -  Set dtData = SalDateConstruct( SalDateYear( dtData ), SalDateMonth( dtData), nDias, 0, 0, 0 )
.head 5 -  Return dtData
.head 3 +  Function: SonDateSubstractInSeconds
.head 4 -  Description: Retorna o tempo de diferenca entre a Data Final e a Data Inicial
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Date/Time: dtInicial
.head 5 -  Date/Time: dtFinal
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nHora
.head 5 -  Number: nMinuto
.head 5 -  Number: nSegundo
.head 5 -  Number: nAno
.head 5 -  Number: nMes
.head 5 -  Number: nDia
.head 5 -  Number: nTotalDias
.head 5 -  Date/Time: dtAux
.head 4 +  Actions
.head 5 -  Set nTotalDias = dtFinal - dtInicial
.head 5 -  Set nDia = SalNumberTruncate( nTotalDias, 15, 0 )
.head 5 -  Set nTotalDias = ( nTotalDias - nDia ) * 24
.head 5 -  Set nHora = SalNumberTruncate( nTotalDias, 15, 0 )
.head 5 -  Set nTotalDias = ( nTotalDias - nHora ) * 60
.head 5 -  Set nMinuto = SalNumberTruncate(  nTotalDias, 15, 0 )
.head 5 -  Set nTotalDias = ( nTotalDias - nMinuto ) * 60
.head 5 -  Set nSegundo = SalNumberTruncate( nTotalDias, 15, 0 )
.head 5 -  Return nSegundo + nMinuto * 60 + nHora * 3600
.head 3 +  Function: ConectaSql
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If ngAmbiente = 1
.head 6 -  Set SqlDatabase = oConfiguracao.sBaseProd
.head 6 -  Set SqlUser = oConfiguracao.sUsuarioProd
.head 6 -  Set SqlPassword = oConfiguracao.sSenhaProd
.head 5 +  If ngAmbiente = 2
.head 6 -  Set SqlDatabase = oConfiguracao.sBaseTeste
.head 6 -  Set SqlUser = oConfiguracao.sUsuarioTeste
.head 6 -  Set SqlPassword = oConfiguracao.sSenhaTeste
.head 5 +  If ngAmbiente > 0
.head 6 -  Call SqlConnect( hSql )
.head 6 -  Call SqlConnect( hSql2 )
.head 6 -  Call SqlConnect( hSql3 )
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  Function: DesconectaSql
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If hSql != hWndNULL
.head 6 -  Call SqlDisconnect ( hSql )
.head 5 +  If hSql2 != hWndNULL
.head 6 -  Call SqlDisconnect ( hSql2 )
.head 5 +  If hSql3 != hWndNULL
.head 6 -  Call SqlDisconnect ( hSql3 )
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  Function: FormataDataLida
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Date/Time:
.head 4 +  Parameters
.head 5 -  String: sValor
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SalStrTrimX( sValor ) != ''
.head 6 -  Return SalDateConstruct( SalStrToNumber( SalStrLeftX( sValor, 4 )),
			SalStrToNumber( SalStrMidX( sValor, 4, 2 ) ),
			SalStrToNumber( SalStrMidX( sValor, 6, 2 ) ),
			SalStrToNumber( SalStrMidX( sValor, 8, 2 ) ),
			SalStrToNumber( SalStrMidX( sValor, 10, 2) ),
			SalStrToNumber( SalStrMidX( sValor, 12, 2 ) ) )
.head 5 +  Else
.head 6 -  Return DATETIME_Null
.head 2 -  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3720741380
0000: 3C0700006E030000 0000000000000000 0200000B00FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F5B003C00 000F700063446961
0040: 6C6F674400656661 756C74D600C00000 0700000043040000 0002F8000000FF6F
0060: 0400D6040002FE00 FF03080000001900 84000001000000FF FF60210000001900
0080: ED0100FF3F3A0058 0000190001FB00FF 0F53000000160400 030000FE00FF8357
00A0: 00000004B5000200 FFFF1001805B0000 0100E100127063FF 83546162D600EC00
00C0: 0700AD040002FD00 FF370400046B0002 00FFFFCD080019DA 000100FF7F21B300
00E0: 1900F60100FFDF3A AC00190001FD00FF 375300046B000300 FFFFCD570004DA00
0100: 0200FF7F01C0801D 00000002C0000870 63436C8165400000 0002BD0019A50001
0120: 0000FFFF66190004 00ED0300FF3F0180 661D000300F80B70 63414B6579400000
0140: F602009619000100 FE00FF9B190004B5 000300FFFF900180 0400000401001066
0160: 6344424C00697374 614F626A6500746F 7322000000017A00 00046B0007000501
0180: 3212000000FF2101 8019000005000000 000C70634D6F0075 7365576865656C04
01A0: 220000010000006F 1900ED0100FF3F01 8006040006000000 00096663536F756E
01C0: 640065782A000000 0100BD003AA10001 070000A001003C05 0000078001000000
01E0: FF8001800C000000 0761000A66636E00 4D657465725E0000 EC000300AD040003
0200: FD00FF370400046B 000300FFFFC90800 0004DA000300FF7F 01C19D0000000800
0220: 000A5F4572726F72 80426173658A0100 F00D000000961900 0100FE00FF9B1900
0240: 19B5000100FFFF60 320000001900ED01 00FF3F4B00580000 190001FB00FF0F64
0260: 000000D6040002FE 00FF836800000004 B5000200FFFF606C 0000000400ED0200
0280: FF3F700058000004 0003FB00FF0F7400 0000D6040002FE00 FF837800000004B5
02A0: 000200FFFF607C00 00000400ED0300FF BF80580000040003 FB00FF0F84000000
02C0: D6190001FE00FF63 01805B0000090000 000763646B004974 656DDE000000F407
02E0: 0000860400010200 FE009F8001FC0000 9B040004B5000200 FFFF6608001900E9
0300: 010000FFBF215900 190001FB00FF6F3A 00D6040003FE00FF 833E00000004B500
0320: 0300FFFF60420000 001900ED0100FF3F 0180007D0000000A 000000000D635261
0340: 64696F4C0669426F 789A00D800000500 5B190001FA0000FF 6F1900D6190001FE
0360: 00FF9B320019B500 0100FFFF664B0019 00ED0100FFBF6459 00190001FB00FF0F
.enddata
.head 3 +  Dialog Box Class: pcDialogDefault
.head 4 -  Title:
.head 4 -  Accessories Enabled? Yes
.head 4 -  Visible? No
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Type of Dialog: Modal
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  7.083"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.738"
.head 6 -  Height Editable? Class Default
.head 5 -  Absolute Screen Location? Class Default
.head 5 -  Font Name:
.head 5 -  Font Size: 0
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: White
.head 4 -  Next Class Child Key: 66
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Etched
.head 6 -  Location? Top
.head 6 -  Visible? Class Default
.head 6 -  Size: 0.61"
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 0
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: White
.head 6 -  Background Color: White
.head 5 -  Contents
.head 4 +  Contents
.head 5 +  Pushbutton: pbOk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 51
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Aceitar
.head 6 -  Window Location and Size
.head 7 -  Left: 4.233"
.head 7 -  Top: 1.524"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.286"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Keyboard Accelerator: Enter
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: White
.head 6 -  Image Style: Single
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set hWndOk = hWndItem
.head 8 -  Call XSalToolboxSetButtonStyle( hWndItem,
XSalToolbar_ButtonLeftImage | XSalToolbar_ButtonThinBorder )
.head 8 -  Call SalPicSetFile( hWndItem, sgCaminhoImagens || 'Ok.bmp' )
.head 7 +  On SAM_TooltipSetText
.head 8 -  Return XSalTooltipSetText( lParam, 'Aceitar as Definições desta Janela e Continuar' )
.head 5 +  Pushbutton: pbCancela
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 24
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Cancelar
.head 6 -  Window Location and Size
.head 7 -  Left: 5.633"
.head 7 -  Top: 1.524"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.286"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Keyboard Accelerator: Esc
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: White
.head 6 -  Image Style: Single
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call XSalToolboxSetButtonStyle( hWndItem,
XSalToolbar_ButtonLeftImage | XSalToolbar_ButtonThinBorder )
.head 8 -  Call SalPicSetFile( hWndItem, sgCaminhoImagens || 'Cancela.bmp' )
.head 7 +  On SAM_Click
.head 8 -  Call SalEndDialog( hWndForm, FALSE )
.head 7 +  On SAM_TooltipSetText
.head 8 -  Return XSalTooltipSetText( lParam, 'Cancelar e Fechar esta Janela' )
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  String: sNome
.head 5 -  String: sTitulo
.head 5 -  Number: nX
.head 5 -  Number: nY
.head 5 -  Number: nZ
.head 5 -  Window Handle: hWndOk
.head 5 -  String: sTitleTextHelp
.head 4 +  Instance Variables
.head 5 -  Number: nWinStyleAdjust
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nWinStyleAdjust > 0
.head 7 -  Call SalGetWindowSize( hWndForm, nX, nY )
.head 7 -  Call SalSetWindowSize( hWndForm, nX, nY + nWinStyleAdjust )
.head 6 -  Call SalFmtKeepMask( FALSE )
.head 6 -  Call SalCenterWindow( hWndForm )
.head 5 +  On SAM_CreateComplete
.head 6 -  Set nJanelaHandle = SalWindowHandleToNumber( hWndForm )
.head 6 -  Call SalSendMsg( hWndForm, PAM_Reset, 0, 0 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On PAM_Reset
.head 6 -  Call SalSendMsgToChildren( hWndForm, PAM_Reset, 0, 0 )
.head 6 -  Call SalEnableWindow( pbOk )
.head 3 +  Dialog Box Class: pcDialogDefaultTab
.head 4 -  Title:
.head 4 -  Accessories Enabled? Yes
.head 4 -  Visible? No
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Type of Dialog: Modal
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  7.083"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.429"
.head 6 -  Height Editable? Class Default
.head 5 -  Absolute Screen Location? Class Default
.head 5 -  Font Name:
.head 5 -  Font Size: 0
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: White
.head 4 -  Next Class Child Key: 65
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Etched
.head 6 -  Location? Top
.head 6 -  Visible? Class Default
.head 6 -  Size: 0.61"
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 0
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: White
.head 6 -  Background Color: White
.head 5 -  Contents
.head 4 +  Contents
.head 5 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000600
0020: 4E616D6530000054 616252696768744D 617267696E000200 3000005461624E61
0040: 6D65730006004E61 6D65300000546162 4C6162656C730007 004C6162656C3000
0060: 0054616250616765 436F756E74000200 310000546162426F 74746F6D4D617267
0080: 696E000500302E34 3500005461624472 61775374796C6500 0B0057696E393553
00A0: 74796C6500005461 62466F726D506167 6573000100000054 6162546F704D6172
00C0: 67696E0002003000 0000000000000000 0000000000000000 0000000000
.enddata
.data CLASSPROPSSIZE
0000: DD00
.enddata
.head 6 -  Class Child Ref Key: 1
.head 6 -  Class ChildKey: 65
.head 6 -  Class: cQuickTabsDialog
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left: Class Default
.head 7 -  Top: Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  File Name:
.head 6 -  Storage: Class Default
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Fit: Class Default
.head 6 -  Scaling
.head 7 -  Width:  Class Default
.head 7 -  Height:  Class Default
.head 6 -  Corners: Class Default
.head 6 -  Border Style: Class Default
.head 6 -  Border Thickness: Class Default
.head 6 -  Tile To Parent? Class Default
.head 6 -  Border Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Pushbutton: pbOk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 51
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Aceitar
.head 6 -  Window Location and Size
.head 7 -  Left: 4.217"
.head 7 -  Top: 2.214"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.286"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Keyboard Accelerator: Enter
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: White
.head 6 -  Image Style: Single
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Set hWndOk = hWndItem
.head 8 -  Call XSalToolboxSetButtonStyle( hWndItem,
XSalToolbar_ButtonLeftImage | XSalToolbar_ButtonThinBorder )
.head 8 -  Call SalPicSetFile( hWndItem, sgCaminhoImagens || 'Ok.bmp' )
.head 7 +  On SAM_TooltipSetText
.head 8 -  Return XSalTooltipSetText( lParam, 'Aceitar as Definições desta Janela e Continuar' )
.head 5 +  Pushbutton: pbCancela
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 24
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Cancelar
.head 6 -  Window Location and Size
.head 7 -  Left: 5.617"
.head 7 -  Top: 2.214"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.286"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Keyboard Accelerator: Esc
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: White
.head 6 -  Image Style: Single
.head 6 -  Text Color: Default
.head 6 -  Background Color: Light Gray
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call XSalToolboxSetButtonStyle( hWndItem,
XSalToolbar_ButtonLeftImage | XSalToolbar_ButtonThinBorder )
.head 8 -  Call SalPicSetFile( hWndItem, sgCaminhoImagens || 'Cancela.bmp' )
.head 7 +  On SAM_Click
.head 8 -  Call SalEndDialog( hWndForm, FALSE )
.head 7 +  On SAM_TooltipSetText
.head 8 -  Return XSalTooltipSetText( lParam, 'Cancelar e Fechar esta Janela' )
.head 5 +  Picture: picBottomSonner
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 56
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left: 0.0"
.head 7 -  Top: 10.0"
.head 7 -  Width:  17.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.43"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  File Name:
.head 6 -  Storage: External
.head 6 -  Picture Transparent Color: None
.head 6 -  Fit: Scale
.head 6 -  Scaling
.head 7 -  Width:  100
.head 7 -  Height:  100
.head 6 -  Corners: Square
.head 6 -  Border Style: No Border
.head 6 -  Border Thickness: 1
.head 6 -  Tile To Parent? No
.head 6 -  Border Color: Default
.head 6 -  Background Color: White
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalGetWindowSize( hWndItem, nX, nZ )
.head 8 -  Call SalGetWindowSize( hWndForm, nX, nY )
.head 8 -  Call SalSetWindowLoc( hWndItem, 0, nY - nZ - nWinStyleAdjust - 0.3 - 0.64 + 0.05 )
.head 4 +  Derived From
.head 5 -  Class: cQuickTabsDialog
.head 4 +  Class Variables
.head 5 -  String: sNome
.head 5 -  String: sTitulo
.head 5 -  Number: nX
.head 5 -  Number: nY
.head 5 -  Number: nZ
.head 5 -  Window Handle: hWndOk
.head 5 -  String: sTitleTextHelp
.head 4 +  Instance Variables
.head 5 -  Number: nWinStyleAdjust
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If nWinStyleAdjust > 0
.head 7 -  Call SalGetWindowSize( hWndForm, nX, nY )
.head 7 -  Call SalSetWindowSize( hWndForm, nX, nY + nWinStyleAdjust )
.head 6 -  Call SalFmtKeepMask( FALSE )
.head 6 -  Call SalCenterWindow( hWndForm )
.head 5 +  On SAM_CreateComplete
.head 6 -  Set nJanelaHandle = SalWindowHandleToNumber( hWndForm )
.head 6 -  Call SalSendMsg( hWndForm, PAM_Reset, 0, 0 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On PAM_Reset
.head 6 -  Call SalSendMsgToChildren( hWndForm, PAM_Reset, 0, 0 )
.head 6 -  Call SalEnableWindow( pbOk )
.head 3 +  Form Window Class: pcForm
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accessories Enabled? Class Default
.head 4 -  Visible? No
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? No
.head 5 -  Initial State: Maximized
.head 5 -  Maximizable? Yes
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? No
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.607"
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: White
.head 4 -  Next Class Child Key: 65
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? No
.head 6 -  Size: 0.821"
.head 6 -  Size Editable? No
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Light Gray
.head 5 -  Contents
.head 4 +  Contents
.head 5 +  Pushbutton: pbExclui
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 50
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Exclui
.head 6 -  Window Location and Size
.head 7 -  Left: 4.25"
.head 7 -  Top: 0.273"
.head 7 -  Width:  0.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.667"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: None
.head 6 -  Image Style: Single
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 +  Message Actions
.head 7 +  On WM_ENABLE
.head 8 -  Call SalSendMsg( hWndToolBar, WM_ENABLE, wParam, 2 )
.head 7 +  On PAM_Reset
.head 8 -  Call SalDisableWindow( hWndItem )
.head 7 +  On PAM_RecordExist
.head 8 -  Call SalEnableWindow( hWndItem )
.head 7 +  On PAM_NewRecord
.head 8 -  Call SalDisableWindow( hWndItem )
.head 7 +  On SAM_Click
.head 8 +  If SalMessageBox( 'Deseja realmente Excluir este Registro?', 'Atenção', MB_IconQuestion | MB_YesNo ) = IDYES
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 5 +  Pushbutton: pbGrava
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 51
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Grava
.head 6 -  Window Location and Size
.head 7 -  Left: 5.15"
.head 7 -  Top: 0.273"
.head 7 -  Width:  0.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.667"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: None
.head 6 -  Image Style: Single
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 +  Message Actions
.head 7 +  On WM_ENABLE
.head 8 -  Call SalSendMsg( hWndToolBar, WM_ENABLE, wParam, 3 )
.head 7 +  On PAM_Reset
.head 8 -  Call SalDisableWindow( hWndItem )
.head 7 +  On PAM_RecordExist
.head 8 -  Call SalEnableWindow( hWndItem )
.head 7 +  On PAM_NewRecord
.head 8 -  Call SalDisableWindow( hWndItem )
.head 5 +  Pushbutton: pbOk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 53
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Ok
.head 6 -  Window Location and Size
.head 7 -  Left: 6.95"
.head 7 -  Top: 0.273"
.head 7 -  Width:  0.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.667"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Keyboard Accelerator: Enter
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: None
.head 6 -  Image Style: Single
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 +  Message Actions
.head 7 +  On WM_ENABLE
.head 8 -  Call SalSendMsg( hWndToolBar, WM_ENABLE, wParam, 4 )
.head 7 +  On PAM_Reset
.head 8 -  Call SalEnableWindow( hWndItem )
.head 7 +  On PAM_NewRecord
.head 8 -  Call SalDisableWindow( hWndItem )
.head 7 +  On PAM_RecordExist
.head 8 -  Call SalDisableWindow( hWndItem )
.head 5 +  Pushbutton: pbCancela
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 52
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Cancela
.head 6 -  Window Location and Size
.head 7 -  Left: 6.05"
.head 7 -  Top: 0.273"
.head 7 -  Width:  0.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.667"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: None
.head 6 -  Image Style: Single
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 +  Message Actions
.head 7 +  On WM_ENABLE
.head 8 -  Call SalSendMsg( hWndToolBar, WM_ENABLE, wParam, 5 )
.head 7 +  On SAM_Click
.head 8 -  Call SalSendMsg( hWndForm, PAM_Reset, wParam, lParam )
.head 8 -  Call SalSendMsg( hWndToolBar, PAM_Reset, 0, 0 )
.head 5 +  Pushbutton: pbSeleciona
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 54
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Seleção
.head 6 -  Window Location and Size
.head 7 -  Left: 7.85"
.head 7 -  Top: 0.273"
.head 7 -  Width:  0.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.667"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: None
.head 6 -  Image Style: Single
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 +  Message Actions
.head 7 +  On WM_ENABLE
.head 8 -  Call SalSendMsg( hWndToolBar, WM_ENABLE, wParam, 6 )
.head 7 +  On SAM_TooltipSetText
.head 8 +  If SalIsWindowEnabled( hWndItem ) and SalIsWindowVisible( hWndItem )
.head 9 -  Return XSalTooltipSetText( lParam, "Seleciona o registro" )
.head 7 +  On PAM_Reset
.head 8 -  Call SalEnableWindow( hWndItem )
.head 7 +  On PAM_NewRecord
.head 8 -  Call SalDisableWindow( hWndItem )
.head 7 +  On PAM_RecordExist
.head 8 -  Call SalDisableWindow( hWndItem )
.head 7 +  On SAM_Create
.head 8 -  Call SalHideWindow( hWndItem )
.head 8 -  Call XSalToolboxSetButtonStyle( hWndItem,  XSalToolbar_ButtonThinBorder  )
.head 5 +  Pushbutton: pbSaida
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 55
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: &Fechar
.head 6 -  Window Location and Size
.head 7 -  Left: 8.75"
.head 7 -  Top: 0.273"
.head 7 -  Width:  0.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.667"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: None
.head 6 -  Image Style: Single
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 +  Message Actions
.head 7 +  On SAM_Click
.head 8 +  If SalMsgPergunta( "Deseja sair desse formulário ?" )
.head 9 -  Call SalDestroyWindow( hWndForm )
.head 9 -  Call SalSendMsg( hWndToolBar, PAM_Reset, 24, lParam )
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sTitleTextHelp
.head 5 -  Boolean: bTipoDefault
.head 5 -  Number: nX
.head 5 -  Number: nY
.head 5 -  Boolean: bValidacaoSaida
.head 5 -  Boolean: bNaoMostrarConfirmacaoExclusao
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On PAM_Reset
.head 6 -  Call SalUpdateWindow( hWndForm )
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Set bPAMSelect = TRUE
.head 6 -  Call SalSendMsgToChildren( hWndForm, PAM_Reset, wParam, 0 )
.head 6 -  Call SalSendMsg( hWndToolBar, PAM_Reset, wParam, 0 )
.head 6 -  Set bPAMSelect = FALSE
.head 6 -  Call SalUpdateWindow( hWndForm )
.head 6 -  Call SalSetDefButton( pbOk )
.head 6 -  Call SalSetFocus( pbOk )
.head 6 -  Call SalUpdateWindow( hWndForm )
.head 6 -  Set bValidacaoSaida = TRUE
.head 5 +  On PAM_Refresh
.head 6 -  Call SalSendMsgToChildren( hWndForm, PAM_Refresh, 0, 0 )
.head 5 +  On PAM_NewRecord
.head 6 -  Call SalSendMsgToChildren( hWndForm, PAM_NewRecord, 0, 0 )
.head 6 -  Call SalSendMsg( hWndToolBar, PAM_NewRecord, 0, 0 )
.head 5 +  On PAM_RecordExist
.head 6 -  Call SalSendMsgToChildren( hWndForm, PAM_RecordExist, 0, 0 )
.head 6 -  Call SalSendMsg( hWndToolBar, PAM_NewRecord, 0, 0 )
.head 5 +  On SAM_Create
.head 6 -  Set bTipoDefault = TRUE
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalSendMsg( hWndForm, PAM_Reset, 0, 0 )
.head 6 -  Call SalGetWindowText( hWndForm, sJanelaAtual, 100 )
.head 6 -  Set nJanelaHandle = SalWindowHandleToNumber( hWndForm )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On PAM_Trim
.head 6 -  Call SalSendMsgToChildren( hWndForm, PAM_Trim, 0, 0 )
.head 5 +  On PAM_ButtomClick
.head 6 +  Select Case wParam
.head 7 +  Case 1
.head 8 +  If SalIsWindowEnabled( pbExclui )
.head 9 -  Call SalSendMsg( pbExclui, SAM_Click, 0, 0 )
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 +  Case 2
.head 8 +  If SalIsWindowEnabled( pbGrava )
.head 9 -  Call SalSendMsg( pbGrava, SAM_Click, 0, 0 )
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 +  Case 3
.head 8 +  If SalIsWindowEnabled( pbOk )
.head 9 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 +  Case 4
.head 8 +  If SalIsWindowEnabled( pbCancela )
.head 9 -  Call SalSendMsg( pbCancela, SAM_Click, 0, 0 )
.head 9 -  Return bValidacaoSaida
.head 9 -  ! Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 +  Case 5
.head 8 +  If SalIsWindowEnabled( pbSeleciona )
.head 9 -  Call SalSendMsg( pbSeleciona, SAM_Click, 0, 0 )
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 +  Case 6
.head 8 +  If SalIsWindowEnabled( pbSaida )
.head 9 -  Call SalSendMsg( pbSaida, SAM_Click, 0, 0 )
.head 9 -  Return bValidacaoSaida
.head 9 -  ! Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 -  ! Get Variaveis de Form
.head 7 +  Case 99
.head 8 +  If lParam = 1
.head 9 -  Return bNaoMostrarConfirmacaoExclusao
.head 5 +  On PAM_DestroyForm
.head 6 +  If wParam = 999 And lParam = 999
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 3 +  Form Window Class: pcFormTabs
.head 4 -  Title:
.head 4 -  Icon File:
.head 4 -  Accessories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Automatically Created at Runtime? No
.head 5 -  Initial State: Class Default
.head 5 -  Maximizable? Class Default
.head 5 -  Minimizable? Class Default
.head 5 -  System Menu? Class Default
.head 5 -  Resizable? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  9.25"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 5.702"
.head 6 -  Height Editable? Class Default
.head 5 -  Form Size
.head 6 -  Width:  Class Default
.head 6 -  Height: Class Default
.head 6 -  Number of Pages: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 36
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cQuickTabsForm
.head 5 -  Class: pcForm
.head 4 -  Menu
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 +  Contents
.head 5 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000600
0020: 4E616D6530000054 6162426F74746F6D 4D617267696E0002 0030000054616250
0040: 616765436F756E74 0002003100005461 624C6162656C7300 07004C6162656C30
0060: 00005461624E616D 65730006004E616D 6530000054616252 696768744D617267
0080: 696E000200300000 5461624472617753 74796C65000B0057 696E39355374796C
00A0: 650000546162466F 726D506167657300 0100000054616254 6F704D617267696E
00C0: 0002003000000000 0000000000000000 0000000000000000 0000
.enddata
.data CLASSPROPSSIZE
0000: DA00
.enddata
.head 6 -  Class Child Ref Key: 1
.head 6 -  Class ChildKey: 4
.head 6 -  Class: cQuickTabsForm
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Window Location and Size
.head 7 -  Left: 0.033"
.head 7 -  Top: 1.048"
.head 7 -  Width:  14.183"
.head 7 -  Width Editable? Class Default
.head 7 -  Height: 6.369"
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  File Name:
.head 6 -  Storage: Class Default
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Fit: Class Default
.head 6 -  Scaling
.head 7 -  Width:  Class Default
.head 7 -  Height:  Class Default
.head 6 -  Corners: Class Default
.head 6 -  Border Style: Class Default
.head 6 -  Border Thickness: Class Default
.head 6 -  Tile To Parent? No
.head 6 -  Border Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 +  Message Actions
.head 7 +  On TABSM_TabActivateFinish
.head 8 -  Call VarreObjetos( )
.head 7 +  On TABSM_Create
.head 8 -  Call VarreObjetos( )
.head 7 +  On PAM_Reset
.head 8 -  Call picTabs.BringToTop( 0, TRUE )
.head 8 -  Set nTotalTabs = picTabs.GetCount( )
.head 8 -  Set nCountTabs = 0
.head 8 +  While nCountTabs <= nTotalTabs
.head 9 -  Call picTabs.Enable( nCountTabs, FALSE )
.head 9 -  Set nCountTabs = nCountTabs + 1
.head 7 +  On SAM_CreateComplete
.head 8 -  Call SalSendMsg( hWndItem, PAM_Reset, 0, 0 )
.head 7 +  On PAM_NewRecord
.head 8 -  Set nTotalTabs = picTabs.GetCount( )
.head 8 -  Set nCountTabs = 0
.head 8 +  While nCountTabs <= nTotalTabs
.head 9 -  Call picTabs.Enable( nCountTabs, TRUE )
.head 9 -  Set nCountTabs = nCountTabs + 1
.head 7 +  On PAM_RecordExist
.head 8 -  Set nTotalTabs = picTabs.GetCount( )
.head 8 -  Set nCountTabs = 0
.head 8 +  While nCountTabs <= nTotalTabs
.head 9 -  Call picTabs.Enable( nCountTabs, TRUE )
.head 9 -  Set nCountTabs = nCountTabs + 1
.head 5 +  Pushbutton: pbExclui
.head 6 -  Class Child Ref Key: 50
.head 6 -  Class ChildKey: 28
.head 6 -  Class: pcForm
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left: Class Default
.head 7 -  Top: Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Keyboard Accelerator: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Image Style: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Pushbutton: pbGrava
.head 6 -  Class Child Ref Key: 51
.head 6 -  Class ChildKey: 29
.head 6 -  Class: pcForm
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left: Class Default
.head 7 -  Top: Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Keyboard Accelerator: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Image Style: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Pushbutton: pbOk
.head 6 -  Class Child Ref Key: 53
.head 6 -  Class ChildKey: 30
.head 6 -  Class: pcForm
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left: Class Default
.head 7 -  Top: Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Keyboard Accelerator: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Image Style: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Pushbutton: pbCancela
.head 6 -  Class Child Ref Key: 52
.head 6 -  Class ChildKey: 31
.head 6 -  Class: pcForm
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left: Class Default
.head 7 -  Top: Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Keyboard Accelerator: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Image Style: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Pushbutton: pbSeleciona
.head 6 -  Class Child Ref Key: 54
.head 6 -  Class ChildKey: 32
.head 6 -  Class: pcForm
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left: Class Default
.head 7 -  Top: Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Keyboard Accelerator: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Image Style: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 5 +  Pushbutton: pbSaida
.head 6 -  Class Child Ref Key: 55
.head 6 -  Class ChildKey: 33
.head 6 -  Class: pcForm
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left: Class Default
.head 7 -  Top: Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Keyboard Accelerator: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Picture File Name:
.head 6 -  Picture Transparent Color: Class Default
.head 6 -  Image Style: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Message Actions
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nCountTabs
.head 5 -  Number: nTotalTabs
.head 4 +  Functions
.head 5 +  Function: VarreObjetos
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hWndJanela
.head 7 -  Window Handle: hWndObjeto
.head 7 -  String: sConteudoCampo
.head 7 -  String: sNomeObjeto
.head 6 +  Actions
.head 7 -  ! ! DataField
.head 7 -  Set hWndJanela = hWndForm
.head 7 -  Set hWndObjeto = SalGetFirstChild( hWndJanela, TYPE_Picture )
.head 7 +  While hWndObjeto != hWndNULL
.head 8 -  Call SalGetWindowText( hWndObjeto, sConteudoCampo, 254 )
.head 8 -  Call SalGetItemName( hWndObjeto, sNomeObjeto )
.head 8 +  If SalWindowIsDerivedFromClass( hWndObjeto, pcVisualBaseComponent )
.head 9 +  If picTabs.IsAssociatedWithTab( picTabs.GetTop( ), hWndObjeto )
.head 10 -  Call SalSendMsg( hWndObjeto, PAM_Command, 1, 1 )
.head 9 +  Else
.head 10 -  Call SalSendMsg( hWndObjeto, PAM_Command, 1, 2 )
.head 8 -  Set hWndObjeto = SalGetNextChild( hWndObjeto, TYPE_Picture )
.head 5 +  Function: VerificaFilhoTabs
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWndFilho
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nMax
.head 7 -  String: sName
.head 6 +  Actions
.head 7 -  Set nMax = picTabs.GetCount()
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha <= nMax
.head 8 +  If picTabs.IsAssociatedWithTab( nLinha, hWndFilho )
.head 9 -  Return TRUE
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Call SalGetItemName( hWndFilho, sName )
.head 7 -  Set nLinha = 0
.head 7 +  While picTabs.Items[ nLinha ].m_sForm != ''
.head 8 +  If picTabs.Items[ nLinha ].m_sForm = sName
.head 9 -  Return TRUE
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Return FALSE
.head 5 +  Function: VerificaFilhoTabsBringTop
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWndFilho
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nMax
.head 7 -  String: sName
.head 6 +  Actions
.head 7 -  Set nMax = picTabs.GetCount()
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha <= nMax
.head 8 +  If picTabs.IsAssociatedWithTab( nLinha, hWndFilho )
.head 9 -  Call picTabs.BringToTop( nLinha, FALSE )
.head 9 -  Return TRUE
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Call SalGetItemName( hWndFilho, sName )
.head 7 -  Set nLinha = 0
.head 7 +  While picTabs.Items[ nLinha ].m_sForm != ''
.head 8 +  If picTabs.Items[ nLinha ].m_sForm = sName
.head 9 -  Return TRUE
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Return FALSE
.head 4 +  Message Actions
.head 5 +  On PAM_VerificaFilhoTabs
.head 6 -  Return VerificaFilhoTabs( SalNumberToWindowHandle( wParam ) )
.head 5 +  On PAM_VerificaFilhoTabsBringTop
.head 6 -  Return VerificaFilhoTabsBringTop( SalNumberToWindowHandle( wParam ) )
.head 3 +  Radio Button Class: pcRadioButton
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: White
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Radio Button Class: pcRadioButtonKey
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: White
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasseKey
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Check Box Class: pcCheckBox
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On PAM_Reset
.head 6 -  Call SalSendClassMessage( PAM_Reset, wParam, lParam )
.head 6 -  Set MyValue = FALSE
.head 3 +  Check Box Class: pcCheckBoxKey
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasseKey
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On PAM_Reset
.head 6 -  Call SalSendClassMessage( PAM_Reset, wParam, lParam )
.head 6 -  Set MyValue = FALSE
.head 3 +  Data Field Class: pcDataField
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  0.825"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description: Classe padrão para DataFields.
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Boolean: bRetorno
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On VTM_KeyDown
.head 6 +  If ( wParam = VK_F3 ) And ( VisGetKeyState( VK_Control )  & KS_Down )
.head 7 -  Set bPAMSelect = TRUE
.head 7 -  Call SalSendMsg( hWndItem, PAM_Select, 0, 0 )
.head 7 -  Set bPAMSelect = FALSE
.head 6 +  If ( wParam = VK_F9 )
.head 7 -  Set bPAMSelect = TRUE
.head 7 -  Call SalSendMsg( hWndItem, PAM_ValorPadrao, 0, 0 )
.head 7 -  Set bPAMSelect = FALSE
.head 5 +  On PAM_ValorPadrao
.head 6 +  If ( ( SalGetType ( hWndItem ) = TYPE_DataField ) Or (SalGetType ( hWndItem ) = TYPE_MultilineText) )
.head 7 -  Call SalSendMsg( SalParentWindow( hWndItem ), PAM_ValorPadrao, SalWindowHandleToNumber( hWndItem ), 0 )
.head 6 +  If ( (SalGetType ( hWndItem ) = TYPE_TableColumn) )
.head 7 +  If ( SalGetType( SalParentWindow( hWndItem ) ) = TYPE_ChildTable )
.head 8 -  Call SalSendMsg( SalParentWindow( SalParentWindow( hWndItem ) ), PAM_ValorPadrao, SalWindowHandleToNumber( hWndItem ), 0 )
.head 3 +  Data Field Class: pcDataFieldKey
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  0.825"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description: Classe padrão para DataFields.
.head 4 +  Derived From
.head 5 -  Class: pcClasseKey
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On VTM_KeyDown
.head 6 +  If ( wParam = VK_F3 ) And ( VisGetKeyState( VK_Control )  & KS_Down )
.head 7 -  Set bPAMSelect = TRUE
.head 7 -  Call SalSendMsg( hWndItem, PAM_Select, 0, 0 )
.head 7 -  Set bPAMSelect = FALSE
.head 5 +  On PAM_Reset
.head 6 -  Call SalFmtKeepMask( FALSE )
.head 6 -  Call SalClearField( hWndItem )
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 5 +  On PAM_NewRecord
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  On PAM_RecordExist
.head 6 -  Call SalDisableWindow( hWndItem )
.head 3 +  Data Field Class: pcDataFieldShow
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  3.817"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On PAM_Reset
.head 6 -  Call SalFmtKeepMask( FALSE )
.head 6 -  Call SalClearField( hWndItem )
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_LightGray )
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 5 +  On PAM_NewRecord
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  On PAM_RecordExist
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 -  On WM_ENABLE
.head 5 -  On SAM_Validate
.head 5 -  On PAM_Validate
.head 3 +  Data Field Class: pcDataFieldShowWhite
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  3.817"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Black
.head 5 -  Background Color: White
.head 5 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On PAM_Reset
.head 6 -  Call SalFmtKeepMask( FALSE )
.head 6 -  Call SalClearField( hWndItem )
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_White )
.head 6 -  Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 5 +  On PAM_NewRecord
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  On PAM_RecordExist
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 -  On WM_ENABLE
.head 5 -  On SAM_Validate
.head 5 -  On PAM_Validate
.head 3 +  Combo Box Class: pcComboBoxCodigoOcultoBase
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: naCODIGOS[*]
.head 5 -  String: saCODIGOS[*]
.head 5 -  Number: nIndex
.head 4 +  Functions
.head 5 +  Function: AddValue
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nCODIGO
.head 7 -  String: sDESCRICAO
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nInd
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 -  Set nInd = 0
.head 7 -  Call SalArrayGetUpperBound( naCODIGOS, 1, nMax )
.head 7 +  While nInd < nMax
.head 8 +  If naCODIGOS[ nInd ] = nCODIGO
.head 9 -  Return FALSE
.head 8 -  Set nInd = nInd + 1
.head 7 -  !
.head 7 -  Call Add( nCODIGO, SalNumberToStrX( nCODIGO, 0), sDESCRICAO )
.head 7 -  ! Set naCODIGOS[ nIndex ] = nCODIGO
.head 7 -  ! Set saCODIGOS[ nIndex ] = SalNumberToStrX( nCODIGO, 0)
.head 7 -  ! Set nIndex = nIndex + 1
.head 7 -  ! Call SalListAdd( hWndItem, )
.head 7 -  Return TRUE
.head 5 +  Function: AddValueStr
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sCODIGO
.head 7 -  String: sDESCRICAO
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nInd
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 -  Set nInd = 0
.head 7 -  Call SalArrayGetUpperBound( saCODIGOS, 1, nMax )
.head 7 +  While nInd < nMax
.head 8 +  If saCODIGOS[ nInd ] = sCODIGO
.head 9 -  Return FALSE
.head 8 -  Set nInd = nInd + 1
.head 7 -  !
.head 7 -  Call Add( nIndex, sCODIGO, sDESCRICAO )
.head 7 -  Return TRUE
.head 5 +  Function: GetCodigo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nSelection
.head 6 +  Actions
.head 7 -  Set nSelection = SalListQuerySelection(hWndItem)
.head 7 +  If nSelection > -1 and nSelection < nIndex
.head 8 -  Return naCODIGOS[ nSelection ]
.head 7 +  Else
.head 8 -  Return -1
.head 5 +  Function: GetCodigoStr
.head 6 -  Description: Retorna o código com STRING
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nSelection
.head 6 +  Actions
.head 7 -  Set nSelection = SalListQuerySelection(hWndItem)
.head 7 +  If nSelection > -1 and nSelection < nIndex
.head 8 -  Return saCODIGOS[ nSelection ]
.head 7 -  Return STRING_Null
.head 5 +  Function: IsNadaSelecionado
.head 6 -  Description: Verifica se o item selecionado é 0 ou nenhum, caso positivo, ele considera que nada esta selecionado
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nSelection
.head 6 +  Actions
.head 7 -  Set nSelection = SalListQuerySelection(hWndItem)
.head 7 +  If nSelection > -1 and nSelection < nIndex
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: PopulaPorSQL
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  String: sNOMECOLUNACODIGO
.head 7 -  String: sNOMECOLUNADESCRICAO
.head 7 -  String: sNOMETABELA
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: saDESCRICOES[*]
.head 6 +  Actions
.head 7 -  Call Reset ()
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
   Select Distinct ' || sNOMECOLUNACODIGO || ', ' || sNOMECOLUNADESCRICAO || '
    Into :naCODIGOS[nIndex], :saDESCRICOES[nIndex]
    From ' || sNOMETABELA || '
    Order By ' || sNOMECOLUNADESCRICAO )
.head 7 +  While SqlFetchNext( hSqlParam, nFetch1 )
.head 8 -  Call SalListAdd( hWndItem, saDESCRICOES[nIndex] )
.head 8 -  Set saCODIGOS[nIndex] = SalNumberToStrX( naCODIGOS[nIndex], 0)
.head 8 -  Set nIndex = nIndex + 1
.head 5 +  Function: PopulaPorSQLComOrder
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  String: sNOMECOLUNACODIGO
.head 7 -  String: sNOMECOLUNADESCRICAO
.head 7 -  String: sNOMETABELA
.head 7 -  String: sNOMECOLUNAORDER
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: saDESCRICOES[*]
.head 6 +  Actions
.head 7 -  Call Reset ()
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
   Select Distinct ' || sNOMECOLUNACODIGO || ', ' || sNOMECOLUNADESCRICAO || '
    Into :naCODIGOS[nIndex], :saDESCRICOES[nIndex]
    From ' || sNOMETABELA || '
    Order By ' || sNOMECOLUNAORDER )
.head 7 +  While SqlFetchNext( hSqlParam, nFetch1 )
.head 8 -  Call SalListAdd( hWndItem, saDESCRICOES[nIndex] )
.head 8 -  Set saCODIGOS[nIndex] = SalNumberToStrX( naCODIGOS[nIndex], 0)
.head 8 -  Set nIndex = nIndex + 1
.head 5 +  Function: PopulaPorSQLComWhere
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  String: sNOMECOLUNACODIGO
.head 7 -  String: sNOMECOLUNADESCRICAO
.head 7 -  String: sNOMETABELA
.head 7 -  String: sWhere
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: saDESCRICOES[*]
.head 6 +  Actions
.head 7 -  Call Reset ()
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
   Select Distinct ' || sNOMECOLUNACODIGO || ', ' || sNOMECOLUNADESCRICAO || '
    Into :naCODIGOS[nIndex], :saDESCRICOES[nIndex]
    From ' || sNOMETABELA || '
    Where ' || sWhere || '
    Order By ' || sNOMECOLUNADESCRICAO )
.head 7 +  While SqlFetchNext( hSqlParam, nFetch1 )
.head 8 -  Call SalListAdd( hWndItem, saDESCRICOES[nIndex] )
.head 8 -  Set saCODIGOS[nIndex] = SalNumberToStrX( naCODIGOS[nIndex], 0)
.head 8 -  Set nIndex = nIndex + 1
.head 5 +  Function: PopulaPorSQLComCodigo
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  String: sNOMECOLUNACODIGO
.head 7 -  String: sNOMECOLUNADESCRICAO
.head 7 -  String: sNOMETABELA
.head 7 -  Number: nQtdeCasas
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: saDESCRICOES[*]
.head 6 +  Actions
.head 7 -  Call Reset ()
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
   Select Distinct ' || sNOMECOLUNACODIGO || ', ' || sNOMECOLUNADESCRICAO || '
    Into :naCODIGOS[nIndex], :saDESCRICOES[nIndex]
    From ' || sNOMETABELA || '
    Order By ' || sNOMECOLUNACODIGO )
.head 7 +  While SqlFetchNext( hSqlParam, nFetch1 )
.head 8 -  Call SalListAdd( hWndItem,   SalStrRightX( SalStrRepeatX( '0',  nQtdeCasas ) || SalNumberToStrX(naCODIGOS[nIndex], 0 ), nQtdeCasas) || ' - ' ||  saDESCRICOES[nIndex] )
.head 8 -  Set saCODIGOS[nIndex] = SalNumberToStrX( naCODIGOS[nIndex], 0)
.head 8 -  Set nIndex = nIndex + 1
.head 5 +  Function: PopulaPorSQLSTR
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  String: sNOMECOLUNACODIGO
.head 7 -  String: sNOMECOLUNADESCRICAO
.head 7 -  String: sNOMETABELA
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: saDESCRICOES[*]
.head 6 +  Actions
.head 7 -  Call Reset ()
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
   Select Distinct ' || sNOMECOLUNACODIGO || ', ' || sNOMECOLUNADESCRICAO || '
    Into :saCODIGOS[nIndex], :saDESCRICOES[nIndex]
    From ' || sNOMETABELA || '
    Order By ' || sNOMECOLUNADESCRICAO )
.head 7 +  While SqlFetchNext( hSqlParam, nFetch1 )
.head 8 -  Call SalListAdd( hWndItem, saDESCRICOES[nIndex] )
.head 8 -  Set naCODIGOS[nIndex] = nIndex
.head 8 -  Set nIndex = nIndex + 1
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalListClear(hWndItem)
.head 7 -  Call SalArraySetUpperBound(naCODIGOS, 1, -1)
.head 7 -  Call SalArraySetUpperBound(saCODIGOS, 1, -1)
.head 7 -  Set nIndex = 0
.head 7 -  ! Call AddValue( 0, 'Nenhum' )
.head 5 +  Function: SetCodigo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nCODIGO
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndexTmp
.head 6 +  Actions
.head 7 -  Set nIndexTmp = 0
.head 7 +  While nIndexTmp < nIndex
.head 8 +  If naCODIGOS[nIndexTmp] = nCODIGO
.head 9 -  Call SalListSetSelect(hWndItem, nIndexTmp)
.head 9 -  Return TRUE
.head 8 -  Set nIndexTmp = nIndexTmp + 1
.head 7 -  Return FALSE
.head 5 +  Function: SetCodigoStr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sCODIGO_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndexTmp
.head 7 -  Number: nCODIGO
.head 6 +  Actions
.head 7 -  Set nIndexTmp = 0
.head 7 +  While nIndexTmp < nIndex
.head 8 +  If saCODIGOS[nIndexTmp] = sCODIGO_p
.head 9 -  Call SalListSetSelect( hWndItem, nIndexTmp )
.head 9 -  Return TRUE
.head 8 -  Set nIndexTmp = nIndexTmp + 1
.head 7 -  Return FALSE
.head 5 +  Function: Add
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nCodigo_p
.head 7 -  String: sCodigo_p
.head 7 -  String: sDescricao_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set naCODIGOS[ nIndex ] = nCodigo_p
.head 7 -  Set saCODIGOS[ nIndex ] = sCodigo_p
.head 7 -  Call SalListAdd( hWndItem, sDescricao_p)
.head 7 -  Set nIndex = nIndex + 1
.head 5 +  Function: SetFirstCodigo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty(naCODIGOS)
.head 8 -  Call SetCodigo( naCODIGOS[0] )
.head 8 -  Return TRUE
.head 7 -  Return FALSE
.head 5 +  Function: GetCount
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalArrayIsEmpty( saCODIGOS ) and SalArrayIsEmpty( naCODIGOS )
.head 8 -  Return 0
.head 7 +  Else
.head 8 -  Return (nIndex + 1)
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete
.head 6 -  Call Reset ()
.head 3 +  Combo Box Class: pcComboBoxCodigoOculto
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcComboCompletaEdicao
.head 5 -  Class: pcComboBoxCodigoOcultoBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Combo Box Class: pcComboBoxCodigoOcultoKey
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcComboCompletaEdicaoKey
.head 5 -  Class: pcComboBoxCodigoOcultoBase
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Combo Box Class: pcComboCompletaEdicao
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcComboBoxBase
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_KillFocus
.head 6 +  If NOT iv_bAllowNewValues		! only allowed to select from list
.head 7 +  If SalListSelectString( hWndItem, -1, MyValue ) = LB_Err
.head 8 -  Set MyValue = STRING_Null
.head 6 -  Set hWndDataFieldAnterior = hWndItem
.head 5 +  On WM_KEYDOWN
.head 6 +  Select Case wParam
.head 7 +  Case VK_Backspace
.head 8 -  Call __cfnBackspace( )
.head 8 -  Return 0
.head 7 +  Case VK_Delete
.head 8 -  Call __cfnDeleteSelected( )
.head 8 -  Return 0
.head 5 +  On SAM_AnyEdit
.head 6 -  Call __cfnSelectAhead ()
.head 6 -  Call SetComponenteEditado(TRUE)
.head 3 +  General Window Class: pcClasse
.head 4 -  Description:
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  Boolean: bRetorno
.head 5 -  Window Handle: hWndFoco
.head 4 +  Instance Variables
.head 5 -  String: sValor
.head 5 -  Number: nQtde
.head 5 -  Number: nI
.head 5 -  Number: nOldColor
.head 5 -  Window Handle: whParent
.head 5 -  Number: bCOMPONENTE_EDITADO
.head 4 +  Functions
.head 5 +  Function: ValidaAno
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Date/Time: dtAux
.head 7 -  String: sMascara
.head 7 -  String: sValor
.head 7 -  Number: nAns
.head 6 +  Actions
.head 7 -  Call SalFmtGetPicture( hWndItem, sMascara )
.head 7 -  Set nAns = SalStrScan( sMascara, 'yyyy' )
.head 7 +  If nAns >= 0
.head 8 -  Call SalGetWindowText( hWndItem, sValor, 100 )
.head 8 +  If SalStrLength( sMascara ) = SalStrLength( sValor )
.head 9 +  If SalStrToNumber( SalStrMidX( sValor, nAns, 4 ) ) < 1900
.head 10 -  Return FALSE
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: GetComponenteEditado
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bCOMPONENTE_EDITADO
.head 5 +  Function: SetComponenteEditado
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bPARAM
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bCOMPONENTE_EDITADO = bPARAM
.head 4 +  Message Actions
.head 5 +  On PAM_Reset
.head 6 -  Set bCOMPONENTE_EDITADO = FALSE
.head 6 -  Call SalDisableWindow( hWndItem )
.head 6 +  If SalGetType( hWndItem ) = TYPE_DataField or SalGetType( hWndItem ) = TYPE_MultilineText or
   SalGetType( hWndItem ) = TYPE_TableColumn or SalGetType( hWndItem ) = TYPE_ComboBox
.head 7 -  Call SalFmtKeepMask( FALSE )
.head 7 -  Call SalClearField( hWndItem )
.head 7 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 6 +  Else If SalGetType( hWndItem ) = TYPE_TableWindow or
           SalGetType( hWndItem ) = TYPE_ChildTable
.head 7 -  Call SalTblReset( hWndItem )
.head 7 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
.head 5 +  On PAM_NewRecord
.head 6 -  Call SalEnableWindow( hWndItem )
.head 5 +  On PAM_RecordExist
.head 6 +  If SalGetDataType( hWndItem ) = DT_String  or SalGetDataType( hWndItem ) = DT_LongString
.head 7 -  Call SalGetWindowText( hWndItem, sValor, 99999 )
.head 7 -  Call SalSetWindowText( hWndItem, SalStrTrimX( sValor ) )
.head 6 -  Call SalEnableWindow( hWndItem )
.head 5 +  On SAM_AnyEdit
.head 6 -  Set bCOMPONENTE_EDITADO = TRUE
.head 5 -  !
.head 5 +  On SAM_Validate
.head 6 +  If bDestroyForm Or bPAMSelect
.head 7 -  Return VALIDATE_Ok
.head 6 +  If wParam = 0
.head 7 -  Set wParam = SalWindowHandleToNumber( XSalToolboxGetButtonHandle( ) )
.head 7 +  If wParam = 0
.head 8 -  Call SalSendMsg( hWndItem, SAM_FieldEdit, 0, 0 )
.head 8 -  Return VALIDATE_Ok
.head 6 -  Call SalArrayGetUpperBound( hWndValidate, 1, nQtde )
.head 6 -  ! Set nI = 0
.head 6 +  ! While nI < nQtde
.head 7 +  If SalWindowHandleToNumber( hWndValidate[nI] ) = wParam
.head 8 -  Return VALIDATE_Ok
.head 7 -  Set nI = nI + 1
.head 6 +  If SalGetDataType( hWndItem ) = DT_DateTime And ( not SalIsNull( hWndItem ) )
.head 7 +  If not SalIsValidDateTime( hWndItem )
.head 8 -  Call SalMessageBox( 'Valor de Data inválida ! ', 'Erro', MB_Ok | MB_IconStop )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If not ValidaAno(  )
.head 8 -  Call SalMessageBox( 'Ano inválido ! ', 'Erro', MB_Ok | MB_IconStop )
.head 8 -  Return VALIDATE_Cancel
.head 6 +  If SalGetDataType( hWndItem ) = DT_Number And ( not SalIsNull( hWndItem ) ) And ( not SalIsValidNumber( hWndItem ) )
.head 7 -  Call SalMessageBox( 'Valor Numérico inválido ! ', 'Erro', MB_Ok | MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Set bRetorno = SalSendMsg( hWndItem, PAM_Validate, wParam, lParam )
.head 6 +  If bRetorno
.head 7 -  Call SalSendMsg( hWndItem, SAM_FieldEdit, 0, 0 )
.head 6 -  Return bRetorno
.head 5 +  On PAM_Validate
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_SetFocus
.head 6 +  If not bDestroyForm
.head 7 +  If SalIsWindowEnabled( hWndItem )
.head 8 -  Set nI = SalGetType( hWndItem )
.head 8 +  If nI = TYPE_DataField or nI = TYPE_MultilineText or nI = TYPE_TableColumn or nI = TYPE_CustControl
.head 9 -  ! Tirando cor
.head 9 +  If hWndFoco != hWndNULL
.head 10 +  If SalIsWindowEnabled( hWndFoco )
.head 11 +  If nOldColor = 0
.head 12 -  Set nOldColor = COLOR_White
.head 11 -  Call SalColorSet( hWndFoco, COLOR_IndexWindow, nOldColor )
.head 9 -  ! Colocando Cor
.head 9 -  Set nOldColor = SalColorGet( hWndItem, COLOR_IndexWindow )
.head 9 +  If nSonCorObjetoSelecionado = 0
.head 10 -  Set nSonCorObjetoSelecionado = SalColorFromRGB( 255, 255, 220 )
.head 9 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, nSonCorObjetoSelecionado )
.head 9 -  Set hWndFoco = hWndItem
.head 5 +  On PAM_Trim
.head 6 +  If SalGetDataType ( hWndItem ) = DT_String And SalGetType( hWndItem ) != TYPE_ComboBox And SalGetType( hWndItem ) != TYPE_ListBox
.head 7 -  Call SalGetWindowText(hWndItem, sValor, 99999 )
.head 7 -  Call SalSetWindowText(  hWndItem,  SalStrTrimX( sValor )  )
.head 5 +  On WM_ENABLE
.head 6 -  Set nI = SalGetType( hWndItem )
.head 6 +  If nI = TYPE_DataField or nI = TYPE_MultilineText or nI = TYPE_TableColumn or
   nI = TYPE_ComboBox or nI = TYPE_ListBox or nI = TYPE_CustControl
.head 7 +  If wParam
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_White )
.head 8 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 7 +  Else
.head 8 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_LightGray )
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, SalColorFromRGB( 230, 230, 230 ) )
.head 8 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 5 +  On PAM_Command
.head 6 +  If wParam = PCCLASS_FIELD_GetValue
.head 7 +  If lParam = PCCLASS_FIELD_COMPONENTEEDITADO
.head 8 -  Return GetComponenteEditado ()
.head 5 +  On SAM_ContextMenu
.head 6 -  !
.head 6 +  If Not SalIsNull( hWndItem )
.head 7 -  Call SalTrackPopupMenu( hWndForm, 'menuCopiaConteudo', TPM_CursorX | TPM_CursorY, 0, 0 )
.head 3 +  General Window Class: pcClasseKey
.head 4 -  Description:
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  Boolean: bRetorno
.head 5 -  Window Handle: hWndFoco
.head 4 +  Instance Variables
.head 5 -  String: sValor
.head 5 -  Number: nProximoRegistro
.head 5 -  Number: nQtde
.head 5 -  Number: nI
.head 5 -  Number: nOldColor
.head 5 -  Date/Time: dtAux
.head 5 -  Number: bCOMPONENTE_EDITADO
.head 4 +  Functions
.head 5 +  Function: ValidaAno
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Date/Time: dtAux
.head 7 -  String: sMascara
.head 7 -  String: sValor
.head 7 -  Number: nAns
.head 6 +  Actions
.head 7 -  Call SalFmtGetPicture( hWndItem, sMascara )
.head 7 -  Set nAns = SalStrScan( sMascara, 'yyyy' )
.head 7 +  If nAns >= 0
.head 8 -  Call SalGetWindowText( hWndItem, sValor, 100 )
.head 8 +  If SalStrLength( sMascara ) = SalStrLength( sValor )
.head 9 +  If SalStrToNumber( SalStrMidX( sValor, nAns, 4 ) ) < 1900
.head 10 -  Return FALSE
.head 7 -  Return TRUE
.head 5 -  !
.head 5 +  Function: GetComponenteEditado
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return bCOMPONENTE_EDITADO
.head 5 +  Function: SetComponenteEditado
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bPARAM
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bCOMPONENTE_EDITADO = bPARAM
.head 4 +  Message Actions
.head 5 +  On PAM_Reset
.head 6 -  Set bCOMPONENTE_EDITADO = FALSE
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 +  If SalGetType( hWndItem ) = TYPE_DataField or SalGetType( hWndItem ) = TYPE_MultilineText or SalGetType( hWndItem ) = TYPE_TableColumn or SalGetType( hWndItem ) = TYPE_ComboBox
.head 7 -  Call SalFmtKeepMask( FALSE )
.head 7 -  Call SalClearField( hWndItem )
.head 7 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 6 +  Else If SalGetType( hWndItem ) = TYPE_TableWindow or SalGetType( hWndItem ) = TYPE_ChildTable
.head 7 -  Call SalTblReset( hWndItem )
.head 7 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
.head 5 +  On PAM_NewRecord
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  On PAM_RecordExist
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  On SAM_AnyEdit
.head 6 -  Set bCOMPONENTE_EDITADO = TRUE
.head 5 -  !
.head 5 +  On SAM_Validate
.head 6 +  If bDestroyForm Or
   bPAMSelect
.head 7 -  Return VALIDATE_Ok
.head 6 +  If wParam = 0
.head 7 -  Set wParam = SalWindowHandleToNumber( XSalToolboxGetButtonHandle( ) )
.head 7 +  If wParam = 0
.head 8 -  Call SalSendMsg( hWndItem, SAM_FieldEdit, 0, 0 )
.head 8 -  Return VALIDATE_Ok
.head 6 -  Call SalArrayGetUpperBound( hWndValidate, 1, nQtde )
.head 6 -  ! Set nI = 0
.head 6 +  ! While nI < nQtde
.head 7 +  If SalWindowHandleToNumber( hWndValidate[nI] ) = wParam
.head 8 -  Return VALIDATE_Ok
.head 7 -  Set nI = nI + 1
.head 6 +  ! If SalGetDataType( hWndItem ) = DT_DateTime And ( not SalIsNull( hWndItem ) ) And ( not SalIsValidDateTime( hWndItem ) )
.head 7 -  Call SalMessageBox( 'Valor de Data inválida ! ', 'Erro', MB_Ok | MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  If SalGetDataType( hWndItem ) = DT_DateTime And ( not SalIsNull( hWndItem ) )
.head 7 +  If not SalIsValidDateTime( hWndItem )
.head 8 -  Call SalMessageBox( 'Valor de Data inválida ! ', 'Erro', MB_Ok | MB_IconStop )
.head 8 -  Return VALIDATE_Cancel
.head 7 +  If not ValidaAno( )
.head 8 -  Call SalMessageBox( 'Ano inválido ! ', 'Erro', MB_Ok | MB_IconStop )
.head 8 -  Return VALIDATE_Cancel
.head 6 +  If SalGetDataType( hWndItem ) = DT_Number And ( not SalIsNull( hWndItem ) ) And ( not SalIsValidNumber( hWndItem ) )
.head 7 -  Call SalMessageBox( 'Valor Numérico inválido ! ', 'Erro', MB_Ok | MB_IconStop )
.head 7 -  Return VALIDATE_Cancel
.head 6 +  ! If bBloqueiaSalto And SalGetDataType( hWndItem ) = DT_Number And ( nProximoRegistro > 0 )
.head 7 -  Call SalGetWindowText( hWndItem, sValor, 50 )
.head 7 +  If SalStrToNumber( sValor ) > nProximoRegistro
.head 8 -  Call SalMessageBox( 'Valor Numérico superior ao próximo codigo válido ! ', 'Erro', MB_Ok | MB_IconStop )
.head 8 -  Return VALIDATE_Cancel
.head 6 -  Set bRetorno = SalSendMsg( hWndItem, PAM_Validate, wParam, lParam )
.head 6 +  If bRetorno
.head 7 -  Call SalSendMsg( hWndItem, SAM_FieldEdit, 0, 0 )
.head 6 -  Return bRetorno
.head 5 +  On PAM_Validate
.head 6 -  Return VALIDATE_Ok
.head 5 -  !
.head 5 +  ! On SAM_SetFocus
.head 6 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 6 +  If not bDestroyForm
.head 7 +  If SalIsWindowEnabled( hWndItem )
.head 8 -  Set nI = SalGetType( hWndItem )
.head 8 +  If nI = TYPE_DataField or nI = TYPE_MultilineText or nI = TYPE_TableColumn
.head 9 -  Set nOldColor = SalColorGet( hWndItem, COLOR_IndexWindow )
.head 9 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, nSonCorObjetoSelecionado )
.head 5 +  ! On SAM_KillFocus
.head 6 -  Set hWndDataFieldAnterior = hWndItem
.head 6 +  If not bDestroyForm
.head 7 +  If SalIsWindowEnabled( hWndItem )
.head 8 -  Set nI = SalGetType( hWndItem )
.head 8 +  If nI = TYPE_DataField or nI = TYPE_MultilineText or nI = TYPE_TableColumn
.head 9 +  If nOldColor = 0
.head 10 -  Set nOldColor = COLOR_White
.head 9 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, nOldColor )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 6 +  If not bDestroyForm
.head 7 +  If SalIsWindowEnabled( hWndItem )
.head 8 -  Set nI = SalGetType( hWndItem )
.head 8 +  If nI = TYPE_DataField or nI = TYPE_MultilineText or nI = TYPE_TableColumn or nI = TYPE_CustControl
.head 9 -  ! Tirando cor
.head 9 +  If hWndFoco != hWndNULL
.head 10 +  If SalIsWindowEnabled( hWndFoco )
.head 11 +  If nOldColor = 0
.head 12 -  Set nOldColor = COLOR_White
.head 11 -  Call SalColorSet( hWndFoco, COLOR_IndexWindow, nOldColor )
.head 9 -  ! Colocando Cor
.head 9 -  Set nOldColor = SalColorGet( hWndItem, COLOR_IndexWindow )
.head 9 +  If nSonCorObjetoSelecionado = 0
.head 10 -  Set nSonCorObjetoSelecionado = SalColorFromRGB( 255, 255, 220 )
.head 9 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, nSonCorObjetoSelecionado )
.head 9 -  Set hWndFoco = hWndItem
.head 5 +  On PAM_Trim
.head 6 +  If SalGetDataType ( hWndItem ) = DT_String And SalGetType( hWndItem ) != TYPE_ComboBox And SalGetType( hWndItem ) != TYPE_ListBox
.head 7 -  Call SalGetWindowText(hWndItem, sValor, 99999 )
.head 7 -  Call SalSetWindowText(  hWndItem,  SalStrTrimX( sValor )  )
.head 5 -  !
.head 5 +  On WM_ENABLE
.head 6 -  Set nI = SalGetType( hWndItem )
.head 6 +  If nI = TYPE_DataField or nI = TYPE_MultilineText or nI = TYPE_TableColumn or
   nI = TYPE_ComboBox or nI = TYPE_ListBox
.head 7 +  If wParam
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_White )
.head 8 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 7 +  Else
.head 8 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_LightGray )
.head 8 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, SalColorFromRGB( 230, 230, 230 ) )
.head 8 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 5 -  ! Movido para DataFields e Combo Apenas
.head 5 +  ! On VTM_KeyDown
.head 6 +  If ( wParam = VK_F3 ) And ( VisGetKeyState( VK_Control )  & KS_Down )
.head 7 -  Set bPAMSelect = TRUE
.head 7 -  Call SalSendMsg( hWndItem, PAM_Select, 0, 0 )
.head 7 -  Set bPAMSelect = FALSE
.head 5 -  !
.head 5 +  On PAM_Command
.head 6 +  If wParam = PCCLASS_FIELD_GetValue
.head 7 +  If lParam = PCCLASS_FIELD_COMPONENTEEDITADO
.head 8 -  Return GetComponenteEditado ()
.head 5 +  ! On SAM_TooltipSetText
.head 6 -  Call SalWindowGetProperty( hWndItem, 'SonHint', sValor )
.head 6 +  If SalStrTrimX( sValor ) != STRING_Null
.head 7 -  Return XSalTooltipSetText( lParam, sValor )
.head 3 +  Combo Box Class: pcComboCompletaEdicaoKey
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcComboBoxBase
.head 5 -  Class: pcClasseKey
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_KillFocus
.head 6 +  If NOT iv_bAllowNewValues		! only allowed to select from list
.head 7 +  If SalListSelectString( hWndItem, -1, MyValue ) = LB_Err
.head 8 -  Set MyValue = STRING_Null
.head 6 -  Set hWndDataFieldAnterior = hWndItem
.head 5 +  On WM_KEYDOWN
.head 6 +  Select Case wParam
.head 7 +  Case VK_Backspace
.head 8 -  Call __cfnBackspace( )
.head 8 -  Return 0
.head 7 +  Case VK_Delete
.head 8 -  Call __cfnDeleteSelected( )
.head 8 -  Return 0
.head 5 +  On SAM_AnyEdit
.head 6 -  Call __cfnSelectAhead ()
.head 6 -  Call SetComponenteEditado(TRUE)
.head 3 +  Combo Box Class: pcComboBoxBase
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? No
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Boolean: iv_bAllowNewValues
.head 5 -  Boolean: iv_bInBackspace
.head 4 +  Functions
.head 5 +  Function: gfnLowHighToLong
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nLowWord
.head 7 -  Number: nHighWord
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ( 0x10000 * nHighWord + nLowWord )
.head 5 -  !
.head 5 -  ! public
.head 5 +  Function: cfnAllowNewValues
.head 6 -  Description: TRUE to allow new values, FALSE otherwise.
Indicate whether user is allowed to enter new values or must select from the list
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bAllowNewValues
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set iv_bAllowNewValues = p_bAllowNewValues
.head 5 -  !
.head 5 -  ! private
.head 5 +  Function: __cfnSelectAhead
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sCurValue
.head 7 -  Number: nSelection
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 +  If iv_bInBackspace
.head 8 -  Set iv_bInBackspace = FALSE
.head 8 -  Return FALSE
.head 7 -  Set nSelection = SalSendMsg( hWndItem, CB_GETEDITSEL, 0, 0 )
.head 7 -  Set sCurValue = MyValue
.head 7 -  Set nIndex = SalListSelectString( hWndItem, -1, sCurValue )
.head 7 +  If nIndex != LB_Err
.head 8 -  Call SalListSetSelect( hWndItem, nIndex )
.head 8 -  Call SalSendMsg( hWndItem, CB_SETEDITSEL, 0, gfnLowHighToLong( SalNumberLow( nSelection), -1 ))
.head 7 +  Else
.head 8 -  Set MyValue = sCurValue
.head 8 -  Call SalSendMsg( hWndItem, CB_SETEDITSEL, 0, nSelection )
.head 7 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 5 +  Function: __cfnBackspace
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nSelection
.head 6 +  Actions
.head 7 +  If SalStrLength( MyValue ) > 0
.head 8 -  Set nSelection = SalSendMsg( hWndItem, CB_GETEDITSEL, 0, 0 )
.head 8 +  If SalNumberHigh( nSelection ) = SalStrLength( MyValue )
.head 9 +  If SalNumberLow( nSelection ) = 0 OR SalNumberLow( nSelection ) = 1
.head 10 -  Set MyValue = STRING_Null
.head 10 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 9 +  Else If SalNumberLow( nSelection ) != SalNumberHigh( nSelection )
.head 10 -  Call SalSendMsg( hWndItem, CB_SETEDITSEL, 0,
gfnLowHighToLong( SalNumberLow(nSelection)-1, -1 ))
.head 8 +  Else
.head 9 +  If SalNumberLow( nSelection ) != SalNumberHigh( nSelection )
.head 10 -  Set MyValue = SalStrLeftX( MyValue, SalNumberLow( nSelection ) + 1 ) ||
SalStrRightX( MyValue, SalStrLength( MyValue ) - SalNumberHigh( nSelection ) )
.head 10 -  Call SalSendMsg( hWndItem, CB_SETEDITSEL, 0, gfnLowHighToLong( SalNumberLow( nSelection) + 1, SalNumberLow( nSelection) + 1 ))
.head 9 -  Set iv_bInBackspace = TRUE
.head 8 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 5 +  Function: __cfnDeleteSelected
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nSelection
.head 6 +  Actions
.head 7 -  Set nSelection = SalSendMsg( hWndItem, CB_GETEDITSEL, 0, 0 )
.head 7 -  Set MyValue = SalStrLeftX( MyValue, SalNumberLow( nSelection ) ) ||
SalStrRightX( MyValue, SalStrLength( MyValue ) - SalNumberHigh( nSelection ) )
.head 7 -  Call SalSendMsg( hWndItem, CB_SETEDITSEL, 0, gfnLowHighToLong( SalNumberLow( nSelection), SalNumberLow( nSelection) ))
.head 7 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call __cfnSelectAhead( )
.head 5 +  On VTM_KeyDown
.head 6 +  If ( wParam = VK_F3 ) And ( VisGetKeyState( VK_Control )  & KS_Down )
.head 7 -  Set bPAMSelect = TRUE
.head 7 -  Call SalSendMsg( hWndItem, PAM_Select, 0, 0 )
.head 7 -  Set bPAMSelect = FALSE
.head 3 +  Pushbutton Class: pcPushbutton
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Gray
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 -  On WM_ENABLE
.head 3 +  Pushbutton Class: pcPushbuttonKey
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Gray
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasseKey
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 -  On WM_ENABLE
.head 3 +  Pushbutton Class: pcPushbuttonSel
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Gray
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call XSalToolboxSetButtonStyle( hWndItem, XSalToolbar_ButtonLeftImage | XSalToolbar_ButtonThinBorder )
.head 6 -  Call SalPicSetFile( hWndItem, sgCaminhoImagens || 'Seleciona.bmp' )
.head 3 +  Pushbutton Class: pcPushbuttonSelKey
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Gray
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasseKey
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call XSalToolboxSetButtonStyle( hWndItem, XSalToolbar_ButtonLeftImage | XSalToolbar_ButtonThinBorder )
.head 6 -  Call SalPicSetFile( hWndItem, sgCaminhoImagens || 'Seleciona.bmp' )
.head 3 +  Functional Class: fcArquivo
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  File Handle: hArquivo
.head 5 -  String: sNOME
.head 5 -  String: sDIRETORIO
.head 4 +  Functions
.head 5 +  ! Function: Initialize
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nARQUIVO_p
.head 7 -  Number: nSEQUENCIA_p
.head 7 -  Number: nTIPOLOTE_p
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 +  If Not bInitialized Or nARQUIVO != nARQUIVO_p Or nSEQUENCIA != nSEQUENCIA_p Or nTIPOLOTE != nTIPOLOTE_p
.head 8 -  Call Reset( )
.head 8 -  Set nARQUIVO = nARQUIVO_p
.head 8 -  Set nSEQUENCIA = nSEQUENCIA_p
.head 8 -  Set nTIPOLOTE = nTIPOLOTE_p
.head 8 +  If fcDatabase.nTipoServidorAtual = SON_TipoServidor_MySql
.head 9 -  Call SqlSetLongBindDatatype (9, 23 )
.head 9 -  Call SqlSetLongBindDatatype (13, 23 )
.head 8 +  Else 
.head 9 -  Call SqlSetLongBindDatatype (9, 22 )
.head 9 -  Call SqlSetLongBindDatatype (13, 23 )
.head 8 -  Call SqlPrepareAndExecute( hSqlParam,
'Select ARQUIVO,  SEQUENCIA,  TIPOLOTE,  OPERACAO,
TIPOARQUIVO,  NOME,  DIRETORIO,  REGISTROS,
DESCRICAO,  DTCRIACAO,  IMPORTACAO,  TAMANHO,
CONTEUDO,  DATALOTE,  LOTE
Into  :nARQUIVO,  :nSEQUENCIA,  :nTIPOLOTE,  :nOPERACAO,
:nTIPOARQUIVO,  :sNOME,  :sDIRETORIO,  :nREGISTROS,
:lsDESCRICAO,  :dtDTCRIACAO,  :nIMPORTACAO,  :nTAMANHO,
:lsCONTEUDO,  :dtDATALOTE,  :nLOTE
From FDEGIEARQUIVO
Where ARQUIVO = :nARQUIVO_p And SEQUENCIA = :nSEQUENCIA_p And TIPOLOTE = :nTIPOLOTE_p' )
.head 8 +  If SqlFetchNext( hSqlParam, nFetch )
.head 9 -  Set sNOME = SalStrTrimX( sNOME )
.head 9 -  Set sDIRETORIO = SalStrTrimX( sDIRETORIO )
.head 9 -  Set bInitialized = TRUE
.head 9 -  Return TRUE
.head 8 +  Else 
.head 9 -  Set bInitialized = FALSE
.head 9 -  Return FALSE
.head 7 +  Else 
.head 8 -  Return TRUE
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNOME = STRING_Null
.head 7 -  Set sDIRETORIO = STRING_Null
.head 7 -  Set hArquivo = hWndNULL
.head 7 -  Return TRUE
.head 5 +  ! Function: Insert
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bUpdate
.head 6 +  Actions 
.head 7 +  If VerificaCampos() And VerificaCamposCustom( )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, fcDatabase.SonSqlReadOnlyOff( ) )
.head 8 +  When SqlError
.head 9 +  If KeyViolation( hSqlParam )
.head 10 -  Set bUpdate = TRUE
.head 10 -  Return FALSE
.head 8 -  Call SqlPrepare( hSqlParam, 'Insert into FDEGIEARQUIVO
( ARQUIVO,  SEQUENCIA,  TIPOLOTE,  OPERACAO,
TIPOARQUIVO,  NOME,  DIRETORIO,  REGISTROS,
DESCRICAO,  DTCRIACAO,  IMPORTACAO,  TAMANHO,
CONTEUDO,  DATALOTE,  LOTE )
 Values
( :nARQUIVO,  :nSEQUENCIA,  :nTIPOLOTE,  :nOPERACAO,
:nTIPOARQUIVO,  :sNOME,  :sDIRETORIO,  :nREGISTROS,
:lsDESCRICAO,  :dtDTCRIACAO,  :nIMPORTACAO,  :nTAMANHO,
:lsCONTEUDO,  :dtDATALOTE,  :nLOTE ) ' )
.head 8 +  If fcDatabase.nTipoServidorAtual = SON_TipoServidor_MySql
.head 9 -  Call SqlSetLongBindDatatype (9, 23 )
.head 9 -  Call SqlSetLongBindDatatype (13, 23 )
.head 8 +  Else 
.head 9 -  Call SqlSetLongBindDatatype (9, 22 )
.head 9 -  Call SqlSetLongBindDatatype (13, 23 )
.head 8 -  Call SqlExecute( hSqlParam )
.head 8 +  If bUpdate
.head 9 -  Call Update( hSqlParam )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, fcDatabase.SonSqlReadOnlyOn( ) )
.head 8 -  Return TRUE
.head 7 +  Else 
.head 8 -  Return FALSE
.head 5 +  ! Function: Delete
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 +  If VerificaDependencias() And VerificaDependenciasCustom( hSqlParam )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, fcDatabase.SonSqlReadOnlyOff( ) )
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Delete From FDEGIEARQUIVO
Where ARQUIVO = :nARQUIVO And SEQUENCIA = :nSEQUENCIA And TIPOLOTE = :nTIPOLOTE' )
.head 8 -  Call DeleteDependencies( hSqlParam )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, fcDatabase.SonSqlReadOnlyOn( ) )
.head 8 -  Call Reset( )
.head 8 -  Return TRUE
.head 7 +  Else 
.head 8 -  Return FALSE
.head 5 +  ! Function: Update
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 +  If VerificaCampos() And VerificaCamposCustom( )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, fcDatabase.SonSqlReadOnlyOff( ) )
.head 8 -  Call SqlPrepare( hSqlParam, 'Update FDEGIEARQUIVO
Set OPERACAO = :nOPERACAO,
TIPOARQUIVO = :nTIPOARQUIVO,
NOME = :sNOME,
DIRETORIO = :sDIRETORIO,
REGISTROS = :nREGISTROS,
DESCRICAO = :lsDESCRICAO,
DTCRIACAO = :dtDTCRIACAO,
IMPORTACAO = :nIMPORTACAO,
TAMANHO = :nTAMANHO,
CONTEUDO = :lsCONTEUDO,
DATALOTE = :dtDATALOTE,
LOTE = :nLOTE
Where ARQUIVO = :nARQUIVO And SEQUENCIA = :nSEQUENCIA And TIPOLOTE = :nTIPOLOTE ' )
.head 8 +  If fcDatabase.nTipoServidorAtual = SON_TipoServidor_MySql
.head 9 -  Call SqlSetLongBindDatatype (6, 23 )
.head 9 -  Call SqlSetLongBindDatatype (10, 23 )
.head 8 +  Else 
.head 9 -  Call SqlSetLongBindDatatype (6, 22 )
.head 9 -  Call SqlSetLongBindDatatype (10, 23 )
.head 8 -  Call SqlExecute( hSqlParam )
.head 8 -  Call SqlSetIsolationLevel( hSqlParam, fcDatabase.SonSqlReadOnlyOn () )
.head 8 -  Return TRUE
.head 7 +  Else 
.head 8 -  Return FALSE
.head 5 +  ! Function: BloqueiaRegistro
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Number: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Select *
From FDEGIEARQUIVO
Where ARQUIVO = :nARQUIVO And SEQUENCIA = :nSEQUENCIA And TIPOLOTE = :nTIPOLOTE' )
.head 7 +  If SqlFetchNext( hSqlParam, nFetch )
.head 8 -  Call SonBloqueiaRegistro ( hSqlParam, hWndForm, sSistemaGlobal, nCodUsuarioChaveGlobal, dtDataHoraLogin, 'FDEGIEARQUIVO' ||SalNumberToStrX(nARQUIVO, 0 )  || SalNumberToStrX(nSEQUENCIA, 0 )  || SalNumberToStrX(nTIPOLOTE, 0 ) , BS_TYPE_STRING, SalNumberToStrX( nTIPOLOTE, 0) , BS_EDIT, TRUE, TRUE, fcDatabase )
.head 7 +  Else 
.head 8 -  Set nTIPOLOTE = SonBloqueiaRegistro ( hSqlParam, hWndForm, sSistemaGlobal, nCodUsuarioChaveGlobal, dtDataHoraLogin, 'FDEGIEARQUIVO' ||SalNumberToStrX(nARQUIVO, 0 )  || SalNumberToStrX(nSEQUENCIA, 0 )  || SalNumberToStrX(nTIPOLOTE, 0 ) , BS_TYPE_NUMBER, SalNumberToStrX( nTIPOLOTE, 0) , BS_INSERT, TRUE, TRUE, fcDatabase )
.head 8 +  If nTIPOLOTE = -1
.head 9 -  Call Reset()
.head 7 -  Return nTIPOLOTE
.head 5 +  ! Function: VerificaCampos
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Call oErro.Initialize()
.head 7 +  If SalStrLength( sNOME  ) > 100
.head 8 -  Call oErro.AddMessage( ERRO_INTEGRIDADE, 'O tamanho de NOME excede o tamanho permitido.' )
.head 8 -  Return FALSE
.head 7 +  If SalStrLength( sDIRETORIO  ) > 200
.head 8 -  Call oErro.AddMessage( ERRO_INTEGRIDADE, 'O tamanho de DIRETORIO excede o tamanho permitido.' )
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  ! Function: GetClassName
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return 'cFDEGIEARQUIVO'
.head 5 +  ! Function: FazOperacaoDB
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nOperacao
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return ExecutaComandoDB( hSqlParam, nOperacao )
.head 5 +  ! Function: VerificaDependencias
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return TRUE
.head 5 +  ! Function: RegistraOperacao
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nFuncao
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Number: nSeqNo
.head 7 -  Date/Time: dtAtual
.head 7 -  String: sFuncao
.head 6 +  Actions 
.head 7 -  Set dtAtual = SalDateCurrent( )
.head 7 -  Set sFuncao = SalNumberToStrX( nFuncao, 0 )
.head 7 +  While TRUE
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, 'Select max( SEQNO )
from SSTLOG
into :nSeqNo
where SISTEMA = :sSistemaGlobal ' )
.head 8 +  If SqlFetchNext( hSqlParam, nFetch )
.head 9 -  Set nSeqNo = nSeqNo + 1
.head 8 +  When SqlError
.head 9 -  Return FALSE
.head 8 +  If SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLog
( SISTEMA, CODUSUARIO, SEQNO, DATAHORA, OBJETO, OPERACAO )
values ( :sSistemaGlobal, :nCodUsuarioChaveGlobal, :nSeqNo,
' || fcDatabase.SonSqlVarDateTime( 'dtAtual', dtAtual ) || ', \'FDEGIEARQUIVO\', :sFuncao ) ' )
.head 9 -  Break 
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'ARQUIVO\', 0, ' || SalNumberToStrX( nARQUIVO, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'SEQUENCIA\', 1, ' || SalNumberToStrX( nSEQUENCIA, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'TIPOLOTE\', 2, ' || SalNumberToStrX( nTIPOLOTE, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'OPERACAO\', 3, ' || SalNumberToStrX( nOPERACAO, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'TIPOARQUIVO\', 4, ' || SalNumberToStrX( nTIPOARQUIVO, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'NOME\', 5, ' || sNOME || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'DIRETORIO\', 6, ' || sDIRETORIO || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'REGISTROS\', 7, ' || SalNumberToStrX( nREGISTROS, 7 )  || '  )'  )
.head 7 -  Call SqlPrepare( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'DESCRICAO\', 8, ' || lsDESCRICAO || '  )'  )
.head 7 +  If fcDatabase.nTipoServidorAtual = SON_TipoServidor_MySql
.head 8 -  Call SqlSetLongBindDatatype( 3, 23 )
.head 7 -  Call SqlExecute( hSqlParam )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'DTCRIACAO\', 9, ' || SalFmtFormatDateTime( dtDTCRIACAO, 'yyyyMMddhhhhmmss' )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'IMPORTACAO\', 10, ' || SalNumberToStrX( nIMPORTACAO, 7 )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'TAMANHO\', 11, ' || SalNumberToStrX( nTAMANHO, 7 )  || '  )'  )
.head 7 -  Call SqlPrepare( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'CONTEUDO\', 12, ' || lsCONTEUDO || '  )'  )
.head 7 +  If fcDatabase.nTipoServidorAtual = SON_TipoServidor_MySql
.head 8 -  Call SqlSetLongBindDatatype( 3, 23 )
.head 7 -  Call SqlExecute( hSqlParam )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'DATALOTE\', 13, ' || SalFmtFormatDateTime( dtDATALOTE, 'yyyyMMddhhhhmmss' )  || '  )'  )
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, 'Insert into SSTLogDetalhe ( SISTEMA, SEQNO, OBJETO, INDICE, VALOR )
 values (:sSistemaGlobal, :nSeqNo, \'LOTE\', 14, ' || SalNumberToStrX( nLOTE, 7 )  || '  )'  )
.head 7 -  Return TRUE
.head 5 +  ! Function: Clone
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  FunctionalVar: oOrigem_p
.winattr class
.head 8 -  Class: cFDEGIEARQUIVO
.end
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nARQUIVO = oOrigem_p.nARQUIVO
.head 7 -  Set nSEQUENCIA = oOrigem_p.nSEQUENCIA
.head 7 -  Set nTIPOLOTE = oOrigem_p.nTIPOLOTE
.head 7 -  Set nOPERACAO = oOrigem_p.nOPERACAO
.head 7 -  Set nTIPOARQUIVO = oOrigem_p.nTIPOARQUIVO
.head 7 -  Set sNOME = oOrigem_p.sNOME
.head 7 -  Set sDIRETORIO = oOrigem_p.sDIRETORIO
.head 7 -  Set nREGISTROS = oOrigem_p.nREGISTROS
.head 7 -  Set lsDESCRICAO = oOrigem_p.lsDESCRICAO
.head 7 -  Set dtDTCRIACAO = oOrigem_p.dtDTCRIACAO
.head 7 -  Set nIMPORTACAO = oOrigem_p.nIMPORTACAO
.head 7 -  Set nTAMANHO = oOrigem_p.nTAMANHO
.head 7 -  Set lsCONTEUDO = oOrigem_p.lsCONTEUDO
.head 7 -  Set dtDATALOTE = oOrigem_p.dtDATALOTE
.head 7 -  Set nLOTE = oOrigem_p.nLOTE
.head 7 -  Set bInitialized = FALSE
.head 5 +  ! Function: GetChaveSincronizacao
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return SalNumberToStrX( nARQUIVO, 0 ) || '¦' ||
SalNumberToStrX( nSEQUENCIA, 0 ) || '¦' ||
SalNumberToStrX( nTIPOLOTE, 0 ) || '¦'
.head 5 +  ! Function: UpdateSerializado
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSql_p
.head 7 -  FunctionalVar: oDestino_p
.winattr class
.head 8 -  Class: fcSonDestinoObjeto
.end
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Long String: sObjeto
.head 7 -  Long String: sEstrutura
.head 6 +  Actions 
.head 7 -  Call oDestino_p.SetaEstrutura( GetClassName (), 'bInitialized,nRetorno,sRetorno,nARQUIVO,nSEQUENCIA,nTIPOLOTE,nOPERACAO,nTIPOARQUIVO,sNOME,sDIRETORIO,nREGISTROS,lsDESCRICAO,dtDTCRIACAO,nIMPORTACAO,nTAMANHO,lsCONTEUDO,dtDATALOTE,nLOTE',  'nnsnnnnnssnstnnstn' )
.head 7 -  Call XSalUdvToString( oDestino_p.oEstrutura, sEstrutura, 'sss' )
.head 7 -  Call XSalUdvThisToString(  sObjeto,  oDestino_p.oEstrutura.sTiposDadosCampos )
.head 7 -  Return oDestino_p.Salva( hSql_p,  sObjeto, sEstrutura )
.head 5 +  ! Function: InsertSerializado
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSql_p
.head 7 -  FunctionalVar: oDestino_p
.winattr class
.head 8 -  Class: fcSonDestinoObjeto
.end
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Long String: sObjeto
.head 7 -  Long String: sEstrutura
.head 6 +  Actions 
.head 7 -  Call oDestino_p.SetaEstrutura( GetClassName (), 'bInitialized,nRetorno,sRetorno,nARQUIVO,nSEQUENCIA,nTIPOLOTE,nOPERACAO,nTIPOARQUIVO,sNOME,sDIRETORIO,nREGISTROS,lsDESCRICAO,dtDTCRIACAO,nIMPORTACAO,nTAMANHO,lsCONTEUDO,dtDATALOTE,nLOTE',  'nnsnnnnnssnstnnstn' )
.head 7 -  Call XSalUdvToString( oDestino_p.oEstrutura, sEstrutura, 'sss' )
.head 7 -  Call XSalUdvThisToString(  sObjeto,  oDestino_p.oEstrutura.sTiposDadosCampos )
.head 7 -  Return oDestino_p.Insere( hSql_p,  sObjeto, sEstrutura )
.head 5 +  ! Function: InitializeSerializado
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSql_p
.head 7 -  FunctionalVar: oDestino_p
.winattr class
.head 8 -  Class: fcSonDestinoObjeto
.end
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Long String: sObjeto
.head 7 -  Long String: sEstrutura
.head 7 -  Number: nChar
.head 7 -  Number: nIndice
.head 7 -  Number: nOffSet
.head 7 -  String: saAtributos[*]
.head 7 -  Number: nErro
.head 7 -  Number: nPosErro
.head 7 -  Number: nRetorno
.head 7 -  String: sRetorno
.head 7 -  Date/Time: dtRetorno
.head 7 -  String: sContexto
.head 7 -  Window Handle: hRetorno
.head 7 -  Number: nTamanho
.head 7 -  String: sValor
.head 7 -  String: sBuffer
.head 7 -  FunctionalVar: oValor
.winattr class
.head 8 -  Class: fcSonEstruturaCampoValor
.end
.head 6 +  Actions 
.head 7 -  Set sContexto = SalContextCurrent ()
.head 7 +  If oDestino_p.Recupera( hSql_p, sObjeto, sEstrutura )
.head 8 -  Call XSalUdvFromString( oDestino_p.oEstrutura, sEstrutura, 'sss' )
.head 8 +  If oDestino_p.oEstrutura.sNomeClasse = GetClassName ()
.head 9 +  If oDestino_p.oEstrutura.sTiposDadosCampos != 'nnsnnnnnssnstnnstn'
.head 10 -  Set nIndice = 0
.head 10 -  Set nOffSet = 0
.head 10 -  Call SalStrTokenize( oDestino_p.oEstrutura.sNomesCampos, '', ',', saAtributos )
.head 10 +  While SalStrFirstC( oDestino_p.oEstrutura.sTiposDadosCampos, nChar )
.head 11 +  Select Case nChar
.head 12 +  Case 110 ! n (number)
.head 13 -  Call SalStrSetBufferLength( sBuffer, 25 )
.head 13 -  Call CStructCopyBuffer( sBuffer, 0, sObjeto, nOffSet, 25 )
.head 13 -  Call XSalUdvFromString( oValor, sBuffer, 'n-t-s-s-n-s' )
.head 13 -  Set nOffSet = nOffSet + 25
.head 13 -  Call SalCompileAndEvaluate( 'Set ' || saAtributos[nIndice] || ' =  oValor.nNumber', nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, TRUE, sContexto )
.head 13 -  Break 
.head 12 +  Case 116 ! t ( date/time )
.head 13 -  Call SalStrSetBufferLength( sBuffer, 25 )
.head 13 -  Call CStructCopyBuffer( sBuffer, 0, sObjeto, nOffSet, 25 )
.head 13 -  Call XSalUdvFromString( oValor, sBuffer, '-nt-s-s-n-s' )
.head 13 -  Set nOffSet = nOffSet + 25
.head 13 -  Call SalCompileAndEvaluate( 'Set ' || saAtributos[nIndice] || ' = oValor.dtDateTime', nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, TRUE, sContexto )
.head 13 -  Break 
.head 12 +  Case 115 ! s ( string )
.head 13 -  Set nTamanho = CStructGetLong( sObjeto, nOffSet )
.head 13 -  Set nOffSet = nOffSet + 4
.head 13 +  If nTamanho > 0
.head 14 -  Call SalStrSetBufferLength( sValor, nTamanho )
.head 14 -  Call CStructGetString( sObjeto, nOffSet, nTamanho, sValor )
.head 14 -  Call SalCompileAndEvaluate( 'Set ' || saAtributos[nIndice] || ' = sValor', nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, TRUE, sContexto )
.head 14 -  Set nOffSet = nOffSet + nTamanho
.head 13 -  Break 
.head 11 -  Set nIndice = nIndice + 1
.head 9 +  Else 
.head 10 -  Call XSalUdvThisFromString( sObjeto, oDestino_p.oEstrutura.sTiposDadosCampos )
.head 9 -  Return TRUE
.head 8 +  Else 
.head 9 -  Return FALSE
.head 7 +  Else 
.head 8 -  Return FALSE
.head 5 -  ! @CustomMethodsBegin
.head 5 +  ! Function: CarregaConteudoDoDisco
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  File Handle: hArquivo
.head 7 -  String: sCaminhoCompletoArquivo
.head 6 +  Actions 
.head 7 -  Set sCaminhoCompletoArquivo = getNomeFull ()
.head 7 +  If SalFileOpen( hArquivo, sCaminhoCompletoArquivo, OF_Binary )
.head 8 -  Call VisFileSeek ( hArquivo, 0, FILE_SeekBegin )
.head 8 -  Set lsCONTEUDO = ''
.head 8 -  Set nTAMANHO = SalFileRead( hArquivo, lsCONTEUDO, VisFileGetSize( sCaminhoCompletoArquivo ) )
.head 8 -  Call SalStrSetBufferLength( lsCONTEUDO, nTAMANHO )
.head 8 -  Call SalFileClose( hArquivo )
.head 8 -  Return TRUE
.head 7 +  Else 
.head 8 -  Return FALSE
.head 5 +  ! Function: Inclui
.head 6 -  Description: Obtem os próximos número tanto de arquivo quanto de sequencia.
Caso o lote já tenha sido exportado alguma vez o ARQUIVO será o mesmo e o SEQUENCIAL será incrementado
Caso o lote ainda não exista o ARQUIVO será o próximo do mesmo tipo de arquivo e o SEQUENCIAL será 1.
Carrega o arquivo para CONTEUDO atribui o seu TAMANHO.

Os valores de nTipoLote_p e sArquivo_p já podem ter sido atribuidos anteriormente. Se nao quiser atribuir
novamente basta passar valores nulos para eles.
Chama Insert
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSql_p
.head 7 +  Number: nTipoLote_p
.head 8 -  ! Passe NUMBER_Null caso ele já tenha sido atribuido
.head 7 +  String: sArquivo_p
.head 8 -  ! Passe STRING_Null caso ele já tenha sido atribuido
.head 7 -  Date/Time: dtDataLote_p
.head 7 -  Number: nLote_p
.head 7 -  Number: nOperacao_p
.head 7 +  Number: nTipoArquivo_p
.head 8 -  ! Passe NUMBER_Null caso ele já tenha sido atribuido
.head 7 -  Long String: lsDescricao_p
.head 7 -  Boolean: bImportacao_p
.head 7 -  Number: nQtdeRegistros_p
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Number: nFetchLocal
.head 6 +  Actions 
.head 7 +  If nTipoLote_p != NUMBER_Null
.head 8 -  Set nTIPOLOTE = nTipoLote_p
.head 7 +  If sArquivo_p != STRING_Null
.head 8 -  Call fcQuebraFullPath( sArquivo_p )
.head 7 -  Set dtDATALOTE = dtDataLote_p
.head 7 -  Set nLOTE = nLote_p
.head 7 -  Set nTIPOARQUIVO = nTipoArquivo_p
.head 7 +  If bImportacao_p
.head 8 -  Set nIMPORTACAO = 1
.head 7 +  Else 
.head 8 -  Set nIMPORTACAO = 0
.head 7 -  Set nOPERACAO = nOperacao_p
.head 7 -  Set lsDESCRICAO = lsDescricao_p
.head 7 -  Set dtDTCRIACAO = SalDateCurrent ()
.head 7 -  Set nREGISTROS = nQtdeRegistros_p
.head 7 -  !
.head 7 -  Call SqlPrepareAndExecute( hSql_p, 'select ARQUIVO into :nARQUIVO from FDEGIEARQUIVO where DATALOTE = :dtDATALOTE and LOTE = :nLOTE and TIPOLOTE = :nTIPOLOTE' )
.head 7 +  If SqlFetchNext( hSql_p, nFetchLocal )
.head 8 -  Call SqlPrepareAndExecute( hSql_p,
'select max(SEQUENCIA) into :nSEQUENCIA
from FDEGIEARQUIVO
where DATALOTE = :dtDATALOTE and LOTE = :nLOTE and
         TIPOLOTE = :nTIPOLOTE and ARQUIVO = :nARQUIVO ' )
.head 8 -  Call SqlFetchNext( hSql_p, nFetchLocal )
.head 8 -  Set nSEQUENCIA = nSEQUENCIA + 1
.head 7 +  Else 
.head 8 -  Call SqlPrepareAndExecute( hSql_p, 'select max(ARQUIVO) into :nARQUIVO from FDEGIEARQUIVO where TIPOARQUIVO = :nTIPOARQUIVO' )
.head 8 -  Call SqlFetchNext( hSql_p, nFetchLocal )
.head 8 -  Set nARQUIVO = nARQUIVO + 1
.head 8 -  Set nSEQUENCIA = 1
.head 7 -  !
.head 7 +  If CarregaConteudoDoDisco ()
.head 8 -  Return Insert( hSql_p )
.head 7 +  Else 
.head 8 -  Return FALSE
.head 5 +  ! Function: SalvaConteudoParaDisco
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  File Handle: hArquivo
.head 7 -  String: sCaminhoENomeArquivoDestino
.head 7 -  String: sDrive
.head 7 -  String: sPasta
.head 7 -  String: sNome
.head 7 -  String: sExtensao
.head 7 -  String: sDirecao
.head 6 +  Actions 
.head 7 -  Set sCaminhoENomeArquivoDestino = sDIRETORIO || '\\' || sNOME
.head 7 +  If nIMPORTACAO = 1
.head 8 -  Set sDirecao = 'IMP'
.head 7 +  Else 
.head 8 -  Set sDirecao = 'EXP'
.head 7 -  Call VisDosSplitPath( sCaminhoENomeArquivoDestino, sDrive, sPasta, sNome, sExtensao )
.head 7 -  Set sCaminhoENomeArquivoDestino = sDrive || sPasta || '\\' || sNome || '_TipoLote_' || SalNumberToStrX( nTIPOLOTE, 0 ) ||
'_DataLote-' || SalFmtFormatDateTime( dtDATALOTE, 'dd-MM-yyyy' ) || '_Lote-' || SalNumberToStrX( nLOTE, 0 )  ||
'_NRO-' || SalNumberToStrX( nARQUIVO, 0 ) || '_SEQ-' || SalNumberToStrX( nSEQUENCIA, 0 ) || '_' ||sDirecao || sExtensao
.head 7 +  If VisDosExist( sCaminhoENomeArquivoDestino )
.head 8 -  Call VisFileDelete( sCaminhoENomeArquivoDestino )
.head 7 +  Else If not VisDosExist( sDrive || sPasta )
.head 8 +  If VisDosMakeAllDir( sDrive || sPasta ) < 0
.head 9 -  Return STRING_Null
.head 7 -  ! !
.head 7 -  Call SalFileOpen( hArquivo, sCaminhoENomeArquivoDestino, OF_Create | OF_Binary | OF_Write )
.head 7 -  Call SalFileWrite( hArquivo, lsCONTEUDO, nTAMANHO )
.head 7 -  Call SalFileClose( hArquivo )
.head 7 -  Return sCaminhoENomeArquivoDestino
.head 5 +  ! Function: VerificaDependenciasCustom
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return TRUE
.head 5 +  ! Function: VerificaCamposCustom
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Number: nFetchLocal
.head 6 +  Actions 
.head 7 -  Return TRUE
.head 5 +  ! Function: DeleteDependencies
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return TRUE
.head 5 +  ! Function: ProximoRegistro
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Number: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Number: nProximoRegistro
.head 6 +  Actions 
.head 7 +  If nTIPOLOTE = NUMBER_Null
.head 8 -  Set nTIPOLOTE = 0
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
Select Max(Arquivo)
  Into :nProximoRegistro
  From FdeGieArquivo
 Where TipoLote = :nTIPOLOTE ')
.head 7 -  Call SqlFetchNext( hSqlParam, nFetch )
.head 7 +  If nProximoRegistro  = NUMBER_Null or nProximoRegistro < 0
.head 8 -  Set nProximoRegistro = 0
.head 7 -  Set nProximoRegistro = nProximoRegistro + 1
.head 7 -  Return nProximoRegistro
.head 5 +  ! Function: ProximaSequencia
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Number: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: npTipoLote
.head 7 -  Number: npArquivo
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Number: nProximoRegistro
.head 6 +  Actions 
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
Select Max(sequencia)
  Into :nProximoRegistro
  From FdeGieArquivo
 Where TipoLote = :npTipoLote
       And Arquivo = :npArquivo ')
.head 7 -  Call SqlFetchNext( hSqlParam, nFetch )
.head 7 +  If nProximoRegistro = NUMBER_Null or nProximoRegistro < 0
.head 8 -  Set nProximoRegistro = 0
.head 7 -  Set nProximoRegistro = nProximoRegistro + 1
.head 7 -  Return nProximoRegistro
.head 5 +  ! Function: getGeraNome
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return SalNumberToStrX(this.nTIPOARQUIVO, 0) || ' - ' || SalNumberToStrX(this.nARQUIVO, 0) || ' - ' || SalNumberToStrX(this.nSEQUENCIA, 0) || '.txt'
.head 5 +  Function: getNomeFull
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalStrRightX( sDIRETORIO, 1 ) != SalStrLeftX( '\\', 1) or SalStrRightX( sDIRETORIO, 1 ) != '/'
.head 8 -  Set sDIRETORIO = sDIRETORIO || SalStrLeftX( '\\', 1)
.head 7 +  If ( sDIRETORIO = STRING_Null or sDIRETORIO = '' ) and ( sNOME = STRING_Null or sNOME = '' )
.head 8 -  Return STRING_Null
.head 7 -  Return this.sDIRETORIO || this.sNOME
.head 5 +  Function: fcEscolheDiretorio
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sOrientacao
.head 7 -  String: sMainTipoArquivo
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: strFilters[*]
.head 7 -  String: sArquivo
.head 7 -  String: sDiretorio
.head 7 -  Number: nTipoArquivo
.head 7 -  Number: nIndice
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 -  Set sMainTipoArquivo = SalStrTrimX( sMainTipoArquivo )
.head 7 -  Set nTipoArquivo = 0
.head 7 -  !
.head 7 +  If sMainTipoArquivo != ''
.head 8 -  Set strFilters[nTipoArquivo] = 'Arquivos' || SalStrUpperX( SalStrRightX( sMainTipoArquivo, 3 ) )
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 8 -  Set strFilters[nTipoArquivo] = sMainTipoArquivo
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 7 +  Else
.head 8 -  Set strFilters[nTipoArquivo] = 'Todos'
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 8 -  Set strFilters[nTipoArquivo] = '*.*'
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 7 +  If SalStrUpperX( sMainTipoArquivo ) != '*.TXT'
.head 8 -  Set strFilters[nTipoArquivo] = 'Arquivos TXT'
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 8 -  Set strFilters[nTipoArquivo] = '*.txt'
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 7 +  If SalStrUpperX( sMainTipoArquivo ) != '*.MDB'
.head 8 -  Set strFilters[nTipoArquivo] = 'Arquivos MDB'
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 8 -  Set strFilters[nTipoArquivo] = '*.mdb'
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 7 +  If SalStrUpperX( sMainTipoArquivo ) != '*.XLS'
.head 8 -  Set strFilters[nTipoArquivo] = 'Arquivos Excel'
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 8 -  Set strFilters[nTipoArquivo] = '*.xls'
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 7 +  If SalStrUpperX( sMainTipoArquivo ) != '*.*' and sMainTipoArquivo != ''
.head 8 -  Set strFilters[nTipoArquivo] = 'Todos'
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 8 -  Set strFilters[nTipoArquivo] = '*.*'
.head 8 -  Set nTipoArquivo = nTipoArquivo + 1
.head 7 -  Set nIndice = 1
.head 7 -  !
.head 7 -  Set sArquivo = sNOME
.head 7 +  If sOrientacao = 'O'
.head 8 +  If SalDlgOpenFile( hWndForm, 'Diretório de Gravação', strFilters, nTipoArquivo, nIndice, sArquivo, sDiretorio )
.head 9 -  Set this.sDIRETORIO = SalStrLeftX(sDiretorio, SalStrLength(sDiretorio) - SalStrLength(sArquivo))
.head 9 -  Set this.sNOME = sArquivo
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If SalDlgSaveFile( hWndForm, 'Diretório de Gravação', strFilters, nTipoArquivo, nIndice, sArquivo, sDiretorio )
.head 9 -  Set this.sDIRETORIO = SalStrLeftX(sDiretorio, SalStrLength(sDiretorio) - SalStrLength(sArquivo))
.head 9 -  Set this.sNOME = sArquivo
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 5 +  Function: fcQuebraFullPath
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sFullPath_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sPedaco
.head 7 -  Number: nTamanho
.head 7 -  Number: nIndice
.head 7 -  String: sNome
.head 7 -  String: sDir
.head 6 +  Actions
.head 7 -  Set nTamanho = SalStrLength( sFullPath_p )
.head 7 -  Set nIndice = nTamanho
.head 7 +  While nIndice > -1
.head 8 -  Set sPedaco = SalStrMidX( sFullPath_p, nIndice, 1 )
.head 8 +  If sPedaco = '\\'
.head 9 -  Break
.head 8 -  Set sNome = sPedaco || sNome
.head 8 -  Set sDir = SalStrLeftX( sFullPath_p, (nIndice - 1))
.head 8 -  Set nIndice = nIndice - 1
.head 7 -  Set sNOME = sNome
.head 7 -  Set sDIRETORIO = sDir
.head 5 +  Function: Cria
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: spDiretorio
.head 7 -  String: spNome
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  File Handle: hArquivo
.head 7 -  Number: nArquivo
.head 6 +  Actions
.head 7 -  ! !! Inicializa o objeto
.head 7 -  Call Reset(  )
.head 7 -  Set sDIRETORIO = spDiretorio
.head 7 -  Set sNOME = spNome
.head 7 -  ! !!
.head 7 +  If not VisDosExist( sDIRETORIO ) or SalStrTrimX( sDIRETORIO ) = ''
.head 8 +  If not fcEscolheDiretorio( 'D', '.txt' )
.head 9 -  Return FALSE
.head 7 -  ! !! Criando efetivamente o arquivo
.head 7 +  If not SalFileOpen( hArquivo, getNomeFull(), OF_Create | OF_ReadWrite )
.head 8 -  Return FALSE
.head 7 -  Call SalFileClose( hArquivo )
.head 7 -  Return TRUE
.head 5 +  Function: Abre
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: spCaminhoFull
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  File Handle: hArquivo
.head 6 +  Actions
.head 7 +  If not SalFileOpen( hArquivo, spCaminhoFull, OF_ReadWrite )
.head 8 -  Return FALSE
.head 7 -  Call SalFileClose( hArquivo )
.head 7 -  Return TRUE
.head 5 +  Function: PutCabecalho
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: spCabecalho
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  File Handle: hArquivo
.head 6 +  Actions
.head 7 +  If SalStrLength( sNOME ) > 0 and SalStrLength( sDIRETORIO )
.head 8 +  If not SalFileOpen( hArquivo, getNomeFull(), OF_ReadWrite )
.head 9 -  Return FALSE
.head 8 -  Call SalFileSeek( hArquivo, 0, FILE_SeekBegin )
.head 8 -  Call SalFilePutStr( hArquivo, spCabecalho )
.head 8 -  Call SalFileClose( hArquivo )
.head 7 -  Return TRUE
.head 5 +  Function: PutRodape
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: spRodape
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  File Handle: hArquivo
.head 6 +  Actions
.head 7 +  If SalStrLength( sNOME ) > 0 and SalStrLength( sDIRETORIO )
.head 8 +  If not SalFileOpen( hArquivo, getNomeFull(), OF_ReadWrite )
.head 9 -  Return FALSE
.head 8 -  Call SalFileSeek( hArquivo, 0, FILE_SeekEnd )
.head 8 -  Call SalFilePutStr( hArquivo, spRodape )
.head 8 -  Call SalFileClose( hArquivo )
.head 7 -  Return TRUE
.head 3 +  Functional Class: fcConfiguracao
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sBaseProd
.head 5 -  String: sUsuarioProd
.head 5 -  String: sSenhaProd
.head 5 -  String: sBaseTeste
.head 5 -  String: sUsuarioTeste
.head 5 -  String: sSenhaTeste
.head 5 -  String: sMnemonico
.head 5 -  String: sBuild
.head 4 +  Functions
.head 5 +  Function: LeConfiguracao
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sCaminhoAtual
.head 6 +  Actions
.head 7 -  Call SalFileGetCurrentDirectory( sCaminhoAtual )
.head 7 -  Call SalGetProfileString( 'BASETESTE', 'BANCO',             "Base Teste", sBaseTeste, sCaminhoAtual || "\\config.txt" )
.head 7 -  Call SalGetProfileString( 'BASETESTE', 'USUARIO',          "Usuário Teste", sUsuarioTeste, sCaminhoAtual || "\\config.txt" )
.head 7 -  Call SalGetProfileString( 'BASETESTE', 'SENHA',              "Senha Teste", sSenhaTeste, sCaminhoAtual || "\\config.txt" )
.head 7 -  Call SalGetProfileString( 'BASEPRODUCAO', 'BANCO',    "Base Prod.", sBaseProd, sCaminhoAtual || "\\config.txt" )
.head 7 -  Call SalGetProfileString( 'BASEPRODUCAO', 'USUARIO', "Usuário Prod.", sUsuarioProd, sCaminhoAtual || "\\config.txt" )
.head 7 -  Call SalGetProfileString( 'BASEPRODUCAO', 'SENHA',     "Senha Prod.", sSenhaProd, sCaminhoAtual || "\\config.txt" )
.head 7 -  Call SalGetProfileString( 'MNEMONICO', 'SISTEMA',     "Mnemônico.", sMnemonico, sCaminhoAtual || "\\config.txt" )
.head 7 -  Call SalGetProfileString( 'VERSAO', 'VERSAO',     "Build", sBuild, sCaminhoAtual || "\\config.txt" )
.head 3 +  Functional Class: fcDBListaObjetos
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcDBObjeto
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sWhere
.head 5 -  String: sFormato
.head 5 -  String: sConditions[*]
.head 5 -  String: sColunasLog[*]
.head 5 -  String: sConditionsLog[*]
.head 5 -  Number: nConditions
.head 5 -  Number: nValor1[*]
.head 5 -  Number: nValor2[*]
.head 5 -  Date/Time: dtValor1[*]
.head 5 -  Date/Time: dtValor2[*]
.head 5 -  String: sValor1[*]
.head 5 -  String: sValor2[*]
.head 5 -  String: sIndices[*]
.head 5 -  Number: nCount
.head 5 -  String: sConditionsPer[*]
.head 5 -  Number: nConditionsPer
.head 5 -  Number: nValor1Per[*]
.head 5 -  Number: nValor2Per[*]
.head 5 -  Date/Time: dtValor1Per[*]
.head 5 -  Date/Time: dtValor2Per[*]
.head 5 -  String: sValor1Per[*]
.head 5 -  String: sValor2Per[*]
.head 5 -  String: saOperacao[*]
.head 5 -  String: sTamanhosCampos
.head 5 -  String: sNomesCampos
.head 5 -  String: sTiposCampos
.head 5 -  String: sCamposHeader
.head 5 -  String: sOrdemCampos
.head 5 -  Number: nTopResultados
.head 4 +  Functions
.head 5 +  Function: Select
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bRet
.head 6 +  Actions
.head 7 -  Set bRet = ..Select( hSqlParam )
.head 7 -  Call FreeConditions()
.head 7 -  Return bRet
.head 5 +  Function: SelectCount
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sClasse
.head 7 -  Boolean: bErro
.head 6 +  Actions
.head 7 -  Set sWhere = ''
.head 7 -  Set sClasse = SalObjGetType( this )
.head 7 -  Set sClasse = SalStrMidX( sClasse, 1, SalStrLength( sClasse ) - 7 )
.head 7 -  Call PrepareConditions()
.head 7 -  Set bErro = FALSE
.head 7 +  When SqlError
.head 8 -  Set nCount = ..SelectCount( hSqlParam )
.head 8 -  Set bErro = TRUE
.head 8 -  Return FALSE
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, '
Select Count(*)
into :nCount
From ' || sClasse || ' ' || sWhere )
.head 7 +  If Not bErro
.head 8 -  Call SqlFetchNext( hSqlParam, nFetch )
.head 7 -  Return nCount
.head 5 +  Function: Initialize
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sWhere = STRING_Null
.head 7 -  Set nConditions = 0
.head 7 -  Call ..Initialize()
.head 5 +  Function: GetCount
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nCount
.head 5 +  Function: ListPopulate
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: lbList
.head 7 -  Number: nQtdeCaractCodigo
.head 7 -  String: sCodigo
.head 7 -  String: sDescricao
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Call ..ListPopulate( lbList, nQtdeCaractCodigo, sCodigo, sDescricao )
.head 5 +  Function: ListGetCodigo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Window Handle: lbList
.head 7 -  Number: nMaxLen
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sValor
.head 6 +  Actions
.head 7 -  Call SalGetWindowText( lbList, sValor, nMaxLen )
.head 7 -  Return SalStrToNumber( sValor )
.head 5 +  Function: TablePopulate
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWndTable
.head 7 -  Number: nCaso
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ..TablePopulate(hWndTable,nCaso)
.head 7 -  Call SalTblSetFlagsAnyRows( hWndTable, ROW_New, FALSE, 0, 0 )
.head 5 +  Function: ListSetCodigo
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndList
.head 7 -  Number: nCodigo
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sAux
.head 7 -  String: sString
.head 7 -  String: sCodigo
.head 7 -  Number: nLinha
.head 7 -  Number: nTotal
.head 7 -  Number: nIndice
.head 7 -  Number: nNumChars
.head 7 -  Number: nMaxChars
.head 7 -  Boolean: bOk
.head 6 +  Actions
.head 7 -  Set nTotal = SalListQueryCount ( hWndList )
.head 7 -  Set nLinha = 0
.head 7 -  Set bOk = FALSE
.head 7 +  While ( nLinha <= nTotal ) And ( not bOk )
.head 8 -  Set nIndice = 1
.head 8 -  Set nNumChars = 0
.head 8 -  Set sString = SalListQueryTextX( hWndList, nLinha )
.head 8 -  Set nMaxChars = SalStrGetBufferLength( sString )
.head 8 +  While nIndice <= nMaxChars
.head 9 -  Set sAux = SalStrLeftX( sString, nIndice )
.head 9 +  If SalStrRightX( sAux, 3 ) = ' - '
.head 10 +  If nCodigo = SalStrToNumber( SalStrLeftX( sAux, nNumChars - 2 ) )
.head 11 -  Call SalListSetSelect( hWndList, nLinha )
.head 11 -  Set bOk = TRUE
.head 11 -  Break
.head 10 +  Else
.head 11 -  Set nIndice = nMaxChars
.head 9 +  Else
.head 10 -  Set nNumChars = nNumChars + 1
.head 9 -  Set nIndice = nIndice + 1
.head 8 -  Set nLinha = nLinha + 1
.head 5 +  Function: ListSetString
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndList
.head 7 -  String: sStringLocalizar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sAux
.head 7 -  String: sString
.head 7 -  String: sCodigo
.head 7 -  Number: nLinha
.head 7 -  Number: nTotal
.head 7 -  Number: nIndice
.head 7 -  Number: nNumChars
.head 7 -  Number: nMaxChars
.head 7 -  Boolean: bOk
.head 6 +  Actions
.head 7 -  Set nTotal = SalListQueryCount ( hWndList )
.head 7 -  Set nLinha = 0
.head 7 -  Set bOk = FALSE
.head 7 +  While ( nLinha <= nTotal ) And ( not bOk )
.head 8 -  Set nIndice = 1
.head 8 -  Set nNumChars = 0
.head 8 -  Set sString = SalListQueryTextX( hWndList, nLinha )
.head 8 -  Set nMaxChars = SalStrGetBufferLength( sString )
.head 8 +  While nIndice <= nMaxChars
.head 9 -  Set sAux = SalStrLeftX( sString, nIndice )
.head 9 +  If SalStrRightX( sAux, 3 ) = ' - '
.head 10 +  If sStringLocalizar = SalStrLeftX( sAux, nNumChars - 2 )
.head 11 -  Call SalListSetSelect( hWndList, nLinha )
.head 11 -  Set bOk = TRUE
.head 11 -  Break
.head 10 +  Else
.head 11 -  Set nIndice = nMaxChars
.head 9 +  Else
.head 10 -  Set nNumChars = nNumChars + 1
.head 9 -  Set nIndice = nIndice + 1
.head 8 -  Set nLinha = nLinha + 1
.head 5 +  Function: AddCondition
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sColuna
.head 7 -  FunctionalVar: vInicio
.head 8 -  Class: Variant
.head 7 -  FunctionalVar: vFim
.head 8 -  Class: Variant
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 7 -  Number: nIndice
.head 7 -  Number: nInicio
.head 7 -  Number: nFim
.head 7 -  Date/Time: dtInicio
.head 7 -  Date/Time: dtFim
.head 7 -  String: sInicio
.head 7 -  String: sFim
.head 6 +  Actions
.head 7 -  Set nConditions = nConditions + 1
.head 7 -  Set nMax = nConditions
.head 7 +  If vInicio.SalType( ) = SAL_DATE
.head 8 -  Set sCamposHeader = sCamposHeader || 'dt' || sColuna || ','
.head 8 -  Call vInicio.GetDate( dtInicio )
.head 8 -  Call vFim.GetDate( dtFim )
.head 8 +  If dtInicio != DATETIME_Null
.head 9 +  If dtFim != DATETIME_Null
.head 10 -  Set sConditions[nMax] = ' ( ' || sColuna || ' >= \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' And '
		            || sColuna || ' <= \'' || SalFmtFormatDateTime( dtFim, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' ) '
.head 10 -  Set sColunasLog[nMax] = 'dt' || sColuna
.head 10 -  Set sConditionsLog[nMax] = ' %COLUNA  >= \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' And  %COLUNA  <= \'' || SalFmtFormatDateTime( dtFim, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' '
.head 10 -  Set dtValor1[nMax] = dtInicio
.head 10 -  Set dtValor2[nMax] = dtFim
.head 9 +  Else
.head 10 -  Set sConditions[nMax] = ' ( ' || sColuna || ' >= \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' '
.head 10 -  Set sColunasLog[nMax] = 'dt' || sColuna
.head 10 -  Set sConditionsLog[nMax] = ' %COLUNA  = \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' '
.head 10 -  Set dtValor1[nMax] = dtInicio
.head 7 +  Else If vInicio.SalType( ) = SAL_NUMBER
.head 8 -  Set sCamposHeader = sCamposHeader || 'n' || sColuna || ','
.head 8 -  Call vInicio.GetNumber( nInicio )
.head 8 -  Call vFim.GetNumber( nFim )
.head 8 +  If nInicio != NUMBER_Null
.head 9 +  If nFim != NUMBER_Null
.head 10 -  Set sConditions[nMax] = ' ( ' || sColuna || ' >= :nValor1[' || SalNumberToStrX( nMax, 0 ) || '] And ' || sColuna || ' <= :nValor2[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 10 -  Set sColunasLog[nMax] = 'n' || sColuna
.head 10 -  Set sConditionsLog[nMax] = ' %COLUNA  >= nValor1[' || SalNumberToStrX( nMax, 0 ) || '] And  %COLUNA  <= nValor2[' || SalNumberToStrX( nMax, 0 ) || '] '
.head 10 -  Set nValor1[nMax] = nInicio
.head 10 -  Set nValor2[nMax] = nFim
.head 9 +  Else
.head 10 -  Set sConditions[nMax] = ' ( ' || sColuna || ' = :nValor1[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 10 -  Set sColunasLog[nMax] = 'n' || sColuna
.head 10 -  Set sConditionsLog[nMax] = ' %COLUNA  = nValor1[' || SalNumberToStrX( nMax, 0 ) || '] '
.head 10 -  Set nValor1[nMax] = nInicio
.head 7 +  Else If vInicio.SalType( ) = SAL_STRING
.head 8 -  Set sCamposHeader = sCamposHeader || 's' || sColuna || ','
.head 8 -  Call vInicio.GetString( sInicio )
.head 8 -  Call vFim.GetString( sFim )
.head 8 +  If SalStrTrimX( sFim ) = STRING_Null And
   SalStrTrimX( sInicio ) != STRING_Null
.head 9 -  Set nIndice = 0
.head 9 +  While SalStrScan( sInicio, '*' ) >= 0
.head 10 -  Set sInicio = SalStrReplaceX( sInicio, SalStrScan( sInicio, '*' ), 1, '%' )
.head 9 -  Set sConditions[nMax] = ' ( ' || sColuna || ' Like :sValor1[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 9 -  Set sColunasLog[nMax] = 's' || sColuna
.head 9 -  Set sConditionsLog[nMax] = ' SalStrScan( %COLUNA, sValor1[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 9 -  Set sValor1[nMax] = sInicio
.head 8 +  Else If SalStrTrimX( sInicio ) != STRING_Null
.head 9 -  Set sConditions[nMax] = ' ( ' || sColuna || ' >= :sValor1[' || SalNumberToStrX( nMax, 0 ) || '] And ' || sColuna || ' <= :sValor2[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 9 -  Set sColunasLog[nMax] = 's' || sColuna
.head 9 -  Set sConditionsLog[nMax] = ' %COLUNA  >= sValor1[' || SalNumberToStrX( nMax, 0 ) || '] And  %COLUNA  <= sValor2[' || SalNumberToStrX( nMax, 0 ) || '] '
.head 9 -  Set sValor1[nMax] = sInicio
.head 9 -  Set sValor2[nMax] = sFim
.head 8 +  Else
.head 9 -  Set sConditions[nMax] = STRING_Null
.head 9 -  Set sConditionsLog[nMax] = STRING_Null
.head 7 +  Else
.head 8 -  Set sConditions[nMax] = STRING_Null
.head 8 -  Set sConditionsLog[nMax] = STRING_Null
.head 5 +  Function: AddConditionPer
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sColuna
.head 7 -  FunctionalVar: vInicio
.head 8 -  Class: Variant
.head 7 -  FunctionalVar: vFim
.head 8 -  Class: Variant
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 7 -  Number: nIndice
.head 7 -  Number: nInicio
.head 7 -  Number: nFim
.head 7 -  Date/Time: dtInicio
.head 7 -  Date/Time: dtFim
.head 7 -  String: sInicio
.head 7 -  String: sFim
.head 6 +  Actions
.head 7 -  Set nConditionsPer = nConditionsPer + 1
.head 7 -  Set nMax = nConditionsPer
.head 7 +  If vInicio.SalType( ) = SAL_DATE
.head 8 -  Set sCamposHeader = sCamposHeader || 'dt' || sColuna || ','
.head 8 -  Call vInicio.GetDate( dtInicio )
.head 8 -  Call vFim.GetDate( dtFim )
.head 8 +  If dtInicio != DATETIME_Null
.head 9 +  If dtFim != DATETIME_Null
.head 10 -  Set sConditions[nMax] = ' ( ' || sColuna || ' >= \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' And '
		            || sColuna || ' <= \'' || SalFmtFormatDateTime( dtFim, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' ) '
.head 10 -  Set sColunasLog[nMax] = 'dt' || sColuna
.head 10 -  Set sConditionsLog[nMax] = ' %COLUNA  >= \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' And  %COLUNA  <= \'' || SalFmtFormatDateTime( dtFim, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' '
.head 10 -  Set dtValor1[nMax] = dtInicio
.head 10 -  Set dtValor2[nMax] = dtFim
.head 9 +  Else
.head 10 -  Set sConditions[nMax] = ' ( ' || sColuna || ' >= \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' '
.head 10 -  Set sColunasLog[nMax] = 'dt' || sColuna
.head 10 -  Set sConditionsLog[nMax] = ' %COLUNA  = \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' '
.head 10 -  Set dtValor1[nMax] = dtInicio
.head 7 +  Else If vInicio.SalType( ) = SAL_NUMBER
.head 8 -  Set sCamposHeader = sCamposHeader || 'n' || sColuna || ','
.head 8 -  Call vInicio.GetNumber( nInicio )
.head 8 -  Call vFim.GetNumber( nFim )
.head 8 +  If nInicio != NUMBER_Null
.head 9 +  If nFim != NUMBER_Null
.head 10 -  Set sConditionsPer[nMax] = ' ( ' || sColuna || ' >= :nValor1Per[' || SalNumberToStrX( nMax, 0 ) || '] And ' || sColuna || ' <= :nValor2Per[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 10 -  Set nValor1Per[nMax] = nInicio
.head 10 -  Set nValor2Per[nMax] = nFim
.head 9 +  Else
.head 10 -  Set sConditionsPer[nMax] = ' ( ' || sColuna || ' = :nValor1Per[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 10 -  Set nValor1Per[nMax] = nInicio
.head 7 +  Else If vInicio.SalType( ) = SAL_STRING
.head 8 -  Set sCamposHeader = sCamposHeader || 's' || sColuna || ','
.head 8 -  Call vInicio.GetString( sInicio )
.head 8 -  Call vFim.GetString( sFim )
.head 8 +  If SalStrTrimX( sFim ) = STRING_Null And
   SalStrTrimX( sInicio ) != STRING_Null
.head 9 -  Set nIndice = 0
.head 9 +  While SalStrScan( sInicio, '*' ) >= 0
.head 10 -  Set sInicio = SalStrReplaceX( sInicio, SalStrScan( sInicio, '*' ), 1, '%' )
.head 9 -  Set sConditionsPer[nMax] = ' ( ' || sColuna || ' Like :sValor1Per[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 9 -  Set sValor1Per[nMax] = sInicio
.head 8 +  Else If SalStrTrimX( sInicio ) != STRING_Null
.head 9 -  Set sConditionsPer[nMax] = ' ( ' || sColuna || ' >= :sValor1Per[' || SalNumberToStrX( nMax, 0 ) || '] And ' || sColuna || ' <= :sValor2Per[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 9 -  Set sValor1Per[nMax] = sInicio
.head 9 -  Set sValor2Per[nMax] = sFim
.head 8 +  Else
.head 9 -  Set sConditionsPer[nMax] = STRING_Null
.head 7 +  Else
.head 8 -  Set sConditionsPer[nMax] = STRING_Null
.head 5 +  Function: AddConditionEx
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sColuna
.head 7 -  String: sOperador
.head 7 -  FunctionalVar: vValor
.head 8 -  Class: Variant
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 7 -  Number: nIndice
.head 7 -  Number: nInicio
.head 7 -  Date/Time: dtInicio
.head 7 -  String: sTexto
.head 6 +  Actions
.head 7 -  Set nConditions = nConditions + 1
.head 7 -  Set nMax = nConditions
.head 7 +  If vValor.SalType( ) = SAL_DATE
.head 8 -  Set sCamposHeader = sCamposHeader || 'dt' || sColuna || ','
.head 8 -  Call vValor.GetDate( dtInicio )
.head 8 -  Set sConditions[nMax] = ' ( ' || sColuna || ' ' || sOperador || ' \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' ) '
.head 8 -  Set sColunasLog[nMax] = 'dt' || sColuna
.head 8 -  Set sConditionsLog[nMax] = ' %COLUNA ' || sOperador || ' \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' '
.head 8 -  Set dtValor1[nMax] = dtInicio
.head 7 +  Else If vValor.SalType( ) = SAL_NUMBER
.head 8 -  Set sCamposHeader = sCamposHeader || 'n' || sColuna || ','
.head 8 -  Call vValor.GetNumber( nInicio )
.head 8 -  Set sConditions[nMax] = ' ( ' || sColuna || ' ' || sOperador || ' :nValor1[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 8 -  Set sColunasLog[nMax] = 'n' || sColuna
.head 8 -  Set sConditionsLog[nMax] = ' %COLUNA ' || sOperador || ' nValor1[' || SalNumberToStrX( nMax, 0 ) || '] '
.head 8 -  Set nValor1[nMax] = nInicio
.head 7 +  Else If vValor.SalType( ) = SAL_STRING
.head 8 -  Set sCamposHeader = sCamposHeader || 's' || sColuna || ','
.head 8 -  Call vValor.GetString( sTexto )
.head 8 +  If SalStrTrimX( sTexto ) != STRING_Null
.head 9 -  Set sConditions[nMax] = ' ( ' || sColuna || ' ' || sOperador || ' :sValor1[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 9 -  Set sColunasLog[nMax] = 's' || sColuna
.head 9 -  Set sConditionsLog[nMax] = ' %COLUNA ' || sOperador || ' sValor1[' || SalNumberToStrX( nMax, 0 ) || '] '
.head 9 -  Set sValor1[nMax] = sTexto
.head 7 +  Else
.head 8 -  Set sConditions[nMax] = STRING_Null
.head 8 -  Set sConditionsLog[nMax] = STRING_Null
.head 5 +  Function: AddConditionPerEx
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sColuna
.head 7 -  String: sOperador
.head 7 -  FunctionalVar: vValor
.head 8 -  Class: Variant
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 7 -  Number: nIndice
.head 7 -  Number: nInicio
.head 7 -  Date/Time: dtInicio
.head 7 -  String: sTexto
.head 6 +  Actions
.head 7 -  Set nConditionsPer = nConditionsPer + 1
.head 7 -  Set nMax = nConditionsPer
.head 7 +  If vValor.SalType( ) = SAL_DATE
.head 8 -  Set sCamposHeader = sCamposHeader || 'dt' || sColuna || ','
.head 8 -  Call vValor.GetDate( dtInicio )
.head 8 -  Set sConditionsPer[nMax] = ' ( ' || sColuna || ' ' || sOperador || ' \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' '
.head 8 -  Set sColunasLog[nMax] = 'dt' || sColuna
.head 8 -  Set sConditionsLog[nMax] = ' %COLUNA ' || sOperador || ' \'' || SalFmtFormatDateTime( dtInicio, 'yyyy-MM-dd hhhh:mm:ss' ) || '\' '
.head 8 -  Set dtValor1Per[nMax] = dtInicio
.head 7 +  Else If vValor.SalType( ) = SAL_NUMBER
.head 8 -  Set sCamposHeader = sCamposHeader || 'n' || sColuna || ','
.head 8 -  Call vValor.GetNumber( nInicio )
.head 8 -  Set sConditionsPer[nMax] = ' ( ' || sColuna || ' ' || sOperador || ' :nValor1Per[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 8 -  Set nValor1Per[nMax] = nInicio
.head 7 +  Else If vValor.SalType( ) = SAL_STRING
.head 8 -  Set sCamposHeader = sCamposHeader || 's' || sColuna || ','
.head 8 -  Call vValor.GetString( sTexto )
.head 8 +  If SalStrTrimX( sTexto ) != STRING_Null
.head 9 -  Set sConditionsPer[nMax] = ' ( ' || sColuna || ' ' || sOperador || ' :sValor1Per[' || SalNumberToStrX( nMax, 0 ) || '] ) '
.head 9 -  Set sValor1Per[nMax] = sTexto
.head 7 +  Else
.head 8 -  Set sConditionsPer[nMax] = STRING_Null
.head 5 +  Function: AddConditionDirect
.head 6 -  Description: condição direta, por exemplo, 'CAMPO IS NULL' ou 'CAMPO IS NOT NULL'
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sCondition
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 -  Set nConditions = nConditions + 1
.head 7 -  Set nMax = nConditions
.head 7 -  Set sConditions[nMax] = ' ( ' || sCondition || ' ) '
.head 5 +  Function: PrepareConditions
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 6 +  Actions
.head 7 -  Set nIndice = 1
.head 7 +  While nIndice <= nConditions
.head 8 +  If SalStrTrimX( sConditions[nIndice] ) != ''
.head 9 +  If sWhere = ''
.head 10 -  Set sWhere = ' Where '
.head 9 +  Else
.head 10 -  Set sWhere = sWhere || ' And '
.head 9 -  Set sWhere = sWhere || sConditions[nIndice]
.head 8 -  Set nIndice = nIndice + 1
.head 7 -  Set nIndice = 1
.head 7 +  While nIndice <= nConditionsPer
.head 8 +  If SalStrTrimX( sConditionsPer[nIndice] ) != ''
.head 9 +  If sWhere = ''
.head 10 -  Set sWhere = ' Where '
.head 9 +  Else
.head 10 -  Set sWhere = sWhere || ' And '
.head 9 -  Set sWhere = sWhere || sConditionsPer[nIndice]
.head 8 -  Set nIndice = nIndice + 1
.head 5 +  Function: FreeConditions
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( sConditions, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( nValor1, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( nValor2, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( dtValor1, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( dtValor2, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( sValor1, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( sValor2, 1, -1 )
.head 7 -  Set nConditions = 0
.head 7 -  Set sCamposHeader = ''
.head 5 +  Function: FreeAllConditions
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( sConditions, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( nValor1, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( nValor2, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( dtValor1, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( dtValor2, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( sValor1, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( sValor2, 1, -1 )
.head 7 -  Set nConditions = 0
.head 7 -  Call SalArraySetUpperBound( sConditionsPer, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( nValor1Per, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( nValor2Per, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( dtValor1Per, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( dtValor2Per, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( sValor1Per, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( sValor2Per, 1, -1 )
.head 7 -  Set nConditionsPer = 0
.head 7 -  Set sCamposHeader = ''
.head 5 +  Function: AddComboDependency
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sExpressao
.head 7 -  Number: nIndiceExp
.head 7 -  Window Handle: cmbCombo
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 7 -  String: sNome
.head 6 +  Actions
.head 7 -  Call SalGetItemName( cmbCombo, sNome )
.head 7 -  Set sIndices[nIndiceExp] = '["' || sNome || '", ['
.head 7 -  Set nIndice = 0
.head 7 +  While SalListSetSelect( cmbCombo, nIndice )
.head 8 +  If nIndice > 0
.head 9 -  Set sIndices[nIndiceExp] = sIndices[nIndiceExp] || ','
.head 8 -  Set sIndices[nIndiceExp] = sIndices[nIndiceExp] || '"' || SalListQueryTextX( cmbCombo, nIndice ) || '"'
.head 8 -  Set nIndice = nIndice + 1
.head 7 -  Set sIndices[nIndiceExp] = sIndices[nIndiceExp] || ']]'
.head 5 +  Function: GetVariantNumber
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  FunctionalVar: vParam
.head 8 -  Class: Variant
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nAns
.head 6 +  Actions
.head 7 -  Call vParam.GetNumber( nAns )
.head 7 -  Return nAns
.head 5 +  Function: GetVariantString
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  FunctionalVar: vParam
.head 8 -  Class: Variant
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sAns
.head 6 +  Actions
.head 7 -  Call vParam.GetString( sAns )
.head 7 -  Call VisStrSubstitute (sAns, '
', ' ' )
.head 7 -  Return sAns
.head 5 +  Function: GetVariantDatetime
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Date/Time:
.head 6 +  Parameters
.head 7 -  FunctionalVar: vParam
.head 8 -  Class: Variant
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Date/Time: dtAns
.head 6 +  Actions
.head 7 -  Call vParam.GetDate( dtAns )
.head 7 -  Return dtAns
.head 5 +  Function: GetClassVarNameValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  FunctionalVar: (no name)
.head 8 -  Class: Variant
.head 6 +  Parameters
.head 7 -  String: sVariavel
.head 7 -  Number: nVetorPos
.head 6 +  Static Variables
.head 7 -  FunctionalVar: vParamExport
.head 8 -  Class: Variant
.head 6 +  Local variables
.head 7 -  Number: nAns
.head 6 +  Actions
.head 7 -  Return ..GetClassVarNameValue( sVariavel, nVetorPos )
.head 5 +  Function: GetClassVarNameValueLong
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Long String:
.head 6 +  Parameters
.head 7 -  String: sVariavel
.head 7 -  Number: nVetorPos
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ..GetClassVarNameValueLong( sVariavel, nVetorPos )
.head 5 +  Function: SetClassVarNameValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nVetorPos
.head 7 -  String: sNomeVar
.head 7 -  String: sValor
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ..SetClassVarNameValue( nVetorPos, sNomeVar, sValor )
.head 5 +  Function: ProcessaReg
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nLinha
.head 7 -  String: sOperacao
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ..ProcessaReg( hSqlParam, nLinha, sOperacao )
.head 5 -  !
.head 3 +  Functional Class: fcDBDicionarioDados
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  ComProxyVar: cDocumento
.head 6 -  Class: MSXML2_DOMDocument
.head 5 -  FunctionalVar: cTabelas
.head 6 -  Class: MSXML2_IXMLDOMElement
.head 5 -  FunctionalVar: cTabela
.head 6 -  Class: MSXML2_IXMLDOMElement
.head 5 -  FunctionalVar: cColunas
.head 6 -  Class: MSXML2_IXMLDOMElement
.head 5 -  FunctionalVar: cColuna
.head 6 -  Class: MSXML2_IXMLDOMElement
.head 5 -  FunctionalVar: cRelacionamentos
.head 6 -  Class: MSXML2_IXMLDOMElement
.head 5 -  FunctionalVar: cRelacao
.head 6 -  Class: MSXML2_IXMLDOMElement
.head 5 -  FunctionalVar: cRelacaoDet
.head 6 -  Class: MSXML2_IXMLDOMElement
.head 5 -  FunctionalVar: cSubElementGrupo
.head 6 -  Class: MSXML2_IXMLDOMElement
.head 5 -  !
.head 5 -  FunctionalVar: cNodeRetorno
.head 6 -  Class: MSXML2_IXMLDOMNode
.head 5 -  !
.head 5 -  FunctionalVar: cNodeListParent
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: MSXML2_IXMLDOMNodeList
.head 5 -  FunctionalVar: cNodeListaTabela
.head 6 -  Class: MSXML2_IXMLDOMNodeList
.head 5 -  FunctionalVar: cNodeListaTabDetalhes
.head 6 -  Class: MSXML2_IXMLDOMNodeList
.head 5 -  FunctionalVar: cNodeListaColuna
.head 6 -  Class: MSXML2_IXMLDOMNodeList
.head 5 -  FunctionalVar: cNodeListCol
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: MSXML2_IXMLDOMNodeList
.head 5 -  FunctionalVar: cNodeRelacao
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: MSXML2_IXMLDOMNodeList
.head 5 -  !
.head 5 -  String: sPathComNomeDoArquivo
.head 5 -  FunctionalVar: oaTabelas[*]
.head 6 -  Class: fcDBTabela
.head 4 +  Functions
.head 5 +  Function: Carregar
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bExibirMeter
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 7 -  FunctionalVar: vValor
.head 8 -  Class: Variant
.head 7 -  String: sValor
.head 7 -  String: spPathComNomeDoArquivo
.head 7 -  Long String: lsValor
.head 7 -  Number: nValor
.head 7 -  Date/Time: dtAgora
.head 7 -  Date/Time: dtValor
.head 7 -  !
.head 7 -  String: sTabela
.head 7 -  Number: nLinhaTabela
.head 7 -  Number: nMaxTabelas
.head 7 -  Number: nLinhaColunas
.head 7 -  Number: nQtdeColunas
.head 7 -  Number: nTotalItens
.head 7 -  Number: nItem
.head 7 -  !
.head 7 -  Number: nQtdeRelacao
.head 7 -  Number: nLinhaRelacao
.head 7 -  Number: nQtdeRelacaoDet
.head 7 -  Number: nLinhaRelacaoDet
.head 6 +  Actions
.head 7 -  Call Reset ()
.head 7 -  Call SalFileGetCurrentDirectory( sPathComNomeDoArquivo )
.head 7 -  Set sPathComNomeDoArquivo = sPathComNomeDoArquivo || "\\DbvDD.xml"
.head 7 -  Set dtAgora = SalDateCurrent( )
.head 7 -  Call cDocumento.Create( )
.head 7 -  Call vValor.SetString( sPathComNomeDoArquivo  )
.head 7 -  Call cDocumento.load( vValor, bOk )
.head 7 +  If bOk
.head 8 -  Call cDocumento.PropGetfirstChild( cTabelas )
.head 8 -  Call cTabelas.PropGetnodeName( sValor )
.head 8 +  If SalStrUpperX( sValor ) = 'TABELAS'
.head 9 -  Call cTabelas.selectNodes( 'tabela', cNodeListaTabela )
.head 9 -  Call cNodeListaTabela.PropGetlength( nMaxTabelas )
.head 9 -  Set nLinhaTabela = 0
.head 9 +  If bExibirMeter
.head 10 -  Call SonMeter(1, 0, 1, 'Carregando dicionário de dados' )
.head 9 +  While nLinhaTabela < nMaxTabelas
.head 10 -  Call cNodeListaTabela.PropGetitem( nLinhaTabela, cTabela )
.head 10 -  ! Pegando o valor do atributo - codigo
.head 10 -  Call cTabela.getAttribute( 'codigo', vValor )
.head 10 -  Call vValor.GetNumber( nValor )
.head 10 -  Set oaTabelas[ nLinhaTabela ].nCodigo = nValor
.head 10 -  !
.head 10 -  Call cTabela.getAttribute( 'nome', vValor )
.head 10 -  Call vValor.GetString( sValor )
.head 10 -  Set oaTabelas[ nLinhaTabela ].sNOME = sValor
.head 10 -  !
.head 10 -  Call cTabela.getAttribute( 'mneumonico', vValor )
.head 10 -  Call vValor.GetString( sValor )
.head 10 -  Set oaTabelas[ nLinhaTabela ].sMNEUMONICO = sValor
.head 10 -  !
.head 10 -  Call cTabela.getAttribute( 'descricao', vValor )
.head 10 -  Call vValor.GetString( lsValor )
.head 10 -  Set oaTabelas[ nLinhaTabela ].lsDESCRICAO = lsValor
.head 10 -  !
.head 10 -  Call cTabela.getAttribute( 'versao', vValor )
.head 10 -  Call vValor.GetNumber( nValor )
.head 10 -  Set oaTabelas[ nLinhaTabela ].nVERSAO = nValor
.head 10 -  !
.head 10 -  Call cTabela.getAttribute( 'ultimaalteracao', vValor )
.head 10 -  Call vValor.GetDate( dtValor )
.head 10 +  If dtValor = DATETIME_Null
.head 11 -  Set dtValor = dtAgora
.head 10 -  Set oaTabelas[ nLinhaTabela ].dtMOVIMENTO = dtValor
.head 10 -  ! ================================================
.head 10 -  Call cTabela.PropGetchildNodes( cNodeListParent )
.head 10 -  Call cNodeListParent.PropGetlength( nTotalItens )
.head 10 -  Set nItem = 0
.head 10 +  While nItem < nTotalItens
.head 11 -  Call cNodeListParent.PropGetitem( nItem, cSubElementGrupo )
.head 11 -  ! Colunas =====================================
.head 11 -  Call cSubElementGrupo.PropGetnodeName( sValor )
.head 11 +  If SalStrUpperX( sValor ) = 'COLUNAS'
.head 12 -  Call cSubElementGrupo.selectNodes( 'coluna', cNodeListCol )
.head 12 -  Call cNodeListCol.PropGetlength( nQtdeColunas )
.head 12 -  Set nLinhaColunas = 0
.head 12 +  While nLinhaColunas < nQtdeColunas
.head 13 -  Call cNodeListCol.PropGetitem( nLinhaColunas, cColuna )
.head 13 -  Set oaTabelas[ nLinhaTabela ].oaColunas[ nLinhaColunas ].sTABELA = oaTabelas[ nLinhaTabela ].sNOME
.head 13 -  ! pegando o codigo da coluna
.head 13 -  Call cColuna.getAttribute( 'codigo', vValor )
.head 13 -  Call vValor.GetNumber( nValor )
.head 13 -  Set oaTabelas[ nLinhaTabela ].oaColunas[ nLinhaColunas ].nCODIGO = nValor
.head 13 -  ! pegando o nome da coluna
.head 13 -  Call cColuna.getAttribute( 'nome', vValor )
.head 13 -  Call vValor.GetString( sValor )
.head 13 -  Set oaTabelas[ nLinhaTabela ].oaColunas[ nLinhaColunas ].sNOME = SalStrTrimX( sValor )
.head 13 -  ! codtipo
.head 13 -  Call cColuna.getAttribute( 'codtipo', vValor )
.head 13 -  Call vValor.GetNumber( nValor )
.head 13 -  Set oaTabelas[ nLinhaTabela ].oaColunas[ nLinhaColunas ].nTIPO = nValor
.head 13 -  ! tipo
.head 13 -  Call cColuna.getAttribute( 'tipo', vValor )
.head 13 -  Call vValor.GetString( sValor )
.head 13 -  Set oaTabelas[ nLinhaTabela ].oaColunas[ nLinhaColunas ].sTIPO = sValor
.head 13 -  ! PK
.head 13 -  Call cColuna.getAttribute( 'pk', vValor )
.head 13 -  Call vValor.GetNumber( nValor )
.head 13 -  Set oaTabelas[ nLinhaTabela ].oaColunas[ nLinhaColunas ].nPK = nValor
.head 13 -  ! Tamanho
.head 13 -  Call cColuna.getAttribute( 'tamanho', vValor )
.head 13 -  Call vValor.GetNumber( nValor )
.head 13 -  Set oaTabelas[ nLinhaTabela ].oaColunas[ nLinhaColunas ].nTAMANHO = nValor
.head 13 -  ! Decimais
.head 13 -  Call cColuna.getAttribute( 'decimais', vValor )
.head 13 -  Call vValor.GetNumber( nValor )
.head 13 -  Set oaTabelas[ nLinhaTabela ].oaColunas[ nLinhaColunas ].nDECIMAL = nValor
.head 13 -  ! nulls
.head 13 -  Call cColuna.getAttribute( 'nulo', vValor )
.head 13 -  Call vValor.GetNumber( nValor )
.head 13 -  Set oaTabelas[ nLinhaTabela ].oaColunas[ nLinhaColunas ].nNULO = nValor
.head 13 -  !
.head 13 -  Set nLinhaColunas = nLinhaColunas + 1
.head 11 -  ! Relação =====================================
.head 11 +  If SalStrUpperX( sValor ) = 'RELACIONAMENTOS'
.head 12 -  Call cSubElementGrupo.selectNodes( 'relacao', cNodeRelacao )
.head 12 -  Call cNodeRelacao.PropGetlength( nQtdeRelacao )
.head 12 -  Set nLinhaRelacao = 0
.head 12 +  While nLinhaRelacao < nQtdeRelacao
.head 13 -  Call cNodeRelacao.PropGetitem( nLinhaRelacao, cRelacao )
.head 13 -  Set oaTabelas[ nLinhaTabela ].oaRelacao[ nLinhaRelacao ].sTABELA = oaTabelas[ nLinhaTabela ].sNOME
.head 13 -  ! nome
.head 13 +  If cRelacao.getAttribute( 'nome', vValor )
.head 14 -  Call vValor.GetString( sValor )
.head 14 -  Set oaTabelas[ nLinhaTabela ].oaRelacao[ nLinhaRelacao ].sNOME = sValor
.head 13 -  ! tipo
.head 13 +  If cRelacao.getAttribute( 'tipo', vValor )
.head 14 -  Call vValor.GetString( sValor )
.head 14 -  Set oaTabelas[ nLinhaTabela ].oaRelacao[ nLinhaRelacao ].sTIPOCONSTRAINT = sValor
.head 13 -  ! Lendo o proximo nivel - COLUNAS
.head 13 -  Call cRelacao.selectNodes( 'colunas_relacao', cNodeListCol )
.head 13 -  Call cNodeListCol.PropGetlength( nQtdeRelacaoDet )
.head 13 -  Set nLinhaRelacaoDet = 0
.head 13 +  While nLinhaRelacaoDet < nQtdeRelacaoDet
.head 14 -  Call cNodeListCol.PropGetitem( nLinhaRelacaoDet, cColuna )
.head 14 -  ! pegando o codigo da coluna
.head 14 -  ! Coluna
.head 14 +  If cColuna.getAttribute( 'coluna', vValor )
.head 15 -  Call vValor.GetString( sValor )
.head 15 -  Set oaTabelas[ nLinhaTabela ].oaRelacao[ nLinhaRelacao ].oaRelacaoDet[ nLinhaRelacaoDet ].sCOLUNA = sValor
.head 14 -  Set oaTabelas[ nLinhaTabela ].oaRelacao[ nLinhaRelacao ].oaRelacaoDet[ nLinhaRelacaoDet ].sNOME = oaTabelas[ nLinhaTabela ].oaRelacao[ nLinhaRelacao ].sNOME
.head 14 +  If oaTabelas[ nLinhaTabela ].oaRelacao[ nLinhaRelacao ].sTIPOCONSTRAINT = 'FK'
.head 15 -  ! Tabela FK
.head 15 +  If cColuna.getAttribute( 'tabelaFK', vValor )
.head 16 -  Call vValor.GetString( sValor )
.head 16 -  Set oaTabelas[ nLinhaTabela ].oaRelacao[ nLinhaRelacao ].oaRelacaoDet[ nLinhaRelacaoDet ].sTABELAFK = sValor
.head 15 -  ! Coluna FK
.head 15 +  If cColuna.getAttribute( 'colunaFK', vValor )
.head 16 -  Call vValor.GetString( sValor )
.head 16 -  Set oaTabelas[ nLinhaTabela ].oaRelacao[ nLinhaRelacao ].oaRelacaoDet[ nLinhaRelacaoDet ].sCOLUNAFK = sValor
.head 14 -  !
.head 14 -  Set nLinhaRelacaoDet = nLinhaRelacaoDet + 1
.head 13 -  !
.head 13 -  Set nLinhaRelacao = nLinhaRelacao + 1
.head 11 -  ! ==============================================
.head 11 -  Set nItem = nItem + 1
.head 10 -  !
.head 10 +  If bExibirMeter
.head 11 -  Call SonMeter(1, nLinhaTabela / nMaxTabelas * 100, 1, '' )
.head 10 -  Set nLinhaTabela = nLinhaTabela + 1
.head 9 +  If bExibirMeter
.head 10 -  Call SonMeter(1, 100, 1, '' )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 +  If bExibirMeter
.head 9 +  If SalMsgPergunta(  'Não foi possível ler a definição de dicionário de dados. ['|| sPathComNomeDoArquivo ||'] 

Deseja criá-lo ?' )
.head 10 -  Call CriaXML ()
.head 8 -  Return FALSE
.head 5 +  Function: CriaXML
.head 6 -  Description: Cria um arquivo DbvDD.bin que irá armazenar as informações do Dicionário de Dadosde do sistema.
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  ComProxyVar: oDocNovo
.head 8 -  Class: MSXML2_DOMDocument
.head 7 -  FunctionalVar: vValor
.head 8 -  Class: Variant
.head 7 -  String: sValor
.head 6 +  Actions
.head 7 -  Call oDocNovo.Create( )
.head 7 -  Call oDocNovo.createElement( "tabelas", cTabelas )
.head 7 -  Call vValor.SetNumber( 0, VT_I4 )
.head 7 -  Call cTabelas.setAttribute( 'qtde_tabelas', vValor )
.head 7 -  Call vValor.SetNumber( 0, VT_I4 )
.head 7 -  Call cTabelas.setAttribute( 'qtde_tabelas', vValor )
.head 7 -  Call vValor.SetDate( SalDateCurrent () )
.head 7 -  Call cTabelas.setAttribute( 'data_edicao', vValor )
.head 7 -  Call oDocNovo.appendChild( cTabelas, cNodeRetorno )
.head 7 -  ! !!! Salva alterações finais, criando um arquivo
.head 7 -  Call vValor.SetString( sPathComNomeDoArquivo  )
.head 7 -  Call oDocNovo.save( vValor )
.head 5 +  Function: Find
.head 6 -  Description: Procura pelo código da tabela e retorna o id do array da tabela que se deseja trabalhar
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: npCodigoTabela
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaTabelas )
.head 8 -  Call SalArrayGetUpperBound( oaTabelas, 1, nMax )
.head 8 -  Set nLinha = 0
.head 8 +  While nLinha <= nMax
.head 9 +  If isNullNumber( oaTabelas[nLinha].nCodigo, 0) = isNullNumber( npCodigoTabela, 0)
.head 10 -  Return nLinha
.head 9 -  Set nLinha = nLinha + 1
.head 7 -  Return -1
.head 5 +  Function: FindNome
.head 6 -  Description: Procura pelo nome da tabela e retorna o id do array da tabela que se deseja trabalhar
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sNomeParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaTabelas )
.head 8 -  Call SalArrayGetUpperBound( oaTabelas, 1, nMax )
.head 8 -  Set nLinha = 0
.head 8 +  While nLinha <= nMax
.head 9 +  If SalStrTrimX( SalStrUpperX( oaTabelas[nLinha].sNOME ) ) = SalStrTrimX( SalStrUpperX( sNomeParam ) )
.head 10 -  Return nLinha
.head 9 -  Set nLinha = nLinha + 1
.head 7 -  Return -1
.head 5 +  Function: getDescricaoTabela
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Long String:
.head 6 +  Parameters
.head 7 -  String: sNomeParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaTabelas )
.head 8 -  Call SalArrayGetUpperBound( oaTabelas, 1, nMax )
.head 8 -  Set nLinha = 0
.head 8 +  While nLinha <= nMax
.head 9 +  If SalStrTrimX( SalStrUpperX( oaTabelas[nLinha].sNOME ) ) = SalStrTrimX( SalStrUpperX( sNomeParam ) )
.head 10 -  Return oaTabelas[nLinha].lsDESCRICAO
.head 9 -  Set nLinha = nLinha + 1
.head 7 -  Return STRING_Null
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sPathComNomeDoArquivo = STRING_Null
.head 7 -  Call SalArraySetUpperBound( oaTabelas, 1, -1)
.head 5 +  Function: NextTab
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 +  If SalArrayIsEmpty( oaTabelas )
.head 8 -  Return 0
.head 7 +  Else
.head 8 -  Call SalArrayGetUpperBound( oaTabelas, 1, nMax )
.head 8 -  Return (nMax+1)
.head 5 +  Function: SalvaArquivo
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bExibirMeter
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinhaTabelas
.head 7 -  Number: nQtdeTabelas
.head 7 -  Number: nLinhaColunas
.head 7 -  Number: nQtdeColunas
.head 7 -  Number: nLinhaRelacao
.head 7 -  Number: nQtdeRelacao
.head 7 -  Number: nLinhaGrupoDER
.head 7 -  Number: nQtdeGrupoDER
.head 7 -  FunctionalVar: vValor
.head 8 -  Class: Variant
.head 6 +  Actions
.head 7 +  If bExibirMeter
.head 8 -  Call SonMeter(1, 0, 1, 'Salvando estrutura de dicionário de dados' )
.head 7 -  Set nLinhaTabelas = 0
.head 7 -  Set nQtdeTabelas = GetCount( )
.head 7 -  ! !!! Cria o documento XML [xxxDD.bin]
.head 7 -  Call cDocumento.Create( )
.head 7 -  ! !!! Cria um elemento, que será o elemento master do documento e receberá subelementos
.head 7 -  Call cDocumento.createElement( 'tabelas', cTabelas )
.head 7 -  ! !!! Seta/cria atributos do elemento cTabelas <tabelas [] [] [] [] >
.head 7 -  ! Call vValor.SetString( oSistema.sNOME )
.head 7 -  ! Call cTabelas.setAttribute( 'mneumonico', vValor )
.head 7 -  Call vValor.SetNumber( nQtdeTabelas, VT_I4 )
.head 7 -  Call cTabelas.setAttribute( 'qtde_tabelas', vValor )
.head 7 -  Call vValor.SetDate( SalDateCurrent () )
.head 7 -  Call cTabelas.setAttribute( 'data_edicao', vValor )
.head 7 -  ! !!! Dá o append do elemento <tabelas [] [] [] [] > como filho do Documento XML
.head 7 -  Call cDocumento.appendChild( cTabelas, cNodeRetorno )
.head 7 -  ! !!! Agora vai rodar as tabelas para gravar as mesmas como filhas do elemento <tabelas [] [] [] [] >
.head 7 +  While nLinhaTabelas < nQtdeTabelas
.head 8 +  If oaTabelas[ nLinhaTabelas ].sNOME != ''
.head 9 -  ! ! Criando o elemento <tabela [][][]> do Arquivo, no final ele dá append e insere no elemento
.head 9 -  Call cDocumento.createElement( 'tabela', cTabela )
.head 9 -  ! ! Setando attributos de um elemento
.head 9 -  Call vValor.SetNumber( oaTabelas[ nLinhaTabelas ].nCodigo, VT_I4 )
.head 9 -  Call cTabela.setAttribute( 'codigo', vValor )
.head 9 -  !
.head 9 -  Call vValor.SetString( oaTabelas[ nLinhaTabelas ].sNOME )
.head 9 -  Call cTabela.setAttribute( 'nome', vValor )
.head 9 -  !
.head 9 -  Call vValor.SetString( oaTabelas[ nLinhaTabelas ].sMNEUMONICO )
.head 9 -  Call cTabela.setAttribute( 'mneumonico', vValor )
.head 9 -  !
.head 9 -  Call vValor.SetString( oaTabelas[ nLinhaTabelas ].lsDESCRICAO )
.head 9 -  Call cTabela.setAttribute( 'descricao', vValor )
.head 9 -  !
.head 9 -  Call vValor.SetNumber( oaTabelas[ nLinhaTabelas ].nVERSAO, VT_I4 )
.head 9 -  Call cTabela.setAttribute( 'versao', vValor )
.head 9 -  !
.head 9 -  Call vValor.SetDate(  oaTabelas[ nLinhaTabelas ].dtMOVIMENTO )
.head 9 -  Call cTabela.setAttribute( 'ultimaalteracao', vValor )
.head 9 -  ! !! === Colunas ===============================================
.head 9 -  Set nQtdeColunas = oaTabelas[ nLinhaTabelas ].GetCountColunas( )
.head 9 -  Call cDocumento.createElement( 'colunas', cColunas )
.head 9 -  Set nLinhaColunas = 0
.head 9 +  While nLinhaColunas < nQtdeColunas
.head 10 -  Call cDocumento.createElement( 'coluna', cColuna )
.head 10 -  ! codigo
.head 10 -  Call vValor.SetNumber(oaTabelas[ nLinhaTabelas ].oaColunas[ nLinhaColunas].nCODIGO, VT_I4 )
.head 10 -  Call cColuna.setAttribute( 'codigo', vValor )
.head 10 -  ! nome
.head 10 -  Call vValor.SetString( oaTabelas[ nLinhaTabelas ].oaColunas[ nLinhaColunas].sNOME )
.head 10 -  Call cColuna.setAttribute( 'nome', vValor )
.head 10 -  ! cod tipo
.head 10 -  Call vValor.SetNumber(oaTabelas[ nLinhaTabelas ].oaColunas[ nLinhaColunas].nTIPO, VT_I4 )
.head 10 -  Call cColuna.setAttribute( 'codtipo', vValor )
.head 10 -  ! tipo
.head 10 -  Call vValor.SetString( oaTabelas[ nLinhaTabelas ].oaColunas[ nLinhaColunas].sTIPO )
.head 10 -  Call cColuna.setAttribute( 'tipo', vValor )
.head 10 -  ! PK
.head 10 -  Call vValor.SetNumber(oaTabelas[ nLinhaTabelas ].oaColunas[ nLinhaColunas].nPK, VT_I4 )
.head 10 -  Call cColuna.setAttribute( 'pk', vValor )
.head 10 -  ! Tamanho
.head 10 -  Call vValor.SetNumber(oaTabelas[ nLinhaTabelas ].oaColunas[ nLinhaColunas].nTAMANHO , VT_I4 )
.head 10 -  Call cColuna.setAttribute( 'tamanho', vValor )
.head 10 -  ! Decimais
.head 10 -  Call vValor.SetNumber(oaTabelas[ nLinhaTabelas ].oaColunas[ nLinhaColunas].nDECIMAL , VT_I4 )
.head 10 -  Call cColuna.setAttribute( 'decimais', vValor )
.head 10 -  ! nulls
.head 10 -  Call vValor.SetNumber(oaTabelas[ nLinhaTabelas ].oaColunas[ nLinhaColunas].nNULO , VT_I4 )
.head 10 -  Call cColuna.setAttribute( 'nulo', vValor )
.head 10 -  ! Adiciona o elemento <coluna [][][]>  no elemento <cColunas [][][]>
.head 10 -  Call cColunas.appendChild( cColuna, cNodeRetorno )
.head 10 -  Set nLinhaColunas = nLinhaColunas + 1
.head 9 -  ! Adiciona o elemento
.head 9 -  Call cTabela.appendChild( cColunas, cNodeRetorno )
.head 9 -  ! !! === Relacionamentos  ========================================
.head 9 -  Set nQtdeRelacao = oaTabelas[ nLinhaTabelas ].GetCountRelacao( )
.head 9 +  If nQtdeRelacao > 0
.head 10 -  Call cDocumento.createElement( 'relacionamentos', cRelacionamentos )
.head 10 -  Call vValor.SetNumber( nQtdeRelacao, VT_I4 )
.head 10 -  Call cSubElementGrupo.setAttribute( 'qtde', vValor )
.head 10 -  Set nLinhaRelacao = 0
.head 10 +  While nLinhaRelacao < nQtdeRelacao
.head 11 -  Call cDocumento.createElement( 'relacao', cRelacao )
.head 11 -  ! nome
.head 11 -  Call vValor.SetString( oaTabelas[ nLinhaTabelas ].oaRelacao[ nLinhaRelacao ].sNOME )
.head 11 -  Call cRelacao.setAttribute( 'nome', vValor )
.head 11 -  ! tipo
.head 11 -  Call vValor.SetString( oaTabelas[ nLinhaTabelas ].oaRelacao[ nLinhaRelacao ].sTIPOCONSTRAINT )
.head 11 -  Call cRelacao.setAttribute( 'tipo', vValor )
.head 11 -  ! Adiciona o elemento no documento
.head 11 -  Call cRelacionamentos.appendChild( cRelacao, cNodeRetorno )
.head 11 -  ! Colunas do relacionamento
.head 11 -  Set nQtdeColunas = oaTabelas[ nLinhaTabelas ].oaRelacao[ nLinhaRelacao ].GetCountColunas ()
.head 11 -  Set nLinhaColunas = 0
.head 11 +  While nLinhaColunas < nQtdeColunas
.head 12 -  Call cDocumento.createElement( 'colunas_relacao', cRelacaoDet )
.head 12 -  ! Coluna
.head 12 -  Call vValor.SetString( oaTabelas[ nLinhaTabelas ].oaRelacao[ nLinhaRelacao ].oaRelacaoDet[ nLinhaColunas ].sCOLUNA )
.head 12 -  Call cRelacaoDet.setAttribute( 'coluna', vValor )
.head 12 +  If oaTabelas[ nLinhaTabelas ].oaRelacao[ nLinhaRelacao ].sTIPOCONSTRAINT = 'FK'
.head 13 -  ! Tabela FK
.head 13 -  Call vValor.SetString( oaTabelas[ nLinhaTabelas ].oaRelacao[ nLinhaRelacao ].oaRelacaoDet[ nLinhaColunas ].sTABELAFK )
.head 13 -  Call cRelacaoDet.setAttribute( 'tabelaFK', vValor )
.head 13 -  ! Coluna FK
.head 13 -  Call vValor.SetString( oaTabelas[ nLinhaTabelas ].oaRelacao[ nLinhaRelacao ].oaRelacaoDet[ nLinhaColunas ].sCOLUNAFK )
.head 13 -  Call cRelacaoDet.setAttribute( 'colunaFK', vValor )
.head 12 -  ! Adiciona o elemento no documento
.head 12 -  Call cRelacao.appendChild( cRelacaoDet, cNodeRetorno )
.head 12 -  !
.head 12 -  Set nLinhaColunas = nLinhaColunas + 1
.head 11 -  Call cRelacionamentos.appendChild( cRelacao, cNodeRetorno )
.head 11 -  !
.head 11 -  Set nLinhaRelacao = nLinhaRelacao + 1
.head 10 -  Call cTabela.appendChild( cRelacionamentos, cNodeRetorno )
.head 9 -  ! ! Adiciona o elemento no elemento pai de todos <tabelas [] [] [] [] >
.head 9 -  Call cTabelas.appendChild( cTabela, cNodeRetorno )
.head 8 +  If bExibirMeter
.head 9 -  Call SonMeter(1, nLinhaTabelas / nQtdeTabelas * 100, 1, 'Salvando estrutura de dicionário de dados ' || SalNumberToStrX( nLinhaTabelas, 0 ) || ' de ' ||  SalNumberToStrX( nQtdeTabelas, 0 ) )
.head 8 -  Set nLinhaTabelas = nLinhaTabelas + 1
.head 7 -  !
.head 7 -  ! !!! Finaliza e grava o arquivo
.head 7 -  Call vValor.SetString( sPathComNomeDoArquivo )
.head 7 -  Call cDocumento.save( vValor )
.head 7 +  If bExibirMeter
.head 8 -  Call SonMeter(1, 100, 1, '' )
.head 5 +  Function: GetCount
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaTabelas )
.head 8 -  Call SalArrayGetUpperBound( oaTabelas, 1, nMax )
.head 8 -  Return (nMax+1)
.head 7 -  Return 0
.head 5 +  Function: Delete
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nCodigoTabela
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call XSalUdvArrayDelete( oaTabelas, 1, nCodigoTabela )
.head 7 -  Call ReorgCodigo ()
.head 5 +  Function: isPK
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: spTabela
.head 7 -  String: spColuna
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nQtde
.head 6 +  Actions
.head 7 -  Set nQtde = GetCount ()
.head 7 -  !
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nQtde
.head 8 +  If SalStrTrimX( SalStrUpperX( oaTabelas[ nLinha ].sNOME ) )  = SalStrTrimX( SalStrUpperX( spTabela ))
.head 9 +  If oaTabelas[ nLinha ].isPK( spColuna )
.head 10 -  Return TRUE
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Return FALSE
.head 5 +  Function: ListPopulaTabelas
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWndLista
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 -  Set nMax = GetCount()
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nMax
.head 8 +  If oaTabelas[ nLinha ].sNOME != ''
.head 9 -  Call SalListAdd( hWndLista, SalStrLowerX( oaTabelas[ nLinha ].sNOME ) )
.head 8 -  Set nLinha = nLinha + 1
.head 5 +  Function: ReorgCodigo
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nQtde
.head 7 -  Number: nLinha
.head 6 +  Actions
.head 7 -  Set nQtde = GetCount ()
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nQtde
.head 8 -  Set oaTabelas[nLinha].nCodigo = nLinha
.head 8 -  Set nLinha = nLinha + 1
.head 5 +  Function: AtualizaBD
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  String: spBanco
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nQtdeTabelas
.head 7 -  Number: nLinhaTabela
.head 6 +  Actions
.head 7 -  Call SonMeter( 1, 0, 2, 'Atualizando banco de dados' )
.head 7 -  ! !!! Atualiza primeiro as tabelas do Banco
.head 7 -  Call SonMeter( 2, 0, 2, 'Atualizando tabelas' )
.head 7 -  Set nQtdeTabelas = GetCount ()
.head 7 -  Set nLinhaTabela = 0
.head 7 +  While nLinhaTabela < nQtdeTabelas
.head 8 -  Call SonMeter( 2, ( ( nLinhaTabela * 100 ) / nQtdeTabelas ), 2, 'Atualizando tabela ' || oaTabelas[nLinhaTabela].sNOME  )
.head 8 -  Call oaTabelas[nLinhaTabela].Atualiza( hSqlParam, spBanco )
.head 8 -  Set nLinhaTabela = nLinhaTabela + 1
.head 7 -  Call SonMeter( 2, 100, 2, '' )
.head 7 -  ! !!! Atualiza as constraints
.head 7 -  Call SonMeter( 2, 0, 2, 'Constrainsts' )
.head 7 -  Set nQtdeTabelas = GetCount ()
.head 7 -  Set nLinhaTabela = 0
.head 7 +  While nLinhaTabela < nQtdeTabelas
.head 8 -  Call SonMeter( 2, ( ( nLinhaTabela * 100 ) / nQtdeTabelas ), 2, 'Atualizando constraint da tabela ' || oaTabelas[nLinhaTabela].sNOME  )
.head 8 -  Call oaTabelas[nLinhaTabela].AtualizaConstraint(hSqlParam, spBanco)
.head 8 -  Set nLinhaTabela = nLinhaTabela + 1
.head 7 -  Call SonMeter( 2, 100, 2, '' )
.head 7 -  Call SonMeter( 1, 100, 1, '' )
.head 3 +  Functional Class: fcDBTabela
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcDBObjeto
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nTabela
.head 5 -  Number: nCodigo
.head 5 -  String: sNOME
.head 5 -  String: sMNEUMONICO
.head 5 -  Long String: lsDESCRICAO
.head 5 -  Number: nVERSAO
.head 5 -  Date/Time: dtMOVIMENTO
.head 5 -  !
.head 5 -  FunctionalVar: oaColunas[*]
.head 6 -  Class: fcDBColunas
.head 5 -  FunctionalVar: oaRelacao[*]
.head 6 -  Class: fcDBConstraint
.head 5 -  FunctionalVar: oaIndice[*]
.head 6 -  Class: fcDBIndice
.head 4 +  Functions
.head 5 +  Function: GetCountColunas
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaColunas )
.head 8 -  Call SalArrayGetUpperBound( oaColunas, 1, nMax )
.head 8 -  Return (nMax+1)
.head 7 -  Return 0
.head 5 +  Function: GetCountRelacao
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaRelacao )
.head 8 -  Call SalArrayGetUpperBound( oaRelacao, 1, nMax )
.head 8 -  Return (nMax+1)
.head 7 -  Return 0
.head 5 +  Function: ResetColunas
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( oaColunas, 1, -1 )
.head 5 +  Function: ResetRelacionamentos
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( oaRelacao, 1, -1 )
.head 5 +  Function: FindPK
.head 6 -  Description: Procura pelo nome da tabela e retorna o id do array da tabela que se deseja trabalhar
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaRelacao )
.head 8 -  Call SalArrayGetUpperBound( oaRelacao, 1, nMax )
.head 8 -  Set nLinha = 0
.head 8 +  While nLinha <= nMax
.head 9 +  If SalStrTrimX( SalStrUpperX( oaRelacao[nLinha].sTIPOCONSTRAINT ))  = 'PK'
.head 10 -  Return nLinha
.head 9 -  Set nLinha = nLinha + 1
.head 7 -  Return -1
.head 5 +  Function: isPK
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: spColuna
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nQtde
.head 6 +  Actions
.head 7 -  Set nQtde = GetCountRelacao ()
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nQtde
.head 8 +  If oaRelacao[ nLinha ].isPK( spColuna )
.head 9 -  Return TRUE
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Return FALSE
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNOME = STRING_Null
.head 7 -  Set sMNEUMONICO = STRING_Null
.head 7 -  Set lsDESCRICAO = STRING_Null
.head 7 -  Set nVERSAO = NUMBER_Null
.head 7 -  Set dtMOVIMENTO = DATETIME_Null
.head 7 -  Set bInitialized = FALSE
.head 7 -  !
.head 7 -  Call SalArraySetUpperBound( oaColunas, 1, -1)
.head 7 -  Return TRUE
.head 5 +  Function: Atualiza
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  String: spBanco
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTabela
.head 7 -  Number: nQtde
.head 7 -  Number: nLinha
.head 7 -  Long String: lsCreate
.head 7 -  FunctionalVar: oaColunaBD[*]
.head 8 -  Class: fcDBColunas
.head 6 +  Actions
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, "Select Count(*) Into :nQtde From information_schema.TABLES  T Where T.TABLE_SCHEMA = :spBanco And T.TABLE_NAME = :sNOME " )
.head 7 -  Call SqlFetchNext( hSqlParam, nFetch )
.head 7 +  If nQtde > 0 
.head 8 -  ! !!! Carrega colunas de banco
.head 8 -  Set nQtde = GetCountColunas ()
.head 8 -  Set nLinha = 0
.head 8 +  While nLinha < nQtde
.head 9 -  Call oaColunas[ nLinha ].Atualiza( hSqlParam, spBanco )
.head 9 -  Set nLinha = nLinha + 1
.head 7 +  Else
.head 8 -  Set lsCreate = GetCreate ()
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, lsCreate )
.head 5 +  Function: GetCreate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Long String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nQtde
.head 7 -  Number: nLinha
.head 7 -  String: sPK
.head 7 -  Long String: lsCreate
.head 6 +  Actions
.head 7 -  Set lsCreate = "Create table " || sNOME || "(
"
.head 7 -  Set nQtde = GetCountColunas ()
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nQtde
.head 8 -  Set lsCreate = lsCreate || oaColunas[nLinha].GetCreate(  ) || ",
"
.head 8 +  If oaColunas[nLinha].nPK = 1
.head 9 -  Set sPK = sPK || oaColunas[nLinha].sNOME || ", "
.head 8 -  Set nLinha = nLinha + 1
.head 7 +  If sPK != ''
.head 8 -  Set sPK = 'Primary Key ( ' || SalStrLeftX( sPK, (SalStrLength( sPK ) )-2) || ' ) '
.head 8 -  Set lsCreate = lsCreate || sPK || ",
"
.head 7 -  Set lsCreate = SalStrLeftX( lsCreate, (SalStrLength( lsCreate ) )-3) || '
);'
.head 7 -  Return lsCreate
.head 5 +  Function: GetCreateConstraint
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Long String:
.head 6 +  Parameters
.head 7 -  Number: npRelacao
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nQtde
.head 7 -  Number: nLinha
.head 7 -  Long String: lsCreate
.head 7 -  Long String: lsColuna
.head 7 -  Long String: lsColunaFK
.head 6 +  Actions
.head 7 -  Set nQtde = oaRelacao[npRelacao].GetCountColunas(  )
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nQtde
.head 8 -  Set lsColuna = lsColuna || oaRelacao[npRelacao].oaRelacaoDet[nLinha].sCOLUNA || ", "
.head 8 -  Set lsColunaFK = lsColunaFK || oaRelacao[npRelacao].oaRelacaoDet[nLinha].sCOLUNAFK || ", "
.head 8 -  !
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Set lsColuna = SalStrLeftX( lsColuna, (SalStrLength( lsColuna ) )-2) 
.head 7 -  Set lsColunaFK = SalStrLeftX( lsColunaFK, (SalStrLength( lsColunaFK ) )-2) 
.head 7 -  !
.head 7 -  Set lsCreate = "Alter table " || sNOME || " Add Constraint " || oaRelacao[npRelacao].sNOME || "
FOREIGN KEY (" || lsColuna || ") REFERENCES  " || oaRelacao[npRelacao].oaRelacaoDet[0].sTABELAFK || " ( "|| lsColunaFK || " )"
.head 7 -  Return lsCreate
.head 5 +  Function: FindColuna
.head 6 -  Description: Procura pelo nome da coluna e retorna o id do array da coluna que se deseja trabalhar
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sNomeParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaColunas )
.head 8 -  Call SalArrayGetUpperBound( oaColunas, 1, nMax )
.head 8 -  Set nLinha = 0
.head 8 +  While nLinha <= nMax
.head 9 +  If SalStrTrimX( SalStrLowerX( oaColunas[ nLinha ].sNOME ) ) = SalStrTrimX( SalStrLowerX( sNomeParam ) )
.head 10 -  Return nLinha
.head 9 -  Set nLinha = nLinha + 1
.head 7 -  Return -1
.head 5 +  Function: UpperColunas
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nQtde
.head 6 +  Actions
.head 7 -  Set nQtde = GetCountColunas ()
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nQtde
.head 8 -  Set oaColunas[ nLinha ].sNOME = SalStrUpperX( oaColunas[ nLinha ].sNOME )
.head 8 -  Set nLinha = nLinha + 1
.head 5 +  Function: LowerColunas
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nQtde
.head 6 +  Actions
.head 7 -  Set nQtde = GetCountColunas ()
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nQtde
.head 8 -  Set oaColunas[ nLinha ].sNOME = SalStrLowerX( oaColunas[ nLinha ].sNOME )
.head 8 -  Set nLinha = nLinha + 1
.head 5 +  Function: AtualizaConstraint
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  String: spBanco
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nQtdeConstraint
.head 7 -  Number: nLinhaConstraint
.head 7 -  String: sTabela
.head 7 -  Number: nQtde
.head 7 -  Number: nLinha
.head 7 -  Long String: lsCreate
.head 7 -  FunctionalVar: oaColunaBD[*]
.head 8 -  Class: fcDBColunas
.head 6 +  Actions
.head 7 -  Set nQtdeConstraint = GetCountRelacao ()
.head 7 -  Set nLinhaConstraint = 0
.head 7 +  While nLinhaConstraint < nQtdeConstraint
.head 8 +  If oaRelacao[ nLinhaConstraint ].sTIPOCONSTRAINT = 'FK'
.head 9 -  Call SqlPrepareAndExecute( hSqlParam, "Select Count(*) Into :nQtde FROM INFORMATION_SCHEMA.STATISTICS WHERE TABLE_SCHEMA = '" || spBanco || "' And INDEX_NAME = '" || oaRelacao[ nLinhaConstraint ].sNOME ||"' " )
.head 9 -  Call SqlFetchNext( hSqlParam, nFetch )
.head 9 +  If nQtde > 0 
.head 10 -  Call SqlPrepareAndExecute( hSqlParam, "Alter table dbvusuarioclube drop index " || oaRelacao[ nLinhaConstraint ].sNOME )
.head 9 -  Set lsCreate = GetCreateConstraint ( nLinhaConstraint )
.head 9 -  Call SqlPrepareAndExecute( hSqlParam, lsCreate )
.head 8 -  ! !!!  
.head 8 -  Set nLinhaConstraint = nLinhaConstraint + 1
.head 3 +  Functional Class: fcDBColunas
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcDBObjeto
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nCODIGO
.head 5 -  Number: nPK
.head 5 -  String: sTABELA
.head 5 -  String: sNOME
.head 5 -  Number: nTIPO
.head 5 -  String: sTIPO
.head 5 -  Number: nTAMANHO
.head 5 -  Number: nDECIMAL
.head 5 -  Number: nNULO
.head 4 +  Functions
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTABELA = STRING_Null
.head 7 -  Set sNOME = STRING_Null
.head 7 -  Set bInitialized = FALSE
.head 7 -  Set nCODIGO = NUMBER_Null
.head 7 -  Set nPK = NUMBER_Null
.head 7 -  Set sTIPO = STRING_Null
.head 7 -  Set nTAMANHO = NUMBER_Null
.head 7 -  Set nDECIMAL = NUMBER_Null
.head 7 -  Set nNULO = NUMBER_Null
.head 7 -  Return TRUE
.head 5 +  Function: Clone
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: oOrigem_p
.head 8 -  Class: fcDBColunas
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTABELA = oOrigem_p.sTABELA
.head 7 -  Set sNOME = oOrigem_p.sNOME
.head 7 -  Set nCODIGO = oOrigem_p.nCODIGO
.head 7 -  Set nPK = oOrigem_p.nPK
.head 7 -  Set sTIPO = oOrigem_p.sTIPO
.head 7 -  Set nTAMANHO = oOrigem_p.nTAMANHO
.head 7 -  Set nDECIMAL = oOrigem_p.nDECIMAL
.head 7 -  Set nNULO = oOrigem_p.nNULO
.head 7 -  Set bInitialized = FALSE
.head 5 +  Function: GetCreate
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sCAMPO
.head 6 +  Actions
.head 7 +  If sTIPO = '2 - Integer'
.head 8 -  Set sCAMPO = sNOME || ' int'
.head 7 +  If sTIPO = '3 - Decimal'
.head 8 -  Set sCAMPO = sNOME || ' decimal(' || SalNumberToStrX( nTAMANHO, 0) || ',' ||SalNumberToStrX( nDECIMAL, 0) || ')'
.head 7 +  If sTIPO = '4 - Date/Time'
.head 8 -  Set sCAMPO = sNOME || ' datetime'
.head 7 +  If sTIPO = '6 - Varchar2'
.head 8 -  Set sCAMPO = sNOME || ' varchar(' || SalNumberToStrX( nTAMANHO, 0) || ')'
.head 7 +  If sTIPO = '11 - Autoincrement'
.head 8 -  Set sCAMPO = sNOME || ' int auto_increment'
.head 7 +  If nNULO != 1
.head 8 -  Set sCAMPO = sCAMPO || ' not null'
.head 7 -  Return sCAMPO
.head 5 +  Function: Atualiza
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  String: spBanco
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sNomeBD
.head 7 -  String: sTipoBD
.head 7 -  Number: nTamanhoBD
.head 7 -  Number: nDecimalBD
.head 7 -  Number: nNuloBD
.head 6 +  Actions
.head 7 -  Call SqlPrepareAndExecute( hSqlParam, "Select C.COLUMN_NAME, 
Case C.DATA_TYPE 
     when 'int' then (Case C.EXTRA When 'auto_increment' Then '11 - Autoincrement' Else '2 - Integer' End )  
     when 'date' then '4 - Date/Time'
     when 'datetime' then '4 - Date/Time'
     when 'varchar' then '6 - Varchar2'
     when 'decimal' then '3 - Decimal'
 Else 'NI' End TIPO,  
Case C.DATA_TYPE 
     when 'varchar' then C.CHARACTER_MAXIMUM_LENGTH
     when 'decimal' then C.NUMERIC_PRECISION
 Else 0 End TAMANHO,
C.NUMERIC_SCALE ESCALA, 
case C.IS_NULLABLE when 'YES' then 1 else 0 end NULO
Into :sNomeBD, :sTipoBD, :nTamanhoBD, :nDecimalBD, :nNuloBD
 From information_schema.COLUMNS C 
Where C.TABLE_SCHEMA = :spBanco 
And C.TABLE_NAME = :sTABELA
And C.COLUMN_NAME = :sNOME
Order by ORDINAL_POSITION" )
.head 7 -  Call SqlFetchNext( hSqlParam, nFetch )
.head 7 +  If SalStrTrimX( sNomeBD ) = ''
.head 8 -  Call SqlPrepareAndExecute( hSqlParam, "Alter Table " || sTABELA || " Add " || GetCreate ()  )
.head 7 +  Else
.head 8 +  If sTIPO != sTipoBD
.head 9 -  Call SqlPrepareAndExecute( hSqlParam, "Alter Table " || sTABELA || " Add " || GetCreateOld ()  )
.head 9 -  Call SqlPrepareAndExecute( hSqlParam, "Update " || sTABELA || " Set " || sNOME || "_dc = " || sNOME )
.head 9 -  Call SqlPrepareAndExecute( hSqlParam, "Alter Table " || sTABELA || " Drop Column " || sNOME  )
.head 9 -  Call SqlPrepareAndExecute( hSqlParam, "Alter Table " || sTABELA || " Add " || GetCreate ()  )
.head 9 +  If sTipoBD = '2 - Integer'
.head 10 +  If sTIPO = '6 - Varchar2'
.head 11 -  Call SqlPrepareAndExecute( hSqlParam, "Update " || sTABELA || " Set " || sNOME || " = CONVERT( " || sNOME || "_dc , char) " )
.head 10 +  If sTIPO = '3 - Decimal'
.head 11 -  Call SqlPrepareAndExecute( hSqlParam, "Update " || sTABELA || " Set " || sNOME || " = CONVERT( " || sNOME || "_dc , decimal) " )
.head 9 +  If sTipoBD = '3 - Decimal'
.head 10 +  If sTIPO = '6 - Varchar2'
.head 11 -  Call SqlPrepareAndExecute( hSqlParam, "Update " || sTABELA || " Set " || sNOME || " = CONVERT( " || sNOME || "_dc , char) " )
.head 8 +  Else
.head 9 +  If nTAMANHO != nTamanhoBD or nDECIMAL != nDecimalBD or nNULO != nNuloBD
.head 10 -  Call SqlPrepareAndExecute( hSqlParam, "Alter Table " || sTABELA || " Modify Column " || GetCreate ()  )
.head 7 -  Return TRUE
.head 5 +  Function: GetCreateOld
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sCAMPO
.head 6 +  Actions
.head 7 +  If sTIPO = '2 - Integer'
.head 8 -  Set sCAMPO = sNOME || '_dc int'
.head 7 +  If sTIPO = '3 - Decimal'
.head 8 -  Set sCAMPO = sNOME || '_dc decimal(' || SalNumberToStrX( nTAMANHO, 0) || ',' ||SalNumberToStrX( nDECIMAL, 0) || ')'
.head 7 +  If sTIPO = '4 - Date/Time'
.head 8 -  Set sCAMPO = sNOME || '_dc datetime'
.head 7 +  If sTIPO = '6 - Varchar2'
.head 8 -  Set sCAMPO = sNOME || '_dc varchar(' || SalNumberToStrX( nTAMANHO, 0) || ')'
.head 7 +  If sTIPO = '11 - Autoincrement'
.head 8 -  Set sCAMPO = sNOME || '_dc int auto_increment'
.head 7 +  If nNULO != 1
.head 8 -  Set sCAMPO = sCAMPO || '_dc not null'
.head 7 -  Return sCAMPO
.head 3 +  Functional Class: fcDBObjeto
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Boolean: bInitialized
.head 5 -  Number: nRetorno
.head 5 -  String: sRetorno
.head 4 +  Functions
.head 5 +  Function: Insert
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ..Insert( hSqlParam )
.head 5 +  Function: Delete
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ..Delete( hSqlParam )
.head 5 +  Function: Update
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ..Update( hSqlParam )
.head 5 +  Function: ExecutaComandoDB
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSqlParam
.head 7 -  Number: nOperacao
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  Select Case nOperacao
.head 8 +  Case DB_Insert
.head 9 +  If Not Insert( hSqlParam )
.head 10 -  Return FALSE
.head 9 -  Return TRUE
.head 9 -  Break
.head 8 +  Case DB_Delete
.head 9 +  If Not Delete( hSqlParam )
.head 10 -  Return FALSE
.head 9 -  Return TRUE
.head 9 -  Break
.head 8 +  Case DB_Update
.head 9 +  If Not Update( hSqlParam )
.head 10 -  Return FALSE
.head 9 -  Return TRUE
.head 9 -  Break
.head 8 +  Default
.head 9 -  Return FALSE
.head 9 -  Break
.head 5 +  Function: GetClassName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ..GetClassName( )
.head 3 +  Functional Class: fcDBConstraint
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcDBObjeto
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sNOME
.head 5 -  String: sTABELA
.head 5 -  String: sTIPOCONSTRAINT
.head 5 -  FunctionalVar: oaRelacaoDet[*]
.head 6 -  Class: fcDBConstraintDet
.head 4 +  Functions
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNOME = STRING_Null
.head 7 -  Set sTABELA = STRING_Null
.head 7 -  Set sTIPOCONSTRAINT = STRING_Null
.head 7 -  Set bInitialized = FALSE
.head 7 -  Return TRUE
.head 5 +  Function: Clone
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: oOrigem_p
.head 8 -  Class: fcDBConstraint
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNOME = oOrigem_p.sNOME
.head 7 -  Set sTABELA = oOrigem_p.sTABELA
.head 7 -  Set sTIPOCONSTRAINT = oOrigem_p.sTIPOCONSTRAINT
.head 7 -  Set bInitialized = FALSE
.head 5 +  Function: GetCountColunas
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaRelacaoDet )
.head 8 -  Call SalArrayGetUpperBound( oaRelacaoDet, 1, nMax )
.head 8 -  Return (nMax+1)
.head 7 -  Return 0
.head 5 +  Function: isPK
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: spColuna
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nQtde
.head 6 +  Actions
.head 7 +  If SalStrTrimX( SalStrUpperX( sTIPOCONSTRAINT ))  = 'PK'
.head 8 -  Set nLinha = 0
.head 8 -  Set nQtde = GetCountColunas ()
.head 8 +  While nLinha < nQtde
.head 9 +  If SalStrUpperX( oaRelacaoDet[ nLinha ].sCOLUNA ) = SalStrUpperX( spColuna )
.head 10 -  Return TRUE
.head 9 -  Set nLinha = nLinha + 1
.head 7 -  Return FALSE
.head 3 +  Functional Class: fcDBConstraintDet
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcDBObjeto
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sNOME
.head 5 -  String: sCOLUNA
.head 5 -  String: sTABELAFK
.head 5 -  String: sCOLUNAFK
.head 4 +  Functions
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNOME = STRING_Null
.head 7 -  Set sCOLUNA = STRING_Null
.head 7 -  Set sTABELAFK = STRING_Null
.head 7 -  Set sCOLUNAFK = STRING_Null
.head 7 -  Set bInitialized = FALSE
.head 7 -  Return TRUE
.head 5 +  Function: Clone
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: oOrigem_p
.head 8 -  Class: fcDBConstraintDet
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNOME = oOrigem_p.sNOME
.head 7 -  Set sCOLUNA = oOrigem_p.sCOLUNA
.head 7 -  Set sTABELAFK = oOrigem_p.sTABELAFK
.head 7 -  Set sCOLUNAFK = oOrigem_p.sCOLUNAFK
.head 7 -  Set bInitialized = FALSE
.head 3 +  Functional Class: fcDBIndice
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nIndice
.head 5 -  String: sNome
.head 5 -  Boolean: bUnico
.head 5 -  FunctionalVar: oaColunas[*]
.head 6 -  Class: fcDBIndiceColuna
.head 4 +  Functions
.head 5 +  Function: GetCountCol
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 -  Call SalArrayGetUpperBound( oaColunas, 1, nMax )
.head 7 +  If nMax = 0
.head 8 +  If oaColunas[ nMax ].nSequencial = 0
.head 9 -  Return 0
.head 7 -  Return nMax + 1
.head 5 +  Function: ResetCol
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( oaColunas, 1, -1 )
.head 5 +  Function: GetProximoCol
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return GetCountCol( )
.head 5 +  Function: Find
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nColunaParam
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 -  Set nMax = GetCountCol( )
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nMax
.head 8 +  If oaColunas[ nLinha ].nColuna = nColunaParam
.head 9 -  Return nLinha
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Return -1
.head 3 +  Functional Class: fcDBIndiceColuna
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nColuna
.head 5 -  Number: nSequencial
.head 5 -  ! Ordem:  0 - ascendente, 1 - descendente
.head 5 -  Number: nOrdem
.head 4 -  Functions
.head 3 +  General Window Class: pcVisualBaseComponent
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sNomeJanela
.head 5 -  Window Handle: hWndJanela
.head 4 +  Functions
.head 5 +  Function: HideWindow
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalHideWindow( hWndJanela )
.head 5 +  Function: ShowWindow
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalShowWindow( hWndJanela )
.head 5 +  Function: CriaJanela
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nX
.head 7 -  Number: nY
.head 7 -  Number: nTamanho
.head 7 -  Number: nAltura
.head 6 +  Actions
.head 7 -  Set hWndJanela = SalCreateWindowEx( sNomeJanela, SalParentWindow( hWndItem ), 0,0,0,0, CREATE_AsChild )
.head 7 -  Call SalGetWindowLoc( hWndItem, nX, nY )
.head 7 -  Call SalGetWindowSize( hWndItem, nTamanho, nAltura )
.head 7 -  Call SalSetWindowLoc( hWndJanela, nX, nY )
.head 7 -  Call SalSetWindowSize( hWndJanela, nTamanho, nAltura )
.head 4 +  Message Actions
.head 5 +  On PAM_Command
.head 6 -  !
.head 6 -  ! Hide / Show Window
.head 6 +  If wParam = 1
.head 7 +  If lParam = 1
.head 8 -  Call ShowWindow( )
.head 7 +  Else If lParam = 2
.head 8 -  Call HideWindow( )
.head 5 +  On SAM_Create
.head 6 -  Call SalHideWindow( hWndItem )
.head 6 -  Set sNomeJanela = 'frm' || SalStrMidX( SalWindowClassName( hWndItem ), 2, 1024 )
.head 6 -  Call CriaJanela( )
.head 6 -  Call SalSendMsg( hWndItem, SAM_CreateComplete, 0, 0 )
.head 3 +  Child Table Class: pcChildTable
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 50000
.head 5 -  Discardable? No
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 5 -  Class: pcMouseWheel
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nCol
.head 5 -  Boolean: bCresente
.head 5 -  ! Boolean: bColorirDesabilitadas
.head 4 +  Functions
.head 5 +  Function: TblSortDecreasing
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndTbl
.head 7 -  Number: nCol
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bRet
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set bRet = SalTblSortRows( hWndTbl, nCol, TBL_SortDecreasing )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return bRet
.head 5 +  Function: TblSortIncreasing
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndTbl
.head 7 -  Number: nCol
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bRet
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set bRet = SalTblSortRows( hWndTbl, nCol, TBL_SortIncreasing )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return bRet
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblReset( hWndItem )
.head 5 +  Function: InsertRow
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nL
.head 6 +  Actions
.head 7 -  Set nL = SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndItem,  ROW_New, FALSE, 0, 0 )
.head 7 -  Return nL
.head 5 +  Function: Exclui
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nLinha < 0
.head 8 -  Set nLinha = SalTblQueryContext( hWndItem )
.head 7 -  Call SalTblDeleteRow(hWndItem, nLinha, 0 )
.head 5 +  Function: ExcluiMarcado
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nL
.head 6 +  Actions
.head 7 -  Set nL = 0
.head 7 +  While SalTblSetContext(hWndItem, nL )
.head 8 +  If SalTblQueryRowFlags( hWndItem, nL , ROW_MarkDeleted)
.head 9 -  Call SalTblDeleteRow(hWndItem, nL, 0)
.head 9 -  Set nL = nL - 1
.head 8 -  Set nL = nL + 1
.head 5 +  Function: CountRow
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nConta
.head 7 -  Number: nLinhaContexto
.head 6 +  Actions
.head 7 -  Set nLinhaContexto = SalTblQueryContext( hWndItem )
.head 7 -  Set nConta = 0
.head 7 +  While SalTblSetContext( hWndItem, nConta )
.head 8 -  Set nConta = nConta + 1
.head 7 -  Call SalTblSetContext( hWndItem, nLinhaContexto )
.head 7 -  Return nConta
.head 5 +  Function: SetContext
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalTblSetContext( hWndItem, nL )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: ExportaCSV_Antigo
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeArquivoCSV
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 6 +  Actions
.head 7 -  !
.head 7 -  ! Abre arquivo CSV
.head 7 -  !
.head 7 +  If SalStrScan( SalStrUpperX( sNomeArquivoCSV) , '.CSV' ) < 0
.head 8 -  Set sNomeArquivoCSV =  sNomeArquivoCSV || '.csv'
.head 7 -  Call VisDosSplitPath( sNomeArquivoCSV, sDrive, sDiretorio, sBase, sExt )
.head 7 +  If not VisDosExist( sDrive || sDiretorio )
.head 8 -  Set sNomeArquivoCSV = sBase || sExt
.head 8 -  Call VisDosSplitPath( strArgArray[0], sDrive, sDiretorio, sBase, sExt )
.head 8 -  Set sNomeArquivoCSV = sDrive || sDiretorio || sNomeArquivoCSV
.head 7 +  If SalFileOpen( fhArquivoCSV, sNomeArquivoCSV, OF_Create | OF_ReadWrite )
.head 8 -  !
.head 8 -  ! Obtém os títulos de todas as colunas da tabela e grava no arquivo.
.head 8 -  !
.head 8 -  Set nPosColuna = 1
.head 8 -  Set sLinha = STRING_Null
.head 8 +  Loop
.head 9 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 9 +  If hWndCol = hWndNULL
.head 10 -  Set nTotalColunas = nPosColuna -1
.head 10 -  Break
.head 9 +  Else
.head 10 -  Call SalTblGetColumnTitle( hWndCol, sColuna, 100 )
.head 10 -  Set sLinha = sLinha || '"' || SalStrTrimX( sColuna ) || '"' || ';'
.head 10 -  Set nPosColuna = nPosColuna + 1
.head 8 +  If SalStrLength( sLinha ) > 0
.head 9 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 9 -  Call SalFilePutStr( fhArquivoCSV, sLinha )
.head 8 -  !
.head 8 -  ! Percorre a tabela e salva os valores da colunas no arquivo
.head 8 -  !
.head 8 -  Set nLinha = 0
.head 8 +  While SalTblSetContext( hWndItem, nLinha )
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nPosColuna =1
.head 9 +  While nPosColuna <= nTotalColunas
.head 10 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 10 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 10 +  If SalStrScan( sColuna,  ';' ) >= 0
.head 11 +  While SalStrScan( sColuna, ';' ) > 0
.head 12 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 10 +  If SalStrScan( sColuna,  SalNumberToChar ( 13 ) ) >= 0
.head 11 +  While SalStrScan( sColuna, SalNumberToChar ( 13 )  ) > 0
.head 12 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 13 )  ), 1, ' ' )
.head 10 +  If SalStrScan( sColuna,  SalNumberToChar ( 10 ) ) >= 0
.head 11 +  While SalStrScan( sColuna, SalNumberToChar ( 10 )  ) > 0
.head 12 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 10 )  ), 1, ' ' )
.head 10 +  If not SalStrIsValidNumber( sColuna )
.head 11 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 10 +  Else
.head 11 -  Set sLinha = sLinha || sColuna || ';'
.head 10 -  Set nPosColuna = nPosColuna + 1
.head 9 +  If SalStrLength( sLinha ) > 0
.head 10 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 10 -  Call SalFilePutStr( fhArquivoCSV, sLinha )
.head 9 -  Set nLinha = nLinha + 1
.head 8 -  Call SalFileClose( fhArquivoCSV )
.head 5 +  Function: ExportaCSV
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 7 -  !
.head 7 -  String: saColunas[*]
.head 7 -  Number: nIndex
.head 7 -  String: sCaminho
.head 7 -  String: sTexto
.head 7 -  Number: nQtdeLinhas
.head 6 +  Actions
.head 7 -  Set nQtdeLinhas = CountRow () + 0
.head 7 +  If nQtdeLinhas = 0
.head 8 -  Call SalMessageBox( 'Não existe dados para serem exportados.', 'Atenção', MB_Ok )
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set saColunas[0] = 'Arquivo Excel( Extensão CSV )'
.head 7 -  Set saColunas[1] = '*.csv'
.head 7 -  Set nIndex = 0
.head 7 +  If SalDlgSaveFile( hWndForm, 'Salvar como', saColunas, 2, nIndex, spNomeArquivo, sCaminho )
.head 8 +  If VisDosExist( sCaminho )
.head 9 +  If VisFileDelete( sCaminho ) < 0
.head 10 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 10 -  Return 0
.head 8 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) = VTERR_Ok
.head 9 -  !
.head 9 -  Set nPosColuna = 1
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nTotalColunas = 0
.head 9 +  Loop
.head 10 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 10 +  If hWndCol = hWndNULL
.head 11 -  Set nTotalColunas = nPosColuna - 1
.head 11 -  Break
.head 10 -  !
.head 10 -  Call SalTblGetColumnTitle( hWndCol, sColuna, 100 )
.head 10 -  Set sLinha = sLinha || '"' || SalStrTrimX( sColuna ) || '"' || ';'
.head 10 -  !
.head 10 -  Set nPosColuna = nPosColuna + 1
.head 9 +  If SalStrLength( sLinha ) > 0
.head 10 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 10 -  Call VisFileWriteString( fhArquivoCSV, sLinha )
.head 9 -  !
.head 9 -  !
.head 9 -  Set nLinha = 0
.head 9 -  Call SonMeter( 1, 0, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 +  While SalTblSetContext( hWndItem, nLinha )
.head 10 -  Set sLinha = STRING_Null
.head 10 -  Set nPosColuna = 1
.head 10 +  While nPosColuna <= nTotalColunas
.head 11 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 11 -  !
.head 11 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 11 -  !
.head 11 +  If SalStrScan( sColuna,  ';' ) >= 0
.head 12 +  While SalStrScan( sColuna, ';' ) > 0
.head 13 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 11 +  If SalStrScan( sColuna,  SalNumberToChar ( 13 ) ) >= 0
.head 12 +  While SalStrScan( sColuna, SalNumberToChar ( 13 )  ) >= 0
.head 13 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 13 )  ), 1, ' ' )
.head 11 +  If SalStrScan( sColuna,  SalNumberToChar ( 10 ) ) >= 0
.head 12 +  While SalStrScan( sColuna, SalNumberToChar ( 10 )  ) >= 0
.head 13 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 10 )  ), 1, ' ' )
.head 11 +  If not SalStrIsValidNumber( sColuna )
.head 12 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 11 +  Else
.head 12 -  Set sLinha = sLinha || sColuna || ';'
.head 11 -  !
.head 11 -  Set nPosColuna = nPosColuna + 1
.head 10 -  !
.head 10 -  Call SonMeter( 1, nLinha * 100 / nQtdeLinhas, 1, 'Gerando arquivo CSV em ' || sCaminho )
.head 10 -  !
.head 10 +  If SalStrLength( sLinha ) > 0
.head 11 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 11 -  Call VisFileWriteString( fhArquivoCSV, sLinha )
.head 10 -  Set nLinha = nLinha + 1
.head 9 -  Call SonMeter( 1, 100, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 -  !
.head 9 -  Call VisFileClose( fhArquivoCSV )
.head 9 +  If VisDosExist( sCaminho )
.head 10 -  Call SalMessageBox( 'Exportação CSV finalizada com sucesso.', 'Arquivo gerado', MB_IconAsterisk )
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Arquivo não encontrado. Problema ao gravar o arquivo em disco.', 'Erro na exportação', MB_IconStop)
.head 10 -  Return FALSE
.head 5 +  Function: ExportaCSV_ColunaVisiveis
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 7 -  !
.head 7 -  String: saColunas[*]
.head 7 -  Number: nIndex
.head 7 -  String: sCaminho
.head 7 -  String: sTexto
.head 7 -  Number: nQtdeLinhas
.head 6 +  Actions
.head 7 -  Set nQtdeLinhas = CountRow () + 0
.head 7 +  If nQtdeLinhas = 0
.head 8 -  Call SalMessageBox( 'Não existe dados para serem exportados.', 'Atenção', MB_Ok )
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set saColunas[0] = 'Arquivo Excel( Extensão CSV )'
.head 7 -  Set saColunas[1] = '*.csv'
.head 7 -  Set nIndex = 0
.head 7 +  If SalDlgSaveFile( hWndForm, 'Salvar como', saColunas, 2, nIndex, spNomeArquivo, sCaminho )
.head 8 +  If VisDosExist( sCaminho )
.head 9 +  If VisFileDelete( sCaminho ) < 0
.head 10 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 10 -  Return 0
.head 8 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) = VTERR_Ok
.head 9 -  !
.head 9 -  Set nPosColuna = 1
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nTotalColunas = 0
.head 9 +  Loop
.head 10 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 10 +  If hWndCol = hWndNULL
.head 11 -  Set nTotalColunas = nPosColuna - 1
.head 11 -  Break
.head 10 -  !
.head 10 +  If SalIsWindowVisible( hWndCol ) > 0
.head 11 -  Call SalTblGetColumnTitle( hWndCol, sColuna, 100 )
.head 11 -  Set sLinha = sLinha || '"' || SalStrTrimX( sColuna ) || '"' || ';'
.head 10 -  !
.head 10 -  Set nPosColuna = nPosColuna + 1
.head 9 +  If SalStrLength( sLinha ) > 0
.head 10 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 10 -  Call VisFileWriteString( fhArquivoCSV, sLinha )
.head 9 -  !
.head 9 -  !
.head 9 -  Set nLinha = 0
.head 9 -  Call SonMeter( 1, 0, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 +  While SalTblSetContext( hWndItem, nLinha )
.head 10 -  Set sLinha = STRING_Null
.head 10 -  Set nPosColuna = 1
.head 10 +  While nPosColuna <= nTotalColunas
.head 11 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 11 -  !
.head 11 +  If SalIsWindowVisible( hWndCol ) > 0
.head 12 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 12 -  !
.head 12 +  If SalStrScan( sColuna,  ';' ) >= 0
.head 13 +  While SalStrScan( sColuna, ';' ) > 0
.head 14 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 12 +  If SalStrScan( sColuna,  SalNumberToChar ( 13 ) ) >= 0
.head 13 +  While SalStrScan( sColuna, SalNumberToChar ( 13 )  ) >= 0
.head 14 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 13 )  ), 1, ' ' )
.head 12 +  If SalStrScan( sColuna,  SalNumberToChar ( 10 ) ) >= 0
.head 13 +  While SalStrScan( sColuna, SalNumberToChar ( 10 )  ) >= 0
.head 14 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 10 )  ), 1, ' ' )
.head 12 +  If not SalStrIsValidNumber( sColuna )
.head 13 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 12 +  Else
.head 13 -  Set sLinha = sLinha || sColuna || ';'
.head 11 -  !
.head 11 -  Set nPosColuna = nPosColuna + 1
.head 10 -  !
.head 10 -  Call SonMeter( 1, nLinha * 100 / nQtdeLinhas, 1, 'Gerando arquivo CSV em ' || sCaminho )
.head 10 -  !
.head 10 +  If SalStrLength( sLinha ) > 0
.head 11 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 11 -  Call VisFileWriteString( fhArquivoCSV, sLinha )
.head 10 -  Set nLinha = nLinha + 1
.head 9 -  Call SonMeter( 1, 100, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 -  !
.head 9 -  Call VisFileClose( fhArquivoCSV )
.head 9 +  If VisDosExist( sCaminho )
.head 10 -  Call SalMessageBox( 'Exportação CSV finalizada com sucesso.', 'Arquivo gerado', MB_IconAsterisk )
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Arquivo não encontrado. Problema ao gravar o arquivo em disco.', 'Erro na exportação', MB_IconStop)
.head 10 -  Return FALSE
.head 5 +  Function: HideAllColumns
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 6 +  Actions
.head 7 -  Set nPosColuna = 1
.head 7 +  Loop
.head 8 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 8 +  If hWndCol = hWndNULL
.head 9 -  Break
.head 8 -  !
.head 8 -  Call SalHideWindow( hWndCol )
.head 8 -  !
.head 8 -  Set nPosColuna = nPosColuna + 1
.head 5 +  ! Function: ColoreDesabilitadas
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hWndColuna
.head 7 -  Number: nColuna
.head 6 +  Actions
.head 7 -  Set nColuna = 1
.head 7 -  Set hWndColuna = SalTblGetColumnWindow( hWndItem, nColuna, COL_GetPos )
.head 7 +  While hWndColuna != hWndNULL
.head 8 +  If not SalTblQueryColumnFlags( hWndColuna, COL_Editable )
.head 9 -  Call XSalTblSetColumnBackColor( hWndColuna, SalColorFromRGB( 240, 240, 240 ) )
.head 8 -  Set nColuna = nColuna + 1
.head 8 -  Set hWndColuna = SalTblGetColumnWindow( hWndItem, nColuna, COL_GetPos )
.head 4 +  Message Actions
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Set nCol = 1
.head 6 +  While SalTblGetColumnWindow( hWndItem, nCol, COL_GetID )
.head 7 +  If SalTblQueryColumnFlags( SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ), COL_Selected )
.head 8 -  Break
.head 7 -  Set nCol = nCol + 1
.head 6 +  If not bCresente
.head 7 -  Call TblSortIncreasing( hWndItem, nCol )
.head 7 -  Set bCresente = TRUE
.head 6 +  Else
.head 7 -  Call TblSortDecreasing( hWndItem, nCol )
.head 7 -  Set bCresente = FALSE
.head 6 -  Call SalTblSetColumnFlags( SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ), COL_Selected, FALSE )
.head 5 +  ! On PAM_Reset
.head 6 -  Call SalSendClassMessage( PAM_Reset, wParam, lParam )
.head 6 +  If not bNaoColorirDesabilitadas
.head 7 -  Call ColoreDesabilitadas( )
.head 5 +  On PAM_NewRecord
.head 6 -  Call SalSendClassMessage( PAM_NewRecord, wParam, lParam )
.head 6 +  ! If bColorirDesabilitadas
.head 7 -  Call ColoreDesabilitadas( )
.head 5 +  On PAM_RecordExist
.head 6 -  Call SalSendClassMessage( PAM_RecordExist, wParam, lParam )
.head 6 +  ! If bColorirDesabilitadas
.head 7 -  Call ColoreDesabilitadas( )
.head 3 +  Child Table Class: pcChildTableKey
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcChildTable
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On PAM_Reset
.head 6 -  Call SalSendClassMessage( PAM_Reset, wParam, lParam )
.head 6 -  Call SalEnableWindow( hWndItem )
.head 5 +  On PAM_NewRecord
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  On PAM_RecordExist
.head 6 -  Call SalDisableWindow( hWndItem )
.head 3 +  Child Table Class: pcChildTableSemLinha
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000000
.head 5 -  Discardable? No
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,N,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcMouseWheel
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nCol
.head 5 -  Boolean: bCresente
.head 5 -  Boolean: bColorirDesabilitadas
.head 5 -  !
.head 5 -  Boolean: bMultiSelect
.head 5 -  Number: nLinhasSelecionadas[*]
.head 5 -  Number: nQtdeLinhasSelecionadas
.head 5 -  Window Handle: hWndField
.head 5 -  Window Handle: hWndColSearch
.head 5 -  Number: nLastLen
.head 5 -  Number: nLen
.head 5 -  Number: nRow
.head 5 -  Number: nRows
.head 5 -  Number: nStart
.head 5 -  Number: nEnd
.head 5 -  String: sTag
.head 5 -  String: sText
.head 4 +  Functions
.head 5 +  Function: SalStrGetSize
.head 6 -  Description: desc:
Returns the width and height of a string in pixels (depends on the font of the control)

parameter:
Window Handle: phWnd	! the control
String: psStr  		! the string
Receive Number: pnX  	! the width
Receive Number: pnY  	! the height

.head 6 -  Returns
.head 6 +  Parameters
.head 7 +  Window Handle: phWnd
.head 8 -  ! the control
.head 7 +  String: psStr
.head 8 -  ! the string
.head 7 +  Receive Number: pnX
.head 8 -  ! the width
.head 7 +  Receive Number: pnY
.head 8 -  ! the height
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call GetTextExtentPoint32A( GetDC( phWnd ), psStr, SalStrGetBufferLength( psStr ), pnX, pnY )
.head 5 +  Function: GetInvisibleText
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd
.head 7 -  Number: nRow
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nX
.head 7 -  Number: nY
.head 7 -  String: strText
.head 6 +  Actions
.head 7 -  Set strText = VisTblGetCell ( hWndItem, nRow, hWnd )
.head 7 -  Call SalStrGetSize( hWnd, strText, nX, nY )
.head 7 -  Call SalTblQueryColumnWidth ( hWnd, nY )
.head 7 -  Set nY = SalFormUnitsToPixels( hWnd, nY, FALSE )
.head 7 -  Return nX > nY
.head 5 -  !
.head 5 +  Function: Insere
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nL
.head 6 +  Actions
.head 7 -  Set nL =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nL, ROW_New, FALSE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nL
.head 5 +  Function: InsertRow
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nL
.head 6 +  Actions
.head 7 -  Set nL = SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nL, ROW_New, FALSE )
.head 7 -  Return nL
.head 5 +  Function: InsereSel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_New, FALSE )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_UserFlag1, TRUE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nRow
.head 5 +  Function: InsereDoc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_New, FALSE )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_UserFlag2, TRUE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nRow
.head 5 +  Function: InsereDocV
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_New, FALSE )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_UserFlag3, TRUE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nRow
.head 5 -  !
.head 5 +  Function: TblSortDecreasing
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nColPar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bRet
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set bRet = SalTblSortRows( hWndItem, nColPar, TBL_SortDecreasing )
.head 7 -  Set nCol = nColPar
.head 7 -  Call InitSearch( CountRow(  ), SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ) )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return bRet
.head 5 +  Function: TblSortIncreasing
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nColPar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bRet
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set bRet = SalTblSortRows( hWndItem, nColPar, TBL_SortIncreasing )
.head 7 -  Set nCol = nColPar
.head 7 -  Call InitSearch( CountRow(  ), SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ) )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return bRet
.head 5 -  !
.head 5 +  Function: ExcluiMarcado
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nL
.head 6 +  Actions
.head 7 -  Set nL = 0
.head 7 +  While SalTblSetContext(hWndItem, nL )
.head 8 +  If SalTblQueryRowFlags( hWndItem, nL , ROW_MarkDeleted)
.head 9 -  Call SalTblDeleteRow(hWndItem, nL, 0)
.head 9 -  Set nL = nL - 1
.head 8 -  Set nL = nL + 1
.head 5 +  Function: DeleteRow
.head 6 -  Description: Deleta Todas Linhas marcadas
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 7 -  Boolean: bDeletou
.head 6 +  Actions
.head 7 -  Set bDeletou = FALSE
.head 7 -  Set nIndice = 0
.head 7 +  While SalTblSetContext( hWndItem, nIndice )
.head 8 +  If SalTblQueryRowFlags( hWndItem, nIndice, ROW_MarkDeleted )
.head 9 -  Call SalTblDeleteRow( hWndItem, nIndice, TBL_NoAdjust )
.head 9 -  Set nIndice = nIndice - 1
.head 9 -  Set bDeletou = TRUE
.head 8 -  Set nIndice = nIndice + 1
.head 7 -  Return bDeletou
.head 5 +  Function: Exclui
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nL < 0
.head 8 -  Set nL = SalTblQueryContext( hWndItem )
.head 7 -  Call SalTblDeleteRow(hWndItem, nL, TBL_NoAdjust )
.head 5 -  !
.head 5 +  Function: DesmarcaTodas
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblSetFlagsAnyRows( hWndItem, ROW_MarkDeleted, FALSE, 0, 0 )
.head 7 -  Call SalArraySetUpperBound( nLinhasSelecionadas, 1, -1 )
.head 7 -  Set nQtdeLinhasSelecionadas = 0
.head 5 +  Function: MarcaTodas
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nTotalLinhas
.head 6 +  Actions
.head 7 -  Call SalTblSetFlagsAnyRows( hWndItem, ROW_MarkDeleted, TRUE, 0, 0 )
.head 7 -  Call SalArraySetUpperBound( nLinhasSelecionadas, 1, -1 )
.head 7 -  Set nTotalLinhas = SalTblCountRow( hWndItem )
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nTotalLinhas
.head 8 -  Set nLinhasSelecionadas[ nLinha ] = nLinha
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Set nQtdeLinhasSelecionadas = nTotalLinhas
.head 5 +  Function: Marcado
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalTblQueryRowFlags( hWndItem, nLinha , ROW_MarkDeleted)
.head 8 -  Return TRUE
.head 7 -  Return FALSE
.head 5 +  Function: IsMarcado
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalTblQueryRowFlags( hWndItem, nLinha , ROW_MarkDeleted)
.head 8 -  Return 1
.head 7 -  Return 0
.head 5 -  !
.head 5 +  Function: PintaColuna
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nColuna
.head 7 -  Number: nCor
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hCol
.head 7 -  Number: nLinhaAnt
.head 6 +  Actions
.head 7 +  If nLinha > -1
.head 8 -  Set nLinhaAnt = SalTblQueryContext( hWndItem )
.head 8 -  Call SalTblSetContext(hWndItem, nLinha )
.head 7 -  Set hCol = SalTblGetColumnWindow( hWndItem, nColuna, COL_GetID  )
.head 7 -  Call SalTblSetCellTextColor( hCol, nCor, 1 )
.head 7 +  If nLinha > -1
.head 8 -  Call SalTblSetContext(hWndItem, nLinhaAnt )
.head 5 +  Function: PintaTextoLinha
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nCor
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hCol
.head 7 -  Number: nLinhaAnt
.head 7 -  Number: nPosColuna
.head 6 +  Actions
.head 7 -  Set nPosColuna = 1
.head 7 +  Loop
.head 8 -  Set hCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 8 +  If hCol = hWndNULL
.head 9 -  Break
.head 8 +  Else
.head 9 -  Call SalTblSetCellTextColor( hCol, nCor, 1 )
.head 9 -  Set nPosColuna = nPosColuna + 1
.head 5 +  Function: PintaFundoLinha
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nCor
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hCol
.head 7 -  Number: nLinhaAnt
.head 7 -  Number: nPosColuna
.head 6 +  Actions
.head 7 -  ! Call XSalTblSetRowBackColor( hWndItem, nLinha, nCor )
.head 5 +  Function: ColoreLinhasCoresAlternadas
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nCorPar
.head 7 -  Number: nCorImpar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 6 +  Actions
.head 7 -  Return FALSE
.head 7 -  ! Set nIndice = 0
.head 7 +  ! If nCorPar <= 0
.head 8 -  Set nCorPar = SalColorFromRGB ( 255, 255, 255 )
.head 7 +  ! If nCorImpar <= 0
.head 8 -  Set nCorImpar = SalColorFromRGB ( 240, 240, 240 )
.head 7 +  ! While SetContext( nIndice )
.head 8 +  If SalNumberMod( nIndice, 2 ) != 0
.head 9 -  Call PintaFundoLinha( nIndice, nCorImpar )
.head 8 +  Else
.head 9 -  Call PintaFundoLinha( nIndice, nCorPar )
.head 8 -  Set nIndice = nIndice + 1
.head 5 -  !
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblReset(hWndItem)
.head 5 +  Function: MudaFigura
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 -  Actions
.head 5 +  Function: MudaPic
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nPic
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag1, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag2, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag3, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag4, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_MarkDeleted, 0 )
.head 7 +  If nPic = 1
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag1, 1 )
.head 7 +  Else If nPic = 2
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag2, 1 )
.head 7 +  Else If nPic = 3
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag3, 1 )
.head 7 +  Else If nPic = 4
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_MarkDeleted, 1 )
.head 7 +  Else If nPic = 5
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag4, 1 )
.head 5 -  !
.head 5 +  Function: ExportaCSVColunas
.head 6 -  Description: Passado a Ordem das colunas e o valor -1 para criar colunas independentes da tabela
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeArquivoCSV
.head 7 -  Number: naColunas[*]
.head 7 -  String: saColunas[*]
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  ! Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  ! Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 7 -  !
.head 7 -  Number: nRetorno
.head 7 -  Number: nAux
.head 6 +  Actions
.head 7 -  !
.head 7 -  ! Abre arquivo CSV
.head 7 -  !
.head 7 +  If SalStrScan( SalStrUpperX( sNomeArquivoCSV) , '.CSV' ) < 0
.head 8 -  Set sNomeArquivoCSV =  sNomeArquivoCSV || '.csv'
.head 7 -  Call VisDosSplitPath( sNomeArquivoCSV, sDrive, sDiretorio, sBase, sExt )
.head 7 +  If not VisDosExist( sDrive || sDiretorio )
.head 8 -  Set sNomeArquivoCSV = sBase || sExt
.head 8 -  Call VisDosSplitPath( strArgArray[0], sDrive, sDiretorio, sBase, sExt )
.head 8 -  Set sNomeArquivoCSV = sDrive || sDiretorio || sNomeArquivoCSV
.head 7 +  If SalFileOpen( fhArquivoCSV, sNomeArquivoCSV, OF_Create | OF_ReadWrite )
.head 8 -  !
.head 8 -  ! Obtém os títulos de todas as colunas da tabela e grava no arquivo.
.head 8 -  !
.head 8 -  Set sLinha = STRING_Null
.head 8 -  Call SalArrayGetUpperBound( naColunas, 1, nRetorno )
.head 8 -  Set nAux = 0
.head 8 -  ! @ Cabeçalho Arquivo
.head 8 +  While nAux <= nRetorno
.head 9 +  If saColunas[nAux] != STRING_Null
.head 10 -  Set sLinha =  sLinha || '"' || SalStrTrimX( saColunas[nAux] ) || '"' || ';'
.head 9 +  Else
.head 10 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, naColunas[nAux], COL_GetPos )
.head 10 -  Call SalTblGetColumnTitle( hWndCol, sColuna, 100 )
.head 10 -  Set sLinha = sLinha || '"' || SalStrTrimX( sColuna ) || '"' || ';'
.head 9 -  Set nAux = nAux + 1
.head 8 -  !
.head 8 +  If SalStrLength( sLinha ) > 0
.head 9 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 9 -  Call SalFilePutStr( fhArquivoCSV, sLinha )
.head 8 -  !
.head 8 -  ! Percorre a tabela e salva os valores da colunas no arquivo
.head 8 -  !
.head 8 -  Set nLinha = 0
.head 8 +  While SalTblSetContext( hWndItem, nLinha )
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nAux =0
.head 9 -  !
.head 9 +  While nAux <= nRetorno
.head 10 +  If naColunas[nAux] = -1
.head 11 -  Set sLinha = sLinha || ';'
.head 10 +  Else
.head 11 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, naColunas[nAux], COL_GetPos )
.head 11 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 11 +  If SalStrScan( sColuna,  ';' ) >= 0
.head 12 +  While SalStrScan( sColuna, ';' ) > 0
.head 13 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 11 +  If SalStrScan( sColuna,  SalNumberToChar ( 13 ) ) >= 0
.head 12 +  While SalStrScan( sColuna, SalNumberToChar ( 13 )  ) > 0
.head 13 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 13 )  ), 1, ' ' )
.head 11 +  If SalStrScan( sColuna,  SalNumberToChar ( 10 ) ) >= 0
.head 12 +  While SalStrScan( sColuna, SalNumberToChar ( 10 )  ) > 0
.head 13 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 10 )  ), 1, ' ' )
.head 11 -  ! @
.head 11 +  If not SalStrIsValidNumber( sColuna )
.head 12 +  If SalStrScan( sColuna, ';' ) >= 0
.head 13 +  While SalStrScan( sColuna, ';' ) > 0
.head 14 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 12 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 11 +  Else
.head 12 -  Set sLinha = sLinha || sColuna || ';'
.head 10 -  Set nAux = nAux + 1
.head 9 -  !
.head 9 +  If SalStrLength( sLinha ) > 0
.head 10 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 10 -  Call SalFilePutStr( fhArquivoCSV, sLinha )
.head 9 -  Set nLinha = nLinha + 1
.head 8 -  Call SalFileClose( fhArquivoCSV )
.head 5 +  Function: ImportaCSVColunas
.head 6 -  Description: PARAM 2 -> Passado a Ordem das colunas sendo a posição 0 do vetor a primeira coluna do arquivo
e o valor contido no vetor[posição] o ID da Coluna a ser preenchida
PARAM 3 -> Indice da coluna a ser verificada no arquivo, NUMBER_Null Insere Linha
PARAM 4 -> ID da Coluna para verificação e preenchimento da celula
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeArquivoCSV
.head 7 -  Number: naColunas[*]
.head 7 -  Number: nColunaArquivo
.head 7 -  Number: nColunaTabela
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nColuna
.head 7 -  Number: nLinha
.head 7 -  String: sLinha
.head 7 -  String: sLinhaOriginal
.head 7 -  String: sAux
.head 7 -  String: sAux2
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  Boolean: bCabecalho
.head 6 +  Actions
.head 7 -  ! Abre arquivo CSV
.head 7 -  Set bCabecalho = TRUE
.head 7 +  If VisFileOpen( fhArquivoCSV, sNomeArquivoCSV, OF_Read ) >= 0
.head 8 +  While VisFileReadString (fhArquivoCSV, sLinha ) >= 0
.head 9 -  Set nColuna = 0
.head 9 +  If SalStrScan( sLinha,  '"' ) >= 0
.head 10 +  While SalStrScan( sLinha, '"'  ) > 0
.head 11 -  Set sLinha = SalStrReplaceX( sLinha, SalStrScan( sLinha, '"' ), 1, ' ' )
.head 9 +  If bCabecalho
.head 10 -  Set bCabecalho = FALSE
.head 9 +  Else
.head 10 +  If nColunaArquivo = NUMBER_Null
.head 11 -  Call SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 11 +  While SalStrScan( sLinha, ';' ) >= 0
.head 12 -  Set sAux = SalStrTrimX(SalStrMidX( sLinha, 0, SalStrScan( sLinha, ';' ) ))
.head 12 +  If naColunas[nColuna] > 0
.head 13 -  Call SalTblSetColumnText( hWndItem, naColunas[nColuna], sAux )
.head 12 -  Set sLinha = SalStrMidX( sLinha, SalStrScan( sLinha, ';' ) + 1, SalStrLength( sLinha ) - SalStrLength( sAux ) )
.head 12 -  Set nColuna = nColuna + 1
.head 11 +  If naColunas[nColuna] > 0
.head 12 -  Call SalTblSetColumnText( hWndItem, naColunas[nColuna], SalStrTrimX( sLinha ) )
.head 10 +  Else
.head 11 -  Set sLinhaOriginal = sLinha
.head 11 -  ! @
.head 11 +  While SalStrScan( sLinha, ';' ) >= 0
.head 12 -  Set sAux = SalStrMidX( sLinha, 0, SalStrScan( sLinha, ';' ) )
.head 12 +  If nColuna = nColunaArquivo
.head 13 -  Set nLinha = 0
.head 13 +  While SalTblSetContext( hWndItem, nLinha )
.head 14 -  Call SalTblGetColumnText( hWndItem, nColunaTabela, sAux2 )
.head 14 +  If sAux2 = sAux
.head 15 -  Set nColuna = 0
.head 15 +  While SalStrScan( sLinhaOriginal, ';' ) >= 0
.head 16 -  Set sAux = SalStrMidX( sLinhaOriginal, 0, SalStrScan( sLinhaOriginal, ';' ) )
.head 16 +  If naColunas[nColuna] > 0
.head 17 -  Call SalTblSetColumnText( hWndItem, naColunas[nColuna], SalStrTrimX( sAux ) )
.head 16 -  Set sLinhaOriginal = SalStrMidX( sLinhaOriginal, SalStrScan( sLinhaOriginal, ';' ) + 1, SalStrLength( sLinhaOriginal ) - SalStrLength( sAux ) )
.head 16 -  Set nColuna = nColuna + 1
.head 15 +  If naColunas[nColuna] > 0
.head 16 -  Call SalTblSetColumnText( hWndItem, naColunas[nColuna], SalStrTrimX( sLinhaOriginal ) )
.head 15 -  Break
.head 14 -  Set nLinha = nLinha + 1
.head 13 -  Set sLinha = ''
.head 12 -  Set sLinha = SalStrMidX( sLinha, SalStrScan( sLinha, ';' ) + 1, SalStrLength( sLinha ) - SalStrLength( sAux ) )
.head 12 -  Set nColuna = nColuna + 1
.head 10 -  ! Ultima Coluna
.head 8 -  Call VisFileClose (fhArquivoCSV)
.head 5 +  Function: getLinhaCabecalho		!!RRBGOMES 31/08/2012
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Boolean: bApenasVisiveis
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  String: sRetorno
.head 7 -  String: sColuna
.head 7 -  Boolean: bAdicionaValorColuna
.head 6 +  Actions
.head 7 -  Set nPosColuna = 1
.head 7 -  Set sRetorno = STRING_Null
.head 7 +  Loop
.head 8 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 8 +  If hWndCol = hWndNULL
.head 9 -  Break
.head 8 -  !
.head 8 +  If bApenasVisiveis
.head 9 -  Set bAdicionaValorColuna = FALSE
.head 9 +  If SalIsWindowVisible( hWndCol ) > 0
.head 10 -  Set bAdicionaValorColuna = TRUE
.head 8 +  Else
.head 9 -  Set bAdicionaValorColuna = TRUE
.head 8 -  !
.head 8 +  If bAdicionaValorColuna
.head 9 -  Call SalTblGetColumnTitle( hWndCol, sColuna, 100 )
.head 9 -  Set sRetorno = sRetorno || '"' || SalStrTrimX( sColuna ) || '"' || ';'
.head 8 -  !
.head 8 -  Set nPosColuna = nPosColuna + 1
.head 7 -  Return SalStrLeftX( sRetorno, SalStrLength( sRetorno ) - 1)
.head 5 +  Function: getTotalColunas		!!RRBGOMES 31/08/2012
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  String: sRetorno
.head 7 -  String: sColuna
.head 6 +  Actions
.head 7 -  Set nPosColuna = 1
.head 7 -  Set nTotalColunas = 0
.head 7 +  Loop
.head 8 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 8 +  If hWndCol = hWndNULL
.head 9 -  Set nTotalColunas = nPosColuna - 1
.head 9 -  Break
.head 8 -  Set nPosColuna = nPosColuna + 1
.head 7 -  Return nTotalColunas
.head 5 +  Function: ExportaCSV		        !!RRBGOMES 31/08/2012 -- FDE-7749
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeArquivoCSV
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  !
.head 7 -  Call ExportaCSV_ColunaBase( sNomeArquivoCSV, NUMBER_Null, FALSE, FALSE, FALSE, FALSE )
.head 5 +  Function: ExportaCSV_ColunaVisiveis	!!RRBGOMES 31/08/2012 -- FDE-7749
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ExportaCSV_ColunaBase( spNomeArquivo, NUMBER_Null, TRUE, TRUE, TRUE, FALSE )
.head 5 +  Function: ExportaCSV_ColunaVisiveisPontoVirgula !!Douglas
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ExportaCSV_ColunaBasePontoVirgula( spNomeArquivo, NUMBER_Null, TRUE, TRUE, TRUE, FALSE )
.head 5 +  Function: ExportaCSV_MarcadaExclusao	!! -- FDE-7749
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ExportaCSV_ColunaBase( spNomeArquivo, NUMBER_Null, TRUE, TRUE, TRUE, TRUE )
.head 5 +  Function: ExportaCSV_ColunaBase	        !!RRBGOMES 31/08/2012 -- FDE-7749
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 7 -  Number: nColunaQuebra !NUMBER_NULL sem quebra
.head 7 -  Boolean: bApenasVisiveis
.head 7 -  Boolean: bExibirDlgSalvarArquivo
.head 7 -  Boolean: bExibirMeter
.head 7 -  Boolean: bApenasMarcadasExclusao
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sPrimeiraLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 7 -  !
.head 7 -  String: saColunas[*]
.head 7 -  Number: nIndex
.head 7 -  String: sCaminhoOriginal
.head 7 -  String: sCaminho
.head 7 -  String: sTexto
.head 7 -  Number: nQtdeLinhas
.head 7 -  !
.head 7 -  String: sNomeQuebraOld
.head 7 -  String: sNomeQuebra
.head 7 -  Boolean: bAdicionaValorColuna
.head 6 +  Actions
.head 7 -  Set nQtdeLinhas = CountRow () + 0
.head 7 +  If nQtdeLinhas = 0 and bExibirDlgSalvarArquivo
.head 8 -  Call SalMessageBox( 'Não existe dados para serem exportados.', 'Atenção', MB_Ok )
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set saColunas[0] = 'Arquivo Excel( Extensão CSV )'
.head 7 -  Set saColunas[1] = '*.csv'
.head 7 -  Set nIndex = 0
.head 7 +  If bExibirDlgSalvarArquivo
.head 8 +  If Not SalDlgSaveFile( hWndForm, 'Salvar como', saColunas, 2, nIndex, spNomeArquivo, sCaminho )
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If SalStrScan( SalStrUpperX( spNomeArquivo) , '.CSV' ) < 0
.head 9 -  Set spNomeArquivo =  spNomeArquivo || '.csv'
.head 8 -  Call VisDosSplitPath( spNomeArquivo, sDrive, sDiretorio, sBase, sExt )
.head 8 +  If not VisDosExist( sDrive || sDiretorio )
.head 9 -  Set spNomeArquivo = sBase || sExt
.head 9 -  Call VisDosSplitPath( strArgArray[0], sDrive, sDiretorio, sBase, sExt )
.head 9 -  Set spNomeArquivo = sDrive || sDiretorio || spNomeArquivo
.head 8 -  Set sCaminho = spNomeArquivo
.head 7 -  !
.head 7 +  If 1
.head 8 -  Call SalTblSetContext( hWndItem, 0 )
.head 8 -  !
.head 8 +  If nColunaQuebra != NUMBER_Null
.head 9 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nColunaQuebra, COL_GetPos )
.head 9 +  If SalIsWindowVisible( hWndCol ) > 0
.head 10 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sNomeQuebra )
.head 10 -  Set sNomeQuebra = RetiraMarcasGeral( sNomeQuebra )
.head 9 -  Set sCaminhoOriginal = VisStrSubstitute( sCaminho, '.csv', '' )
.head 9 -  Set sCaminhoOriginal = VisStrSubstitute( sCaminhoOriginal, '.CSV', '' )
.head 9 -  Set sCaminho = sCaminhoOriginal || sNomeQuebra || '.csv'
.head 9 -  Set sNomeQuebraOld = sNomeQuebra
.head 8 -  !
.head 8 +  If VisDosExist( sCaminho )
.head 9 +  If VisFileDelete( sCaminho ) < 0
.head 10 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 10 -  Return 0
.head 8 -  !
.head 8 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) = VTERR_Ok
.head 9 -  Set nPosColuna = 1
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nTotalColunas = getTotalColunas ()
.head 9 -  Set sPrimeiraLinha = getLinhaCabecalho ( bApenasVisiveis )
.head 9 +  If SalStrLength( sPrimeiraLinha ) > 0
.head 10 -  Call VisFileWriteString( fhArquivoCSV, sPrimeiraLinha )
.head 9 -  !
.head 9 -  Set nLinha = 0
.head 9 +  If bExibirMeter
.head 10 -  Call SonMeter( 1, 0, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 +  While SalTblSetContext( hWndItem, nLinha )
.head 10 +  If not SalTblQueryRowFlags( hWndItem, nLinha, ROW_Hidden )
.head 11 -  Set bAdicionaValorColuna = TRUE
.head 11 +  If bApenasMarcadasExclusao
.head 12 +  If not SalTblQueryRowFlags( hWndItem, nLinha, ROW_MarkDeleted )
.head 13 -  Set bAdicionaValorColuna = FALSE
.head 11 -  !
.head 11 +  If bAdicionaValorColuna
.head 12 -  ! FECHA E INICIA OUTRO ARQUIVO POR QUEBRA
.head 12 +  If nColunaQuebra != NUMBER_Null
.head 13 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nColunaQuebra, COL_GetPos )
.head 13 +  If SalIsWindowVisible( hWndCol ) > 0
.head 14 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sNomeQuebra )
.head 14 -  Set sNomeQuebra = RetiraMarcasGeral( sNomeQuebra )
.head 13 +  If sNomeQuebra != sNomeQuebraOld
.head 14 -  Call VisFileClose( fhArquivoCSV )
.head 14 -  Set sCaminho = sCaminhoOriginal || sNomeQuebra || '.csv'
.head 14 +  If VisDosExist( sCaminho )
.head 15 +  If VisFileDelete( sCaminho ) < 0
.head 16 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 16 -  Return 0
.head 14 -  Set sNomeQuebraOld = sNomeQuebra
.head 14 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) != VTERR_Ok
.head 15 -  Return FALSE
.head 14 -  Call VisFileWriteString( fhArquivoCSV, sPrimeiraLinha )
.head 12 -  !
.head 12 -  Set sLinha = STRING_Null
.head 12 -  Set nPosColuna = 1
.head 12 +  While nPosColuna <= nTotalColunas
.head 13 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 13 -  !
.head 13 +  If bApenasVisiveis
.head 14 +  If SalIsWindowVisible( hWndCol ) > 0
.head 15 -  Set bAdicionaValorColuna = TRUE
.head 14 +  Else
.head 15 -  Set bAdicionaValorColuna = FALSE
.head 13 +  Else
.head 14 -  Set bAdicionaValorColuna = TRUE
.head 13 -  !
.head 13 +  If bAdicionaValorColuna
.head 14 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 14 -  !
.head 14 +  ! If SalStrScan( sColuna,  ';' ) >= 0
.head 15 +  While SalStrScan( sColuna, ';' ) > 0
.head 16 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 14 -  Set sColuna = VisStrSubstitute( sColuna, ';', '' )
.head 14 +  ! If SalStrScan( sColuna,  SalNumberToChar ( 13 ) ) >= 0
.head 15 +  While SalStrScan( sColuna, SalNumberToChar ( 13 )  ) >= 0
.head 16 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 13 )  ), 1, ' ' )
.head 14 -  Set sColuna = VisStrSubstitute( sColuna, SalNumberToChar ( 13 ), ' ' )
.head 14 +  ! If SalStrScan( sColuna,  SalNumberToChar ( 10 ) ) >= 0
.head 15 +  While SalStrScan( sColuna, SalNumberToChar ( 10 )  ) >= 0
.head 16 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 10 )  ), 1, ' ' )
.head 14 -  Set sColuna = VisStrSubstitute( sColuna, SalNumberToChar ( 10 ), ' ' )
.head 14 -  Set sColuna = VisStrSubstitute( sColuna, '"', '' )
.head 14 +  If not SalStrIsValidNumber( sColuna )
.head 15 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 14 +  Else
.head 15 -  Set sLinha = sLinha || sColuna || ';'
.head 13 -  !
.head 13 -  Set nPosColuna = nPosColuna + 1
.head 12 -  !
.head 12 +  If bExibirMeter
.head 13 -  Call SonMeter( 1, nLinha * 100 / nQtdeLinhas, 1, 'Gerando arquivo CSV em ' || sCaminho )
.head 12 -  !
.head 12 +  If SalStrLength( sLinha ) > 0
.head 13 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 13 -  Call VisFileWriteString( fhArquivoCSV, sLinha )
.head 10 -  Set nLinha = nLinha + 1
.head 9 +  If bExibirMeter
.head 10 -  Call SonMeter( 1, 100, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 -  !
.head 9 -  Call VisFileClose( fhArquivoCSV )
.head 9 +  If VisDosExist( sCaminho )
.head 10 -  Call SalMessageBox( 'Exportação CSV finalizada com sucesso.', 'Arquivo gerado', MB_IconAsterisk )
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Arquivo não encontrado. Problema ao gravar o arquivo em disco.', 'Erro na exportação', MB_IconStop)
.head 10 -  Return FALSE
.head 5 +  Function: ExportaCSV_ColunaBasePontoVirgula	        !!Douglas
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 7 -  Number: nColunaQuebra !NUMBER_NULL sem quebra
.head 7 -  Boolean: bApenasVisiveis
.head 7 -  Boolean: bExibirDlgSalvarArquivo
.head 7 -  Boolean: bExibirMeter
.head 7 -  Boolean: bApenasMarcadasExclusao
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sPrimeiraLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 7 -  !
.head 7 -  String: saColunas[*]
.head 7 -  Number: nIndex
.head 7 -  String: sCaminhoOriginal
.head 7 -  String: sCaminho
.head 7 -  String: sTexto
.head 7 -  Number: nQtdeLinhas
.head 7 -  !
.head 7 -  String: sNomeQuebraOld
.head 7 -  String: sNomeQuebra
.head 7 -  Boolean: bAdicionaValorColuna
.head 6 +  Actions
.head 7 -  Set nQtdeLinhas = CountRow () + 0
.head 7 +  If nQtdeLinhas = 0 and bExibirDlgSalvarArquivo
.head 8 -  Call SalMessageBox( 'Não existe dados para serem exportados.', 'Atenção', MB_Ok )
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set saColunas[0] = 'Arquivo Excel( Extensão CSV )'
.head 7 -  Set saColunas[1] = '*.csv'
.head 7 -  Set nIndex = 0
.head 7 +  If bExibirDlgSalvarArquivo
.head 8 +  If Not SalDlgSaveFile( hWndForm, 'Salvar como', saColunas, 2, nIndex, spNomeArquivo, sCaminho )
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If SalStrScan( SalStrUpperX( spNomeArquivo) , '.CSV' ) < 0
.head 9 -  Set spNomeArquivo =  spNomeArquivo || '.csv'
.head 8 -  Call VisDosSplitPath( spNomeArquivo, sDrive, sDiretorio, sBase, sExt )
.head 8 +  If not VisDosExist( sDrive || sDiretorio )
.head 9 -  Set spNomeArquivo = sBase || sExt
.head 9 -  Call VisDosSplitPath( strArgArray[0], sDrive, sDiretorio, sBase, sExt )
.head 9 -  Set spNomeArquivo = sDrive || sDiretorio || spNomeArquivo
.head 8 -  Set sCaminho = spNomeArquivo
.head 7 -  !
.head 7 +  If 1
.head 8 -  Call SalTblSetContext( hWndItem, 0 )
.head 8 -  !
.head 8 +  If nColunaQuebra != NUMBER_Null
.head 9 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nColunaQuebra, COL_GetPos )
.head 9 +  If SalIsWindowVisible( hWndCol ) > 0
.head 10 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sNomeQuebra )
.head 10 -  Set sNomeQuebra = sNomeQuebra
.head 9 -  Set sCaminhoOriginal = VisStrSubstitute( sCaminho, '.csv', '' )
.head 9 -  Set sCaminhoOriginal = VisStrSubstitute( sCaminhoOriginal, '.CSV', '' )
.head 9 -  Set sCaminho = sCaminhoOriginal || sNomeQuebra || '.csv'
.head 9 -  Set sNomeQuebraOld = sNomeQuebra
.head 8 -  !
.head 8 +  If VisDosExist( sCaminho )
.head 9 +  If VisFileDelete( sCaminho ) < 0
.head 10 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 10 -  Return 0
.head 8 -  !
.head 8 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) = VTERR_Ok
.head 9 -  Set nPosColuna = 1
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nTotalColunas = getTotalColunas ()
.head 9 -  Set sPrimeiraLinha = getLinhaCabecalho ( bApenasVisiveis )
.head 9 +  If SalStrLength( sPrimeiraLinha ) > 0
.head 10 -  Call VisFileWriteString( fhArquivoCSV, sPrimeiraLinha )
.head 9 -  !
.head 9 -  Set nLinha = 0
.head 9 +  If bExibirMeter
.head 10 -  Call SonMeter( 1, 0, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 +  While SalTblSetContext( hWndItem, nLinha )
.head 10 -  Set bAdicionaValorColuna = TRUE
.head 10 +  If bApenasMarcadasExclusao
.head 11 +  If not SalTblQueryRowFlags( hWndItem, nLinha, ROW_MarkDeleted )
.head 12 -  Set bAdicionaValorColuna = FALSE
.head 10 -  !
.head 10 +  If bAdicionaValorColuna
.head 11 -  ! FECHA E INICIA OUTRO ARQUIVO POR QUEBRA
.head 11 +  If nColunaQuebra != NUMBER_Null
.head 12 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nColunaQuebra, COL_GetPos )
.head 12 +  If SalIsWindowVisible( hWndCol ) > 0
.head 13 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sNomeQuebra )
.head 13 -  Set sNomeQuebra = sNomeQuebra
.head 12 +  If sNomeQuebra != sNomeQuebraOld
.head 13 -  Call VisFileClose( fhArquivoCSV )
.head 13 -  Set sCaminho = sCaminhoOriginal || sNomeQuebra || '.csv'
.head 13 +  If VisDosExist( sCaminho )
.head 14 +  If VisFileDelete( sCaminho ) < 0
.head 15 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 15 -  Return 0
.head 13 -  Set sNomeQuebraOld = sNomeQuebra
.head 13 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) != VTERR_Ok
.head 14 -  Return FALSE
.head 13 -  Call VisFileWriteString( fhArquivoCSV, sPrimeiraLinha )
.head 11 -  !
.head 11 -  Set sLinha = STRING_Null
.head 11 -  Set nPosColuna = 1
.head 11 +  While nPosColuna <= nTotalColunas
.head 12 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 12 -  !
.head 12 +  If bApenasVisiveis
.head 13 +  If SalIsWindowVisible( hWndCol ) > 0
.head 14 -  Set bAdicionaValorColuna = TRUE
.head 13 +  Else
.head 14 -  Set bAdicionaValorColuna = FALSE
.head 12 +  Else
.head 13 -  Set bAdicionaValorColuna = TRUE
.head 12 -  !
.head 12 +  If bAdicionaValorColuna
.head 13 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 13 -  !
.head 13 -  Set sColuna = VisStrSubstitute( sColuna, ';', ',' )
.head 13 -  Set sColuna = VisStrSubstitute( sColuna, SalNumberToChar ( 13 ), ' ' )
.head 13 -  Set sColuna = VisStrSubstitute( sColuna, SalNumberToChar ( 10 ), ' ' )
.head 13 -  Set sColuna = VisStrSubstitute( sColuna, '"', '' )
.head 13 +  If not SalStrIsValidNumber( sColuna )
.head 14 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 13 +  Else
.head 14 -  Set sLinha = sLinha || sColuna || ';'
.head 12 -  !
.head 12 -  Set nPosColuna = nPosColuna + 1
.head 11 -  !
.head 11 +  If bExibirMeter
.head 12 -  Call SonMeter( 1, nLinha * 100 / nQtdeLinhas, 1, 'Gerando arquivo CSV em ' || sCaminho )
.head 11 -  !
.head 11 +  If SalStrLength( sLinha ) > 0
.head 12 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 12 -  Call VisFileWriteString( fhArquivoCSV, sLinha )
.head 10 -  !
.head 10 -  Set nLinha = nLinha + 1
.head 9 +  If bExibirMeter
.head 10 -  Call SonMeter( 1, 100, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 -  !
.head 9 -  Call VisFileClose( fhArquivoCSV )
.head 9 +  If VisDosExist( sCaminho )
.head 10 -  Call SalMessageBox( 'Exportação CSV finalizada com sucesso.', 'Arquivo gerado', MB_IconAsterisk )
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Arquivo não encontrado. Problema ao gravar o arquivo em disco.', 'Erro na exportação', MB_IconStop)
.head 10 -  Return FALSE
.head 5 +  Function: ExportaCSV_ColunaVisiveisSemCabecalho     !!Lucas
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nColunaQuebra
.head 7 -  Boolean: bApenasVisiveis
.head 7 -  Boolean: bExibirDlgSalvarArquivo
.head 7 -  Boolean: bExibirMeter
.head 7 -  Boolean: bApenasMarcadasExclusao
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sPrimeiraLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 7 -  !
.head 7 -  String: saColunas[*]
.head 7 -  Number: nIndex
.head 7 -  String: sCaminhoOriginal
.head 7 -  String: sCaminho
.head 7 -  String: sTexto
.head 7 -  Number: nQtdeLinhas
.head 7 -  !
.head 7 -  String: sNomeQuebraOld
.head 7 -  String: sNomeQuebra
.head 7 -  Boolean: bAdicionaValorColuna
.head 6 +  Actions
.head 7 -  Set nColunaQuebra = NUMBER_Null
.head 7 -  Set bApenasVisiveis = TRUE
.head 7 -  Set bExibirDlgSalvarArquivo = TRUE
.head 7 -  Set bExibirMeter =  TRUE
.head 7 -  Set bApenasMarcadasExclusao = FALSE
.head 7 -  !
.head 7 -  Set nQtdeLinhas = CountRow () + 0
.head 7 +  If nQtdeLinhas = 0 and bExibirDlgSalvarArquivo
.head 8 -  Call SalMessageBox( 'Não existe dados para serem exportados.', 'Atenção', MB_Ok )
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set saColunas[0] = 'Arquivo Excel( Extensão CSV )'
.head 7 -  Set saColunas[1] = '*.csv'
.head 7 -  Set nIndex = 0
.head 7 +  If bExibirDlgSalvarArquivo
.head 8 +  If Not SalDlgSaveFile( hWndForm, 'Salvar como', saColunas, 2, nIndex, spNomeArquivo, sCaminho )
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If SalStrScan( SalStrUpperX( spNomeArquivo) , '.CSV' ) < 0
.head 9 -  Set spNomeArquivo =  spNomeArquivo || '.csv'
.head 8 -  Call VisDosSplitPath( spNomeArquivo, sDrive, sDiretorio, sBase, sExt )
.head 8 +  If not VisDosExist( sDrive || sDiretorio )
.head 9 -  Set spNomeArquivo = sBase || sExt
.head 9 -  Call VisDosSplitPath( strArgArray[0], sDrive, sDiretorio, sBase, sExt )
.head 9 -  Set spNomeArquivo = sDrive || sDiretorio || spNomeArquivo
.head 8 -  Set sCaminho = spNomeArquivo
.head 7 -  !
.head 7 +  If 1
.head 8 -  Call SalTblSetContext( hWndItem, 0 )
.head 8 -  !
.head 8 +  If nColunaQuebra != NUMBER_Null
.head 9 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nColunaQuebra, COL_GetPos )
.head 9 +  If SalIsWindowVisible( hWndCol ) > 0
.head 10 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sNomeQuebra )
.head 10 -  Set sNomeQuebra = RetiraMarcasGeral( sNomeQuebra )
.head 9 -  Set sCaminhoOriginal = VisStrSubstitute( sCaminho, '.csv', '' )
.head 9 -  Set sCaminhoOriginal = VisStrSubstitute( sCaminhoOriginal, '.CSV', '' )
.head 9 -  Set sCaminho = sCaminhoOriginal || sNomeQuebra || '.csv'
.head 9 -  Set sNomeQuebraOld = sNomeQuebra
.head 8 -  !
.head 8 +  If VisDosExist( sCaminho )
.head 9 +  If VisFileDelete( sCaminho ) < 0
.head 10 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 10 -  Return 0
.head 8 -  !
.head 8 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) = VTERR_Ok
.head 9 -  Set nPosColuna = 1
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nTotalColunas = getTotalColunas ()
.head 9 -  ! Set sPrimeiraLinha = getLinhaCabecalho ( bApenasVisiveis )
.head 9 +  ! If SalStrLength( sPrimeiraLinha ) > 0
.head 10 -  Call VisFileWriteString( fhArquivoCSV, sPrimeiraLinha )
.head 9 -  !
.head 9 -  Set nLinha = 0
.head 9 +  If bExibirMeter
.head 10 -  Call SonMeter( 1, 0, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 +  While SalTblSetContext( hWndItem, nLinha )
.head 10 +  If not SalTblQueryRowFlags( hWndItem, nLinha, ROW_Hidden )
.head 11 -  Set bAdicionaValorColuna = TRUE
.head 11 +  If bApenasMarcadasExclusao
.head 12 +  If not SalTblQueryRowFlags( hWndItem, nLinha, ROW_MarkDeleted )
.head 13 -  Set bAdicionaValorColuna = FALSE
.head 11 -  !
.head 11 +  If bAdicionaValorColuna
.head 12 -  ! FECHA E INICIA OUTRO ARQUIVO POR QUEBRA
.head 12 +  If nColunaQuebra != NUMBER_Null
.head 13 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nColunaQuebra, COL_GetPos )
.head 13 +  If SalIsWindowVisible( hWndCol ) > 0
.head 14 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sNomeQuebra )
.head 14 -  Set sNomeQuebra = RetiraMarcasGeral( sNomeQuebra )
.head 13 +  If sNomeQuebra != sNomeQuebraOld
.head 14 -  Call VisFileClose( fhArquivoCSV )
.head 14 -  Set sCaminho = sCaminhoOriginal || sNomeQuebra || '.csv'
.head 14 +  If VisDosExist( sCaminho )
.head 15 +  If VisFileDelete( sCaminho ) < 0
.head 16 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 16 -  Return 0
.head 14 -  Set sNomeQuebraOld = sNomeQuebra
.head 14 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) != VTERR_Ok
.head 15 -  Return FALSE
.head 14 -  ! Call VisFileWriteString( fhArquivoCSV, sPrimeiraLinha )
.head 12 -  !
.head 12 -  Set sLinha = STRING_Null
.head 12 -  Set nPosColuna = 1
.head 12 +  While nPosColuna <= nTotalColunas
.head 13 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 13 -  !
.head 13 +  If bApenasVisiveis
.head 14 +  If SalIsWindowVisible( hWndCol ) > 0
.head 15 -  Set bAdicionaValorColuna = TRUE
.head 14 +  Else
.head 15 -  Set bAdicionaValorColuna = FALSE
.head 13 +  Else
.head 14 -  Set bAdicionaValorColuna = TRUE
.head 13 -  !
.head 13 +  If bAdicionaValorColuna
.head 14 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 14 -  !
.head 14 +  ! If SalStrScan( sColuna,  ';' ) >= 0
.head 15 +  While SalStrScan( sColuna, ';' ) > 0
.head 16 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 14 -  Set sColuna = VisStrSubstitute( sColuna, ';', '' )
.head 14 +  ! If SalStrScan( sColuna,  SalNumberToChar ( 13 ) ) >= 0
.head 15 +  While SalStrScan( sColuna, SalNumberToChar ( 13 )  ) >= 0
.head 16 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 13 )  ), 1, ' ' )
.head 14 -  Set sColuna = VisStrSubstitute( sColuna, SalNumberToChar ( 13 ), ' ' )
.head 14 +  ! If SalStrScan( sColuna,  SalNumberToChar ( 10 ) ) >= 0
.head 15 +  While SalStrScan( sColuna, SalNumberToChar ( 10 )  ) >= 0
.head 16 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 10 )  ), 1, ' ' )
.head 14 -  Set sColuna = VisStrSubstitute( sColuna, SalNumberToChar ( 10 ), ' ' )
.head 14 -  Set sColuna = VisStrSubstitute( sColuna, '"', '' )
.head 14 +  If not SalStrIsValidNumber( sColuna )
.head 15 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 14 +  Else
.head 15 -  Set sLinha = sLinha || sColuna || ';'
.head 13 -  !
.head 13 -  Set nPosColuna = nPosColuna + 1
.head 12 -  !
.head 12 +  If bExibirMeter
.head 13 -  Call SonMeter( 1, nLinha * 100 / nQtdeLinhas, 1, 'Gerando arquivo CSV em ' || sCaminho )
.head 12 -  !
.head 12 +  If SalStrLength( sLinha ) > 0
.head 13 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 13 -  Call VisFileWriteString( fhArquivoCSV, sLinha )
.head 10 -  Set nLinha = nLinha + 1
.head 9 +  If bExibirMeter
.head 10 -  Call SonMeter( 1, 100, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 -  !
.head 9 -  Call VisFileClose( fhArquivoCSV )
.head 9 +  If VisDosExist( sCaminho )
.head 10 -  Call SalMessageBox( 'Exportação CSV finalizada com sucesso.', 'Arquivo gerado', MB_IconAsterisk )
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Arquivo não encontrado. Problema ao gravar o arquivo em disco.', 'Erro na exportação', MB_IconStop)
.head 10 -  Return FALSE
.head 5 -  !
.head 5 +  Function: NegritaColuna
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nColuna
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinhaAnt
.head 6 +  Actions
.head 7 -  Set nLinhaAnt = SalTblQueryContext(hWndItem)
.head 7 -  Call SalTblSetContext(hWndItem, nLinha )
.head 7 -  Call XSalTblSetColumnFontName(  SalTblGetColumnWindow( hWndItem, nColuna, COL_GetID ), "Arial", 8, FONT_EnhBold   )
.head 7 -  Call SalTblSetContext(hWndItem, nLinhaAnt )
.head 5 +  Function: InitSearch
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nRowsParam
.head 7 -  Window Handle: hWndColSearchParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set hWndColSearch = hWndColSearchParam
.head 7 -  Set nRows = nRowsParam
.head 7 -  Call SalTblSetRange( hWndItem, 0, nRows-1 )
.head 7 -  Set nRow = 0
.head 7 -  Call SalTblSetContext( hWndItem, nRow )
.head 5 +  Function: Search
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndFieldParam
.head 7 -  Boolean: bSelectAll
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set hWndField = hWndFieldParam
.head 7 -  ! Call TblSortIncreasing( nCol )
.head 7 -  Set bCresente = TRUE
.head 7 -  Set nRow = 0
.head 7 -  Call SalGetWindowText( hWndField, sText, 100 )
.head 7 -  Call SalTblSetFlagsAnyRows ( hWndItem, ROW_Selected, FALSE, 0, 0 )
.head 7 -  !
.head 7 -  ! first check for valid 'a' to 'z' or '_' -- search field is lower case
.head 7 +  If NOT SalIsNull( hWndField ) AND SalStrRightX( sText, 1 ) != ' ' AND
   (SalStrRightX( sText, 1 ) < 'A' OR SalStrRightX( sText, 1 ) > 'z') AND
   (SalStrRightX( sText, 1 ) < '.' OR SalStrRightX( sText, 1 ) > '9')
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_Selected, FALSE )
.head 7 +  If NOT SalIsNull( hWndField )
.head 8 -  Set nLen = SalStrLength( sText )
.head 8 +  If nLen < nLastLen OR bSelectAll
.head 9 -  Set nStart = 0
.head 9 -  Set nEnd = nRows
.head 8 +  Else
.head 9 -  Set nStart = nRow
.head 9 -  Set nEnd = nRows-1
.head 8 -  !
.head 8 +  Loop
.head 9 -  Set nRow = SalNumberRound( (nStart+nEnd) / 2 )
.head 9 -  Call SalTblFetchRow( hWndItem, nRow )
.head 9 -  Call SalGetWindowText( hWndColSearch, sTag, 100 )
.head 9 -  Set sTag = SalStrLeftX( sTag, nLen )
.head 9 +  If SalStrUpperX( sText ) > SalStrUpperX( sTag )
.head 10 -  Set nStart = nRow+1
.head 9 +  Else
.head 10 -  Set nEnd = nRow-1
.head 9 -  !
.head 9 +  If ((SalStrUpperX( sText ) = SalStrUpperX( sTag) ) AND (nStart > nEnd)) OR (nStart > nRows) OR nRow = nStart
.head 10 +  If nStart > nRows
.head 11 -  Set nRow = nRows-1
.head 10 -  Break
.head 8 -  !
.head 8 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_Selected, TRUE )
.head 8 -  Set nLastLen = nLen
.head 7 +  Else
.head 8 -  Set nRow = 0
.head 8 -  Set nLen = 0
.head 8 -  Set nLastLen = 0
.head 7 -  !
.head 7 -  Call SalTblSetContext( hWndItem, nRow )
.head 7 -  Call SalTblScroll( hWndItem, nRow, hWndNULL, TBL_AutoScroll )
.head 7 -  Return TRUE
.head 5 +  Function: SearchSoundex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndFieldParam
.head 7 -  Boolean: bSelectAll
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: oSoundex
.head 8 -  Class: fcSoundex
.head 6 +  Actions
.head 7 -  Set hWndField = hWndFieldParam
.head 7 -  ! Call TblSortIncreasing( nCol )
.head 7 -  Set bCresente = TRUE
.head 7 -  Set nRow = 0
.head 7 -  Call SalGetWindowText( hWndField, sText, 100 )
.head 7 -  Set sText = oSoundex.Soundex( sText )
.head 7 -  Call SalTblSetFlagsAnyRows ( hWndItem, ROW_Selected, FALSE, 0, 0 )
.head 7 -  !
.head 7 -  ! first check for valid 'a' to 'z' or '_' -- search field is lower case
.head 7 +  If NOT SalIsNull( hWndField ) AND SalStrRightX( sText, 1 ) != ' ' AND
   (SalStrRightX( sText, 1 ) < 'A' OR SalStrRightX( sText, 1 ) > 'z') AND
   (SalStrRightX( sText, 1 ) < '.' OR SalStrRightX( sText, 1 ) > '9')
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_Selected, FALSE )
.head 7 +  If NOT SalIsNull( hWndField )
.head 8 -  Set nLen = SalStrLength( sText )
.head 8 +  If nLen < nLastLen OR bSelectAll
.head 9 -  Set nStart = 0
.head 9 -  Set nEnd = nRows
.head 8 +  Else
.head 9 -  Set nStart = nRow
.head 9 -  Set nEnd = nRows-1
.head 8 -  !
.head 8 +  Loop
.head 9 -  Set nRow = SalNumberRound( (nStart+nEnd) / 2 )
.head 9 -  Call SalTblFetchRow( hWndItem, nRow )
.head 9 -  Call SalGetWindowText( hWndColSearch, sTag, 100 )
.head 9 -  Set sTag = oSoundex.Soundex( SalStrLeftX( sTag, nLen ) )
.head 9 +  If SalStrUpperX( sText ) > SalStrUpperX( sTag )
.head 10 -  Set nStart = nRow+1
.head 9 +  Else
.head 10 -  Set nEnd = nRow-1
.head 9 -  !
.head 9 +  If ((SalStrUpperX( sText ) = SalStrUpperX( sTag) ) AND (nStart > nEnd)) OR (nStart > nRows) OR nRow = nStart
.head 10 +  If nStart > nRows
.head 11 -  Set nRow = nRows-1
.head 10 -  Break
.head 8 -  !
.head 8 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_Selected, TRUE )
.head 8 -  Set nLastLen = nLen
.head 7 +  Else
.head 8 -  Set nRow = 0
.head 8 -  Set nLen = 0
.head 8 -  Set nLastLen = 0
.head 7 -  !
.head 7 -  Call SalTblSetContext( hWndItem, nRow )
.head 7 -  Call SalTblScroll( hWndItem, nRow, hWndNULL, TBL_AutoScroll )
.head 7 -  Return TRUE
.head 5 +  Function: SetSelecaoMultipla
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bSelecaoMultipla
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bMultiSelect = bSelecaoMultipla
.head 5 +  Function: GetLinhasSelecionadas
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Receive Number: nSelecionadas[*]
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return VisArrayCopy( nLinhasSelecionadas, nSelecionadas, DT_Number )
.head 5 +  Function: SetFocus
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nCol
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nLinha < 0
.head 8 -  Set nLinha = SalTblQueryContext( hWndItem )
.head 7 -  Call SalTblSetFocusCell( hWndItem, nLinha, SalTblGetColumnWindow( hWndItem, nCol, 0 ), -1, -1 )
.head 5 +  Function: CountRow
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nConta
.head 7 -  Number: nLinhaContexto
.head 6 +  Actions
.head 7 -  Set nLinhaContexto = SalTblQueryContext( hWndItem )
.head 7 -  Set nConta = 0
.head 7 +  While SalTblSetContext( hWndItem, nConta )
.head 8 -  Set nConta = nConta + 1
.head 7 -  Call SalTblSetContext( hWndItem, nLinhaContexto )
.head 7 -  Return nConta
.head 5 +  Function: SetContext
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalTblSetContext( hWndItem, nLinha )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: GetContext
.head 6 -  Description: Retorna -1 caso não ache contexto, do contrário, retorna a linha
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nContexto
.head 6 +  Actions
.head 7 -  Return SalTblQueryContext( hWndItem )
.head 5 -  !
.head 5 +  Function: EscondeLinha
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nRow
.head 7 -  Boolean: bHide
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_Hidden, bHide )
.head 5 +  Function: EscondeRowHeader
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblDefineRowHeader( hWndItem, '', 0, TBL_RowHdr_Visible, hWndNULL )
.head 4 +  Message Actions
.head 5 +  On PAM_NewRecord
.head 6 -  ! Call SetSelecaoMultipla( TRUE )
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 +  ! If bColorirDesabilitadas
.head 7 -  Call ColoreDesabilitadas( )
.head 5 +  On PAM_RecordExist
.head 6 -  ! Call SetSelecaoMultipla( TRUE )
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 +  ! If bColorirDesabilitadas
.head 7 -  Call ColoreDesabilitadas( )
.head 5 +  On PAM_Reset
.head 6 -  Call SalTblReset( hWndItem )
.head 6 -  Call SetSelecaoMultipla( TRUE )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  ! On SAM_KillFocus
.head 6 -  Set hWndDataFieldAnterior = hWndItem
.head 5 +  On PAM_Habilita
.head 6 +  If wParam = TRUE
.head 7 -  Call SalEnableWindow( hWndItem )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( hWndItem )
.head 5 +  On WM_ENABLE
.head 6 +  If wParam
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_White )
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 6 +  Else
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_LightGray )
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Set nCol = 1
.head 6 +  While SalTblGetColumnWindow( hWndItem, nCol, COL_GetID )
.head 7 +  If SalTblQueryColumnFlags( SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ), COL_Selected )
.head 8 -  Break
.head 7 -  Set nCol = nCol + 1
.head 6 +  If not bCresente
.head 7 -  Call TblSortIncreasing( nCol )
.head 7 -  Set bCresente = TRUE
.head 6 +  Else
.head 7 -  Call TblSortDecreasing( nCol )
.head 7 -  Set bCresente = FALSE
.head 6 -  Call SalTblSetColumnFlags( SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ), COL_Selected, FALSE )
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressRowLines, TRUE )
.head 6 -  ! Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressLastColLine, TRUE )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
.head 6 -  Call ttAttachWindow ( hWndItem, '' )
.head 5 +  On SAM_RowHeaderClick
.head 6 +  If bMultiSelect
.head 7 +  If SalTblQueryRowFlags( hWndItem, SalTblQueryContext( hWndItem ), ROW_MarkDeleted )
.head 8 -  Call SalTblSetRowFlags( hWndItem, SalTblQueryContext( hWndItem ), ROW_MarkDeleted, FALSE )
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags( hWndItem, SalTblQueryContext( hWndItem ), ROW_MarkDeleted, TRUE )
.head 6 +  Else
.head 7 -  Set nRow = SalTblQueryContext( hWndItem )
.head 7 -  Call DesmarcaTodas ()
.head 7 +  If SalTblQueryRowFlags( hWndItem, nRow, ROW_MarkDeleted )
.head 8 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_MarkDeleted, FALSE )
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_MarkDeleted, TRUE )
.head 5 -  !
.head 5 +  ! On AM_TOOLTIP_NeedText
.head 6 -  Return OnToolTipNeedText ()
.head 3 +  Child Table Class: pcChildTableExportaNLPD
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000000
.head 5 -  Discardable? No
.head 4 -  Next Class Child Key: 69
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,N,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcChildTableSemLinha
.head 4 +  Contents
.head 5 +  Column: colID
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 69
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: ID
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDATA_EMISSAO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 2
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: DataEmissao
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colUG
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 4
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: UG
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.067"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCGC
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 6
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Credor
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFONTE
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 7
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Fonte
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALOR
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 8
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Valor
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREC_DESP
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 9
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: RecDesp
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colEVENTO_NL
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 10
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Evento NL
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCLASSIFICACAO_NL
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 12
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Classificacao NL
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colEMPENHO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 30
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Numero NE
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNOTAFISCAL
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 32
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Numero NF
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOBS1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 33
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Observação NL
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOBS2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 34
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Observação NL 2
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNUMERO_NL
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 36
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: NNL
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDATA_VENCIMENTO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 38
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: DataVencimento
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.233"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPAG_UG
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 40
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: UgPagadora
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPAG_GESTAO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 41
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: GestaoPagadora
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPAG_BANCO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 42
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: BancoPagador
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPAG_AGENCIA
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 43
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: AgenciaPagador
ContaCorrentePagador
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPAG_CTACORR
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 44
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: ContaCorrentePagador
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFAV_BANCO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 46
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: BancoFavorecido
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFAV_AGENCIA
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 47
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: AgenciaFavorecido
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFAV_CTACORR
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 48
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: ContaCorrenteFavorecido
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPROCESSO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 49
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Processo
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFINALIDADE
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 50
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Finalidade
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNUMERO_PD
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 51
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: NPD
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colEVENTO_PD
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 52
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Evento PD
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCLASSIFICACAO_PD
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 54
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Informações para Log,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Classificacao PD
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! ! CAMPOS DE CONTROLE PARA SALVAR OS DADOS
.head 5 +  Column: colAnoDP
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 55
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Ano Doc. Pagto.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDP
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 56
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Doc. Pagto.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colParcela
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 57
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Parcela
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCodEncargo
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 58
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Encargo
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRPS
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 59
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: RPS
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDevolucao
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 60
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: Devolução
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTipoLote
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 61
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: TipoLote
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFichaLote
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 536F6E49676E6F72 614C6F6700020030 0000536F6E4C6162 656C000100000000
0020: 000000
.enddata
.data CLASSPROPSSIZE
0000: 2300
.enddata
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 62
.head 6 -  Class: pcColumn
.head 6 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 6 -  Class DLL Name:
.head 6 -  Title: FichaLote
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nCol
.head 5 -  Boolean: bCresente
.head 5 -  Boolean: bColorirDesabilitadas
.head 5 -  !
.head 5 -  Boolean: bMultiSelect
.head 5 -  Number: nLinhasSelecionadas[*]
.head 5 -  Number: nQtdeLinhasSelecionadas
.head 5 -  Window Handle: hWndField
.head 5 -  Window Handle: hWndColSearch
.head 5 -  Number: nLastLen
.head 5 -  Number: nLen
.head 5 -  Number: nRow
.head 5 -  Number: nRows
.head 5 -  Number: nStart
.head 5 -  Number: nEnd
.head 5 -  String: sTag
.head 5 -  String: sText
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On PAM_NewRecord
.head 6 -  ! Call SetSelecaoMultipla( TRUE )
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 +  ! If bColorirDesabilitadas
.head 7 -  Call ColoreDesabilitadas( )
.head 5 +  On PAM_RecordExist
.head 6 -  ! Call SetSelecaoMultipla( TRUE )
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 +  ! If bColorirDesabilitadas
.head 7 -  Call ColoreDesabilitadas( )
.head 5 +  On PAM_Reset
.head 6 -  Call SalTblReset( hWndItem )
.head 6 -  Call SetSelecaoMultipla( TRUE )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  On PAM_Habilita
.head 6 +  If wParam = TRUE
.head 7 -  Call SalEnableWindow( hWndItem )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( hWndItem )
.head 5 +  On WM_ENABLE
.head 6 +  If wParam
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_White )
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 6 +  Else
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_LightGray )
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Set nCol = 1
.head 6 +  While SalTblGetColumnWindow( hWndItem, nCol, COL_GetID )
.head 7 +  If SalTblQueryColumnFlags( SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ), COL_Selected )
.head 8 -  Break
.head 7 -  Set nCol = nCol + 1
.head 6 +  If not bCresente
.head 7 -  Call TblSortIncreasing( nCol )
.head 7 -  Set bCresente = TRUE
.head 6 +  Else
.head 7 -  Call TblSortDecreasing( nCol )
.head 7 -  Set bCresente = FALSE
.head 6 -  Call SalTblSetColumnFlags( SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ), COL_Selected, FALSE )
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressRowLines, TRUE )
.head 6 -  ! Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressLastColLine, TRUE )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
.head 6 -  Call ttAttachWindow ( hWndItem, '' )
.head 5 +  On SAM_RowHeaderClick
.head 6 +  If bMultiSelect
.head 7 +  If SalTblQueryRowFlags( hWndItem, SalTblQueryContext( hWndItem ), ROW_MarkDeleted )
.head 8 -  Call SalTblSetRowFlags( hWndItem, SalTblQueryContext( hWndItem ), ROW_MarkDeleted, FALSE )
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags( hWndItem, SalTblQueryContext( hWndItem ), ROW_MarkDeleted, TRUE )
.head 6 +  Else
.head 7 -  Set nRow = SalTblQueryContext( hWndItem )
.head 7 -  Call DesmarcaTodas ()
.head 7 +  If SalTblQueryRowFlags( hWndItem, nRow, ROW_MarkDeleted )
.head 8 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_MarkDeleted, FALSE )
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_MarkDeleted, TRUE )
.head 3 +  Child Table Class: pcChildTableSemLinhaKey
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000000
.head 5 -  Discardable? No
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,N,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcMouseWheel
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nCol
.head 5 -  Boolean: bCresente
.head 5 -  Boolean: bColorirDesabilitadas
.head 5 -  !
.head 5 -  Boolean: bMultiSelect
.head 5 -  Number: nLinhasSelecionadas[*]
.head 5 -  Number: nQtdeLinhasSelecionadas
.head 5 -  Window Handle: hWndField
.head 5 -  Window Handle: hWndColSearch
.head 5 -  Number: nLastLen
.head 5 -  Number: nLen
.head 5 -  Number: nRow
.head 5 -  Number: nRows
.head 5 -  Number: nStart
.head 5 -  Number: nEnd
.head 5 -  String: sTag
.head 5 -  String: sText
.head 4 +  Functions
.head 5 +  ! Function: OnToolTipNeedText
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nX
.head 7 -  Number: nY
.head 7 -  Number: nRow
.head 7 -  Number: nFlags
.head 7 -  Window Handle: hWnd
.head 7 -  String: sText
.head 7 -  String: sAux
.head 6 +  Actions
.head 7 -  Call GetCursorPos ( nX, nY )
.head 7 -  Call ScreenToClient ( hWndItem, nX, nY )
.head 7 +  If SalTblObjectsFromPoint ( hWndItem, nX, nY, nRow, hWnd, nFlags )
.head 8 -  Set sAux = STRING_Null
.head 8 +  If GetInvisibleText( hWnd, nRow )
.head 9 -  Set sText = VisTblGetCell ( hWndItem, nRow, hWnd )
.head 9 +  If sText
.head 10 +  Loop
.head 11 +  If SalStrLength( sText ) < 80
.head 12 -  Set sAux = sAux || sText
.head 12 -  Break
.head 11 -  Set sAux = sAux || SalStrLeftX( sText, 80 ) || '
'
.head 11 -  Set sText = SalStrRightX( sText, SalStrLength( sText ) - 80 )
.head 10 -  Call ttSetDynamicTipText ( sAux )
.head 10 -  Return TRUE
.head 7 -  Return FALSE
.head 5 +  Function: SalStrGetSize
.head 6 -  Description: desc:
Returns the width and height of a string in pixels (depends on the font of the control)

parameter:
Window Handle: phWnd	! the control
String: psStr  		! the string
Receive Number: pnX  	! the width
Receive Number: pnY  	! the height

.head 6 -  Returns
.head 6 +  Parameters
.head 7 +  Window Handle: phWnd
.head 8 -  ! the control
.head 7 +  String: psStr
.head 8 -  ! the string
.head 7 +  Receive Number: pnX
.head 8 -  ! the width
.head 7 +  Receive Number: pnY
.head 8 -  ! the height
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call GetTextExtentPoint32A( GetDC( phWnd ), psStr, SalStrGetBufferLength( psStr ), pnX, pnY )
.head 5 +  Function: GetInvisibleText
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWnd
.head 7 -  Number: nRow
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nX
.head 7 -  Number: nY
.head 7 -  String: strText
.head 6 +  Actions
.head 7 -  Set strText = VisTblGetCell ( hWndItem, nRow, hWnd )
.head 7 -  Call SalStrGetSize( hWnd, strText, nX, nY )
.head 7 -  Call SalTblQueryColumnWidth ( hWnd, nY )
.head 7 -  Set nY = SalFormUnitsToPixels( hWnd, nY, FALSE )
.head 7 -  Return nX > nY
.head 5 -  !
.head 5 +  Function: Insere
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nL
.head 6 +  Actions
.head 7 -  Set nL =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nL, ROW_New, FALSE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nL
.head 5 +  Function: InsertRow
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nL
.head 6 +  Actions
.head 7 -  Set nL = SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nL, ROW_New, FALSE )
.head 7 -  Return nL
.head 5 +  Function: InsereSel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_New, FALSE )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_UserFlag1, TRUE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nRow
.head 5 +  Function: InsereDoc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_New, FALSE )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_UserFlag2, TRUE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nRow
.head 5 +  Function: InsereDocV
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_New, FALSE )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_UserFlag3, TRUE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nRow
.head 5 -  !
.head 5 +  Function: TblSortDecreasing
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nColPar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bRet
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set bRet = SalTblSortRows( hWndItem, nColPar, TBL_SortDecreasing )
.head 7 -  Set nCol = nColPar
.head 7 -  Call InitSearch( CountRow(  ), SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ) )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return bRet
.head 5 +  Function: TblSortIncreasing
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nColPar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bRet
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set bRet = SalTblSortRows( hWndItem, nColPar, TBL_SortIncreasing )
.head 7 -  Set nCol = nColPar
.head 7 -  Call InitSearch( CountRow(  ), SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ) )
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Return bRet
.head 5 -  !
.head 5 +  Function: ExcluiMarcado
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nL
.head 6 +  Actions
.head 7 -  Set nL = 0
.head 7 +  While SalTblSetContext(hWndItem, nL )
.head 8 +  If SalTblQueryRowFlags( hWndItem, nL , ROW_MarkDeleted)
.head 9 -  Call SalTblDeleteRow(hWndItem, nL, 0)
.head 9 -  Set nL = nL - 1
.head 8 -  Set nL = nL + 1
.head 5 +  Function: DeleteRow
.head 6 -  Description: Deleta Todas Linhas marcadas
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 7 -  Boolean: bDeletou
.head 6 +  Actions
.head 7 -  Set bDeletou = FALSE
.head 7 -  Set nIndice = 0
.head 7 +  While SalTblSetContext( hWndItem, nIndice )
.head 8 +  If SalTblQueryRowFlags( hWndItem, nIndice, ROW_MarkDeleted )
.head 9 -  Call SalTblDeleteRow( hWndItem, nIndice, TBL_NoAdjust )
.head 9 -  Set nIndice = nIndice - 1
.head 9 -  Set bDeletou = TRUE
.head 8 -  Set nIndice = nIndice + 1
.head 7 -  Return bDeletou
.head 5 +  Function: Exclui
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nL
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nL < 0
.head 8 -  Set nL = SalTblQueryContext( hWndItem )
.head 7 -  Call SalTblDeleteRow(hWndItem, nL, TBL_NoAdjust )
.head 5 -  !
.head 5 +  Function: DesmarcaTodas
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblSetFlagsAnyRows( hWndItem, ROW_MarkDeleted, FALSE, 0, 0 )
.head 7 -  Call SalArraySetUpperBound( nLinhasSelecionadas, 1, -1 )
.head 7 -  Set nQtdeLinhasSelecionadas = 0
.head 5 +  Function: MarcaTodas
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 7 -  Number: nTotalLinhas
.head 6 +  Actions
.head 7 -  Call SalTblSetFlagsAnyRows( hWndItem, ROW_MarkDeleted, TRUE, 0, 0 )
.head 7 -  Call SalArraySetUpperBound( nLinhasSelecionadas, 1, -1 )
.head 7 -  Set nTotalLinhas = SalTblCountRow( hWndItem )
.head 7 -  Set nLinha = 0
.head 7 +  While nLinha < nTotalLinhas
.head 8 -  Set nLinhasSelecionadas[ nLinha ] = nLinha
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Set nQtdeLinhasSelecionadas = nTotalLinhas
.head 5 +  Function: Marcado
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalTblQueryRowFlags( hWndItem, nLinha , ROW_MarkDeleted)
.head 8 -  Return TRUE
.head 7 -  Return FALSE
.head 5 +  Function: IsMarcado
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalTblQueryRowFlags( hWndItem, nLinha , ROW_MarkDeleted)
.head 8 -  Return 1
.head 7 -  Return 0
.head 5 -  !
.head 5 +  Function: PintaColuna
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nColuna
.head 7 -  Number: nCor
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hCol
.head 7 -  Number: nLinhaAnt
.head 6 +  Actions
.head 7 +  If nLinha > -1
.head 8 -  Set nLinhaAnt = SalTblQueryContext( hWndItem )
.head 8 -  Call SalTblSetContext(hWndItem, nLinha )
.head 7 -  Set hCol = SalTblGetColumnWindow( hWndItem, nColuna, COL_GetID  )
.head 7 -  Call SalTblSetCellTextColor( hCol, nCor, 1 )
.head 7 +  If nLinha > -1
.head 8 -  Call SalTblSetContext(hWndItem, nLinhaAnt )
.head 5 +  Function: PintaTextoLinha
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nCor
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hCol
.head 7 -  Number: nLinhaAnt
.head 7 -  Number: nPosColuna
.head 6 +  Actions
.head 7 -  Set nPosColuna = 1
.head 7 +  Loop
.head 8 -  Set hCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 8 +  If hCol = hWndNULL
.head 9 -  Break
.head 8 +  Else
.head 9 -  Call SalTblSetCellTextColor( hCol, nCor, 1 )
.head 9 -  Set nPosColuna = nPosColuna + 1
.head 5 +  Function: PintaFundoLinha
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nCor
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hCol
.head 7 -  Number: nLinhaAnt
.head 7 -  Number: nPosColuna
.head 6 +  Actions
.head 7 -  ! Call XSalTblSetRowBackColor( hWndItem, nLinha, nCor )
.head 5 +  Function: ColoreLinhasCoresAlternadas
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nCorPar
.head 7 -  Number: nCorImpar
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 6 +  Actions
.head 7 -  Return FALSE
.head 7 -  ! Set nIndice = 0
.head 7 +  ! If nCorPar <= 0
.head 8 -  Set nCorPar = SalColorFromRGB ( 255, 255, 255 )
.head 7 +  ! If nCorImpar <= 0
.head 8 -  Set nCorImpar = SalColorFromRGB ( 240, 240, 240 )
.head 7 +  ! While SetContext( nIndice )
.head 8 +  If SalNumberMod( nIndice, 2 ) != 0
.head 9 -  Call PintaFundoLinha( nIndice, nCorImpar )
.head 8 +  Else
.head 9 -  Call PintaFundoLinha( nIndice, nCorPar )
.head 8 -  Set nIndice = nIndice + 1
.head 5 -  !
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblReset(hWndItem)
.head 5 +  Function: MudaFigura
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 -  Actions
.head 5 +  Function: MudaPic
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nPic
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag1, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag2, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag3, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag4, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_MarkDeleted, 0 )
.head 7 +  If nPic = 1
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag1, 1 )
.head 7 +  Else If nPic = 2
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag2, 1 )
.head 7 +  Else If nPic = 3
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag3, 1 )
.head 7 +  Else If nPic = 4
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_MarkDeleted, 1 )
.head 7 +  Else If nPic = 5
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag4, 1 )
.head 5 -  !
.head 5 +  ! Function: ExportaCSV
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeArquivoCSV
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 6 +  Actions
.head 7 -  !
.head 7 -  ! Abre arquivo CSV
.head 7 -  !
.head 7 +  If SalStrScan( SalStrUpperX( sNomeArquivoCSV) , '.CSV' ) < 0
.head 8 -  Set sNomeArquivoCSV =  sNomeArquivoCSV || '.csv'
.head 7 -  Call VisDosSplitPath( sNomeArquivoCSV, sDrive, sDiretorio, sBase, sExt )
.head 7 +  If not VisDosExist( sDrive || sDiretorio )
.head 8 -  Set sNomeArquivoCSV = sBase || sExt
.head 8 -  Call VisDosSplitPath( strArgArray[0], sDrive, sDiretorio, sBase, sExt )
.head 8 -  Set sNomeArquivoCSV = sDrive || sDiretorio || sNomeArquivoCSV
.head 7 +  If SalFileOpen( fhArquivoCSV, sNomeArquivoCSV, OF_Create | OF_ReadWrite )
.head 8 -  !
.head 8 -  ! Obtém os títulos de todas as colunas da tabela e grava no arquivo.
.head 8 -  !
.head 8 -  Set nPosColuna = 1
.head 8 -  Set sLinha = STRING_Null
.head 8 +  Loop
.head 9 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 9 +  If hWndCol = hWndNULL
.head 10 -  Set nTotalColunas = nPosColuna -1
.head 10 -  Break
.head 9 +  Else
.head 10 -  Call SalTblGetColumnTitle( hWndCol, sColuna, 100 )
.head 10 -  Set sLinha = sLinha || '"' || SalStrTrimX( sColuna ) || '"' || ';'
.head 10 -  Set nPosColuna = nPosColuna + 1
.head 8 +  If SalStrLength( sLinha ) > 0
.head 9 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 9 -  Call SalFilePutStr( fhArquivoCSV, sLinha )
.head 8 -  !
.head 8 -  ! Percorre a tabela e salva os valores da colunas no arquivo
.head 8 -  !
.head 8 -  Set nLinha = 0
.head 8 +  While SalTblSetContext( hWndItem, nLinha )
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nPosColuna =1
.head 9 +  While nPosColuna <= nTotalColunas
.head 10 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 10 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 10 +  If SalStrScan( sColuna,  ';' ) >= 0
.head 11 +  While SalStrScan( sColuna, ';' ) > 0
.head 12 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 10 +  If SalStrScan( sColuna,  SalNumberToChar ( 13 ) ) >= 0
.head 11 +  While SalStrScan( sColuna, SalNumberToChar ( 13 )  ) > 0
.head 12 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 13 )  ), 1, ' ' )
.head 10 +  If SalStrScan( sColuna,  SalNumberToChar ( 10 ) ) >= 0
.head 11 +  While SalStrScan( sColuna, SalNumberToChar ( 10 )  ) > 0
.head 12 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 10 )  ), 1, ' ' )
.head 10 +  If not SalStrIsValidNumber( sColuna )
.head 11 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 10 +  Else
.head 11 -  Set sLinha = sLinha || sColuna || ';'
.head 10 -  Set nPosColuna = nPosColuna + 1
.head 9 +  If SalStrLength( sLinha ) > 0
.head 10 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 10 -  Call SalFilePutStr( fhArquivoCSV, sLinha )
.head 9 -  Set nLinha = nLinha + 1
.head 8 -  Call SalFileClose( fhArquivoCSV )
.head 5 +  ! Function: ExportaCSV_ColunaVisiveis
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 7 -  !
.head 7 -  String: saColunas[*]
.head 7 -  Number: nIndex
.head 7 -  String: sCaminho
.head 7 -  String: sTexto
.head 7 -  Number: nQtdeLinhas
.head 6 +  Actions
.head 7 -  Set nQtdeLinhas = CountRow () + 0
.head 7 +  If nQtdeLinhas = 0
.head 8 -  Call SalMessageBox( 'Não existe dados para serem exportados.', 'Atenção', MB_Ok )
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set saColunas[0] = 'Arquivo Excel( Extensão CSV )'
.head 7 -  Set saColunas[1] = '*.csv'
.head 7 -  Set nIndex = 0
.head 7 +  If SalDlgSaveFile( hWndForm, 'Salvar como', saColunas, 2, nIndex, spNomeArquivo, sCaminho )
.head 8 +  If VisDosExist( sCaminho )
.head 9 +  If VisFileDelete( sCaminho ) < 0
.head 10 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 10 -  Return 0
.head 8 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) = VTERR_Ok
.head 9 -  !
.head 9 -  Set nPosColuna = 1
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nTotalColunas = 0
.head 9 +  Loop
.head 10 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 10 +  If hWndCol = hWndNULL
.head 11 -  Set nTotalColunas = nPosColuna - 1
.head 11 -  Break
.head 10 -  !
.head 10 +  If SalIsWindowVisible( hWndCol ) > 0
.head 11 -  Call SalTblGetColumnTitle( hWndCol, sColuna, 100 )
.head 11 -  Set sLinha = sLinha || '"' || SalStrTrimX( sColuna ) || '"' || ';'
.head 10 -  !
.head 10 -  Set nPosColuna = nPosColuna + 1
.head 9 +  If SalStrLength( sLinha ) > 0
.head 10 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 10 -  Call VisFileWriteString( fhArquivoCSV, sLinha )
.head 9 -  !
.head 9 -  !
.head 9 -  Set nLinha = 0
.head 9 -  Call SonMeter( 1, 0, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 +  While SalTblSetContext( hWndItem, nLinha )
.head 10 -  Set sLinha = STRING_Null
.head 10 -  Set nPosColuna = 1
.head 10 +  While nPosColuna <= nTotalColunas
.head 11 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 11 -  !
.head 11 +  If SalIsWindowVisible( hWndCol ) > 0
.head 12 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 12 -  !
.head 12 +  If SalStrScan( sColuna,  ';' ) >= 0
.head 13 +  While SalStrScan( sColuna, ';' ) > 0
.head 14 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 12 +  If SalStrScan( sColuna,  SalNumberToChar ( 13 ) ) >= 0
.head 13 +  While SalStrScan( sColuna, SalNumberToChar ( 13 )  ) >= 0
.head 14 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 13 )  ), 1, ' ' )
.head 12 +  If SalStrScan( sColuna,  SalNumberToChar ( 10 ) ) >= 0
.head 13 +  While SalStrScan( sColuna, SalNumberToChar ( 10 )  ) >= 0
.head 14 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 10 )  ), 1, ' ' )
.head 12 +  If not SalStrIsValidNumber( sColuna )
.head 13 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 12 +  Else
.head 13 -  Set sLinha = sLinha || sColuna || ';'
.head 11 -  !
.head 11 -  Set nPosColuna = nPosColuna + 1
.head 10 -  !
.head 10 -  Call SonMeter( 1, nLinha * 100 / nQtdeLinhas, 1, 'Gerando arquivo CSV em ' || sCaminho )
.head 10 -  !
.head 10 +  If SalStrLength( sLinha ) > 0
.head 11 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 11 -  Call VisFileWriteString( fhArquivoCSV, sLinha )
.head 10 -  Set nLinha = nLinha + 1
.head 9 -  Call SonMeter( 1, 100, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 -  !
.head 9 -  Call VisFileClose( fhArquivoCSV )
.head 9 +  If VisDosExist( sCaminho )
.head 10 -  Call SalMessageBox( 'Exportação CSV finalizada com sucesso.', 'Arquivo gerado', MB_IconAsterisk )
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Arquivo não encontrado. Problema ao gravar o arquivo em disco.', 'Erro na exportação', MB_IconStop)
.head 10 -  Return FALSE
.head 5 +  Function: ExportaCSVColunas
.head 6 -  Description: Passado a Ordem das colunas e o valor -1 para criar colunas independentes da tabela
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeArquivoCSV
.head 7 -  Number: naColunas[*]
.head 7 -  String: saColunas[*]
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  ! Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  ! Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 7 -  !
.head 7 -  Number: nRetorno
.head 7 -  Number: nAux
.head 6 +  Actions
.head 7 -  !
.head 7 -  ! Abre arquivo CSV
.head 7 -  !
.head 7 +  If SalStrScan( SalStrUpperX( sNomeArquivoCSV) , '.CSV' ) < 0
.head 8 -  Set sNomeArquivoCSV =  sNomeArquivoCSV || '.csv'
.head 7 -  Call VisDosSplitPath( sNomeArquivoCSV, sDrive, sDiretorio, sBase, sExt )
.head 7 +  If not VisDosExist( sDrive || sDiretorio )
.head 8 -  Set sNomeArquivoCSV = sBase || sExt
.head 8 -  Call VisDosSplitPath( strArgArray[0], sDrive, sDiretorio, sBase, sExt )
.head 8 -  Set sNomeArquivoCSV = sDrive || sDiretorio || sNomeArquivoCSV
.head 7 +  If SalFileOpen( fhArquivoCSV, sNomeArquivoCSV, OF_Create | OF_ReadWrite )
.head 8 -  !
.head 8 -  ! Obtém os títulos de todas as colunas da tabela e grava no arquivo.
.head 8 -  !
.head 8 -  Set sLinha = STRING_Null
.head 8 -  Call SalArrayGetUpperBound( naColunas, 1, nRetorno )
.head 8 -  Set nAux = 0
.head 8 -  ! @ Cabeçalho Arquivo
.head 8 +  While nAux <= nRetorno
.head 9 +  If saColunas[nAux] != STRING_Null
.head 10 -  Set sLinha =  sLinha || '"' || SalStrTrimX( saColunas[nAux] ) || '"' || ';'
.head 9 +  Else
.head 10 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, naColunas[nAux], COL_GetPos )
.head 10 -  Call SalTblGetColumnTitle( hWndCol, sColuna, 100 )
.head 10 -  Set sLinha = sLinha || '"' || SalStrTrimX( sColuna ) || '"' || ';'
.head 9 -  Set nAux = nAux + 1
.head 8 -  !
.head 8 +  If SalStrLength( sLinha ) > 0
.head 9 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 9 -  Call SalFilePutStr( fhArquivoCSV, sLinha )
.head 8 -  !
.head 8 -  ! Percorre a tabela e salva os valores da colunas no arquivo
.head 8 -  !
.head 8 -  Set nLinha = 0
.head 8 +  While SalTblSetContext( hWndItem, nLinha )
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nAux =0
.head 9 -  !
.head 9 +  While nAux <= nRetorno
.head 10 +  If naColunas[nAux] = -1
.head 11 -  Set sLinha = sLinha || ';'
.head 10 +  Else
.head 11 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, naColunas[nAux], COL_GetPos )
.head 11 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 11 +  If SalStrScan( sColuna,  ';' ) >= 0
.head 12 +  While SalStrScan( sColuna, ';' ) > 0
.head 13 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 11 +  If SalStrScan( sColuna,  SalNumberToChar ( 13 ) ) >= 0
.head 12 +  While SalStrScan( sColuna, SalNumberToChar ( 13 )  ) > 0
.head 13 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 13 )  ), 1, ' ' )
.head 11 +  If SalStrScan( sColuna,  SalNumberToChar ( 10 ) ) >= 0
.head 12 +  While SalStrScan( sColuna, SalNumberToChar ( 10 )  ) > 0
.head 13 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 10 )  ), 1, ' ' )
.head 11 -  ! @
.head 11 +  If not SalStrIsValidNumber( sColuna )
.head 12 +  If SalStrScan( sColuna, ';' ) >= 0
.head 13 +  While SalStrScan( sColuna, ';' ) > 0
.head 14 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 12 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 11 +  Else
.head 12 -  Set sLinha = sLinha || sColuna || ';'
.head 10 -  Set nAux = nAux + 1
.head 9 -  !
.head 9 +  If SalStrLength( sLinha ) > 0
.head 10 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 10 -  Call SalFilePutStr( fhArquivoCSV, sLinha )
.head 9 -  Set nLinha = nLinha + 1
.head 8 -  Call SalFileClose( fhArquivoCSV )
.head 5 +  Function: ImportaCSVColunas
.head 6 -  Description: PARAM 2 -> Passado a Ordem das colunas sendo a posição 0 do vetor a primeira coluna do arquivo
e o valor contido no vetor[posição] o ID da Coluna a ser preenchida
PARAM 3 -> Indice da coluna a ser verificada no arquivo, NUMBER_Null Insere Linha
PARAM 4 -> ID da Coluna para verificação e preenchimento da celula
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeArquivoCSV
.head 7 -  Number: naColunas[*]
.head 7 -  Number: nColunaArquivo
.head 7 -  Number: nColunaTabela
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nColuna
.head 7 -  Number: nLinha
.head 7 -  String: sLinha
.head 7 -  String: sLinhaOriginal
.head 7 -  String: sAux
.head 7 -  String: sAux2
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  Boolean: bCabecalho
.head 6 +  Actions
.head 7 -  ! Abre arquivo CSV
.head 7 -  Set bCabecalho = TRUE
.head 7 +  If VisFileOpen( fhArquivoCSV, sNomeArquivoCSV, OF_Read ) >= 0
.head 8 +  While VisFileReadString (fhArquivoCSV, sLinha ) >= 0
.head 9 -  Set nColuna = 0
.head 9 +  If SalStrScan( sLinha,  '"' ) >= 0
.head 10 +  While SalStrScan( sLinha, '"'  ) > 0
.head 11 -  Set sLinha = SalStrReplaceX( sLinha, SalStrScan( sLinha, '"' ), 1, ' ' )
.head 9 +  If bCabecalho
.head 10 -  Set bCabecalho = FALSE
.head 9 +  Else
.head 10 +  If nColunaArquivo = NUMBER_Null
.head 11 -  Call SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 11 +  While SalStrScan( sLinha, ';' ) >= 0
.head 12 -  Set sAux = SalStrTrimX(SalStrMidX( sLinha, 0, SalStrScan( sLinha, ';' ) ))
.head 12 +  If naColunas[nColuna] > 0
.head 13 -  Call SalTblSetColumnText( hWndItem, naColunas[nColuna], sAux )
.head 12 -  Set sLinha = SalStrMidX( sLinha, SalStrScan( sLinha, ';' ) + 1, SalStrLength( sLinha ) - SalStrLength( sAux ) )
.head 12 -  Set nColuna = nColuna + 1
.head 11 +  If naColunas[nColuna] > 0
.head 12 -  Call SalTblSetColumnText( hWndItem, naColunas[nColuna], SalStrTrimX( sLinha ) )
.head 10 +  Else
.head 11 -  Set sLinhaOriginal = sLinha
.head 11 -  ! @
.head 11 +  While SalStrScan( sLinha, ';' ) >= 0
.head 12 -  Set sAux = SalStrMidX( sLinha, 0, SalStrScan( sLinha, ';' ) )
.head 12 +  If nColuna = nColunaArquivo
.head 13 -  Set nLinha = 0
.head 13 +  While SalTblSetContext( hWndItem, nLinha )
.head 14 -  Call SalTblGetColumnText( hWndItem, nColunaTabela, sAux2 )
.head 14 +  If sAux2 = sAux
.head 15 -  Set nColuna = 0
.head 15 +  While SalStrScan( sLinhaOriginal, ';' ) >= 0
.head 16 -  Set sAux = SalStrMidX( sLinhaOriginal, 0, SalStrScan( sLinhaOriginal, ';' ) )
.head 16 +  If naColunas[nColuna] > 0
.head 17 -  Call SalTblSetColumnText( hWndItem, naColunas[nColuna], SalStrTrimX( sAux ) )
.head 16 -  Set sLinhaOriginal = SalStrMidX( sLinhaOriginal, SalStrScan( sLinhaOriginal, ';' ) + 1, SalStrLength( sLinhaOriginal ) - SalStrLength( sAux ) )
.head 16 -  Set nColuna = nColuna + 1
.head 15 +  If naColunas[nColuna] > 0
.head 16 -  Call SalTblSetColumnText( hWndItem, naColunas[nColuna], SalStrTrimX( sLinhaOriginal ) )
.head 15 -  Break
.head 14 -  Set nLinha = nLinha + 1
.head 13 -  Set sLinha = ''
.head 12 -  Set sLinha = SalStrMidX( sLinha, SalStrScan( sLinha, ';' ) + 1, SalStrLength( sLinha ) - SalStrLength( sAux ) )
.head 12 -  Set nColuna = nColuna + 1
.head 10 -  ! Ultima Coluna
.head 8 -  Call VisFileClose (fhArquivoCSV)
.head 5 +  Function: getLinhaCabecalho		!!RRBGOMES 31/08/2012
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Boolean: bApenasVisiveis
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  String: sRetorno
.head 7 -  String: sColuna
.head 7 -  Boolean: bAdicionaValorColuna
.head 6 +  Actions
.head 7 -  Set nPosColuna = 1
.head 7 -  Set sRetorno = STRING_Null
.head 7 +  Loop
.head 8 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 8 +  If hWndCol = hWndNULL
.head 9 -  Break
.head 8 -  !
.head 8 +  If bApenasVisiveis
.head 9 -  Set bAdicionaValorColuna = FALSE
.head 9 +  If SalIsWindowVisible( hWndCol ) > 0
.head 10 -  Set bAdicionaValorColuna = TRUE
.head 8 +  Else
.head 9 -  Set bAdicionaValorColuna = TRUE
.head 8 -  !
.head 8 +  If bAdicionaValorColuna
.head 9 -  Call SalTblGetColumnTitle( hWndCol, sColuna, 100 )
.head 9 -  Set sRetorno = sRetorno || '"' || SalStrTrimX( sColuna ) || '"' || ';'
.head 8 -  !
.head 8 -  Set nPosColuna = nPosColuna + 1
.head 7 -  Return SalStrLeftX( sRetorno, SalStrLength( sRetorno ) - 1)
.head 5 +  Function: getTotalColunas		!!RRBGOMES 31/08/2012
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  String: sRetorno
.head 7 -  String: sColuna
.head 6 +  Actions
.head 7 -  Set nPosColuna = 1
.head 7 -  Set nTotalColunas = 0
.head 7 +  Loop
.head 8 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 8 +  If hWndCol = hWndNULL
.head 9 -  Set nTotalColunas = nPosColuna - 1
.head 9 -  Break
.head 8 -  Set nPosColuna = nPosColuna + 1
.head 7 -  Return nTotalColunas
.head 5 +  Function: ExportaCSV		        !!RRBGOMES 31/08/2012 -- FDE-7749
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeArquivoCSV
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  !
.head 7 -  Call ExportaCSV_ColunaBase( sNomeArquivoCSV, NUMBER_Null, FALSE, FALSE, FALSE, FALSE )
.head 5 +  Function: ExportaCSV_ColunaVisiveis	!!RRBGOMES 31/08/2012 -- FDE-7749
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ExportaCSV_ColunaBase( spNomeArquivo, NUMBER_Null, TRUE, TRUE, TRUE, FALSE )
.head 5 +  Function: ExportaCSV_MarcadaExclusao	!! -- FDE-7749
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call ExportaCSV_ColunaBase( spNomeArquivo, NUMBER_Null, TRUE, TRUE, TRUE, TRUE )
.head 5 +  Function: ExportaCSV_ColunaBase	        !!RRBGOMES 31/08/2012 -- FDE-7749
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: spNomeArquivo
.head 7 -  Number: nColunaQuebra !NUMBER_NULL sem quebra
.head 7 -  Boolean: bApenasVisiveis
.head 7 -  Boolean: bExibirDlgSalvarArquivo
.head 7 -  Boolean: bExibirMeter
.head 7 -  Boolean: bApenasMarcadasExclusao
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  !
.head 7 -  ! Variaveis para manipulação das colunas
.head 7 -  !
.head 7 -  Number: nPosColuna
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: nTotalColunas
.head 7 -  !
.head 7 -  ! Variáveis para manipulação das linhas
.head 7 -  !
.head 7 -  Number: nLinha
.head 7 -  String: sPrimeiraLinha
.head 7 -  String: sLinha
.head 7 -  String: sColuna
.head 7 -  !
.head 7 -  ! Variaveis para manipulação do arquivo
.head 7 -  !
.head 7 -  File Handle: fhArquivoCSV
.head 7 -  String: sDrive
.head 7 -  String: sDiretorio
.head 7 -  String: sBase
.head 7 -  String: sExt
.head 7 -  !
.head 7 -  String: saColunas[*]
.head 7 -  Number: nIndex
.head 7 -  String: sCaminhoOriginal
.head 7 -  String: sCaminho
.head 7 -  String: sTexto
.head 7 -  Number: nQtdeLinhas
.head 7 -  !
.head 7 -  String: sNomeQuebraOld
.head 7 -  String: sNomeQuebra
.head 7 -  Boolean: bAdicionaValorColuna
.head 6 +  Actions
.head 7 -  Set nQtdeLinhas = CountRow () + 0
.head 7 +  If nQtdeLinhas = 0 and bExibirDlgSalvarArquivo
.head 8 -  Call SalMessageBox( 'Não existe dados para serem exportados.', 'Atenção', MB_Ok )
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Set saColunas[0] = 'Arquivo Excel( Extensão CSV )'
.head 7 -  Set saColunas[1] = '*.csv'
.head 7 -  Set nIndex = 0
.head 7 +  If bExibirDlgSalvarArquivo
.head 8 +  If Not SalDlgSaveFile( hWndForm, 'Salvar como', saColunas, 2, nIndex, spNomeArquivo, sCaminho )
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If SalStrScan( SalStrUpperX( spNomeArquivo) , '.CSV' ) < 0
.head 9 -  Set spNomeArquivo =  spNomeArquivo || '.csv'
.head 8 -  Call VisDosSplitPath( spNomeArquivo, sDrive, sDiretorio, sBase, sExt )
.head 8 +  If not VisDosExist( sDrive || sDiretorio )
.head 9 -  Set spNomeArquivo = sBase || sExt
.head 9 -  Call VisDosSplitPath( strArgArray[0], sDrive, sDiretorio, sBase, sExt )
.head 9 -  Set spNomeArquivo = sDrive || sDiretorio || spNomeArquivo
.head 8 -  Set sCaminho = spNomeArquivo
.head 7 -  !
.head 7 +  If 1
.head 8 -  Call SalTblSetContext( hWndItem, 0 )
.head 8 -  !
.head 8 +  If nColunaQuebra != NUMBER_Null
.head 9 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nColunaQuebra, COL_GetPos )
.head 9 +  If SalIsWindowVisible( hWndCol ) > 0
.head 10 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sNomeQuebra )
.head 10 -  Set sNomeQuebra = RetiraMarcasGeral( sNomeQuebra )
.head 9 -  Set sCaminhoOriginal = VisStrSubstitute( sCaminho, '.csv', '' )
.head 9 -  Set sCaminhoOriginal = VisStrSubstitute( sCaminhoOriginal, '.CSV', '' )
.head 9 -  Set sCaminho = sCaminhoOriginal || sNomeQuebra || '.csv'
.head 9 -  Set sNomeQuebraOld = sNomeQuebra
.head 8 -  !
.head 8 +  If VisDosExist( sCaminho )
.head 9 +  If VisFileDelete( sCaminho ) < 0
.head 10 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 10 -  Return 0
.head 8 -  !
.head 8 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) = VTERR_Ok
.head 9 -  Set nPosColuna = 1
.head 9 -  Set sLinha = STRING_Null
.head 9 -  Set nTotalColunas = getTotalColunas ()
.head 9 -  Set sPrimeiraLinha = getLinhaCabecalho ( bApenasVisiveis )
.head 9 +  If SalStrLength( sPrimeiraLinha ) > 0
.head 10 -  Call VisFileWriteString( fhArquivoCSV, sPrimeiraLinha )
.head 9 -  !
.head 9 -  Set nLinha = 0
.head 9 +  If bExibirMeter
.head 10 -  Call SonMeter( 1, 0, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 +  While SalTblSetContext( hWndItem, nLinha )
.head 10 -  Set bAdicionaValorColuna = TRUE
.head 10 +  If bApenasMarcadasExclusao
.head 11 +  If not SalTblQueryRowFlags( hWndItem, nLinha, ROW_MarkDeleted )
.head 12 -  Set bAdicionaValorColuna = FALSE
.head 10 -  !
.head 10 +  If bAdicionaValorColuna
.head 11 -  ! FECHA E INICIA OUTRO ARQUIVO POR QUEBRA
.head 11 +  If nColunaQuebra != NUMBER_Null
.head 12 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nColunaQuebra, COL_GetPos )
.head 12 +  If SalIsWindowVisible( hWndCol ) > 0
.head 13 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sNomeQuebra )
.head 13 -  Set sNomeQuebra = RetiraMarcasGeral( sNomeQuebra )
.head 12 +  If sNomeQuebra != sNomeQuebraOld
.head 13 -  Call VisFileClose( fhArquivoCSV )
.head 13 -  Set sCaminho = sCaminhoOriginal || sNomeQuebra || '.csv'
.head 13 +  If VisDosExist( sCaminho )
.head 14 +  If VisFileDelete( sCaminho ) < 0
.head 15 -  Call SalMessageBox( 'Arquivo está sendo usado. Feche a aplicação que está usando o arquivo e tente novamente.', 'Não pode ser aberto.', MB_IconExclamation)
.head 15 -  Return 0
.head 13 -  Set sNomeQuebraOld = sNomeQuebra
.head 13 +  If VisFileOpen( fhArquivoCSV, sCaminho, OF_Create | OF_Append ) != VTERR_Ok
.head 14 -  Return FALSE
.head 13 -  Call VisFileWriteString( fhArquivoCSV, sPrimeiraLinha )
.head 11 -  !
.head 11 -  Set sLinha = STRING_Null
.head 11 -  Set nPosColuna = 1
.head 11 +  While nPosColuna <= nTotalColunas
.head 12 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nPosColuna, COL_GetPos )
.head 12 -  !
.head 12 +  If bApenasVisiveis
.head 13 +  If SalIsWindowVisible( hWndCol ) > 0
.head 14 -  Set bAdicionaValorColuna = TRUE
.head 13 +  Else
.head 14 -  Set bAdicionaValorColuna = FALSE
.head 12 +  Else
.head 13 -  Set bAdicionaValorColuna = TRUE
.head 12 -  !
.head 12 +  If bAdicionaValorColuna
.head 13 -  Call SalTblGetColumnText( hWndItem, SalTblQueryColumnID( hWndCol ), sColuna )
.head 13 -  !
.head 13 +  ! If SalStrScan( sColuna,  ';' ) >= 0
.head 14 +  While SalStrScan( sColuna, ';' ) > 0
.head 15 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, ';' ), 1, ' ' )
.head 13 -  Set sColuna = VisStrSubstitute( sColuna, ';', '' )
.head 13 +  ! If SalStrScan( sColuna,  SalNumberToChar ( 13 ) ) >= 0
.head 14 +  While SalStrScan( sColuna, SalNumberToChar ( 13 )  ) >= 0
.head 15 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 13 )  ), 1, ' ' )
.head 13 -  Set sColuna = VisStrSubstitute( sColuna, SalNumberToChar ( 13 ), ' ' )
.head 13 +  ! If SalStrScan( sColuna,  SalNumberToChar ( 10 ) ) >= 0
.head 14 +  While SalStrScan( sColuna, SalNumberToChar ( 10 )  ) >= 0
.head 15 -  Set sColuna = SalStrReplaceX( sColuna, SalStrScan( sColuna, SalNumberToChar ( 10 )  ), 1, ' ' )
.head 13 -  Set sColuna = VisStrSubstitute( sColuna, SalNumberToChar ( 10 ), ' ' )
.head 13 -  Set sColuna = VisStrSubstitute( sColuna, '"', '' )
.head 13 +  If not SalStrIsValidNumber( sColuna )
.head 14 -  Set sLinha = sLinha || '"' || sColuna || '"' ||  ';'
.head 13 +  Else
.head 14 -  Set sLinha = sLinha || sColuna || ';'
.head 12 -  !
.head 12 -  Set nPosColuna = nPosColuna + 1
.head 11 -  !
.head 11 +  If bExibirMeter
.head 12 -  Call SonMeter( 1, nLinha * 100 / nQtdeLinhas, 1, 'Gerando arquivo CSV em ' || sCaminho )
.head 11 -  !
.head 11 +  If SalStrLength( sLinha ) > 0
.head 12 -  Set sLinha = SalStrLeftX( sLinha, SalStrLength( sLinha ) - 1)
.head 12 -  Call VisFileWriteString( fhArquivoCSV, sLinha )
.head 10 -  !
.head 10 -  Set nLinha = nLinha + 1
.head 9 +  If bExibirMeter
.head 10 -  Call SonMeter( 1, 100, 1, 'Arquivo CSV em ' || sCaminho )
.head 9 -  !
.head 9 -  Call VisFileClose( fhArquivoCSV )
.head 9 +  If VisDosExist( sCaminho )
.head 10 -  Call SalMessageBox( 'Exportação CSV finalizada com sucesso.', 'Arquivo gerado', MB_IconAsterisk )
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Arquivo não encontrado. Problema ao gravar o arquivo em disco.', 'Erro na exportação', MB_IconStop)
.head 10 -  Return FALSE
.head 5 -  !
.head 5 +  Function: NegritaColuna
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nColuna
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinhaAnt
.head 6 +  Actions
.head 7 -  Set nLinhaAnt = SalTblQueryContext(hWndItem)
.head 7 -  Call SalTblSetContext(hWndItem, nLinha )
.head 7 -  Call XSalTblSetColumnFontName(  SalTblGetColumnWindow( hWndItem, nColuna, COL_GetID ), "Arial", 8, FONT_EnhBold   )
.head 7 -  Call SalTblSetContext(hWndItem, nLinhaAnt )
.head 5 +  Function: InitSearch
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nRowsParam
.head 7 -  Window Handle: hWndColSearchParam
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set hWndColSearch = hWndColSearchParam
.head 7 -  Set nRows = nRowsParam
.head 7 -  Call SalTblSetRange( hWndItem, 0, nRows-1 )
.head 7 -  Set nRow = 0
.head 7 -  Call SalTblSetContext( hWndItem, nRow )
.head 5 +  Function: Search
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndFieldParam
.head 7 -  Boolean: bSelectAll
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set hWndField = hWndFieldParam
.head 7 -  ! Call TblSortIncreasing( nCol )
.head 7 -  Set bCresente = TRUE
.head 7 -  Set nRow = 0
.head 7 -  Call SalGetWindowText( hWndField, sText, 100 )
.head 7 -  Call SalTblSetFlagsAnyRows ( hWndItem, ROW_Selected, FALSE, 0, 0 )
.head 7 -  !
.head 7 -  ! first check for valid 'a' to 'z' or '_' -- search field is lower case
.head 7 +  If NOT SalIsNull( hWndField ) AND SalStrRightX( sText, 1 ) != ' ' AND
   (SalStrRightX( sText, 1 ) < 'A' OR SalStrRightX( sText, 1 ) > 'z') AND
   (SalStrRightX( sText, 1 ) < '.' OR SalStrRightX( sText, 1 ) > '9')
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_Selected, FALSE )
.head 7 +  If NOT SalIsNull( hWndField )
.head 8 -  Set nLen = SalStrLength( sText )
.head 8 +  If nLen < nLastLen OR bSelectAll
.head 9 -  Set nStart = 0
.head 9 -  Set nEnd = nRows
.head 8 +  Else
.head 9 -  Set nStart = nRow
.head 9 -  Set nEnd = nRows-1
.head 8 -  !
.head 8 +  Loop
.head 9 -  Set nRow = SalNumberRound( (nStart+nEnd) / 2 )
.head 9 -  Call SalTblFetchRow( hWndItem, nRow )
.head 9 -  Call SalGetWindowText( hWndColSearch, sTag, 100 )
.head 9 -  Set sTag = SalStrLeftX( sTag, nLen )
.head 9 +  If SalStrUpperX( sText ) > SalStrUpperX( sTag )
.head 10 -  Set nStart = nRow+1
.head 9 +  Else
.head 10 -  Set nEnd = nRow-1
.head 9 -  !
.head 9 +  If ((SalStrUpperX( sText ) = SalStrUpperX( sTag) ) AND (nStart > nEnd)) OR (nStart > nRows) OR nRow = nStart
.head 10 +  If nStart > nRows
.head 11 -  Set nRow = nRows-1
.head 10 -  Break
.head 8 -  !
.head 8 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_Selected, TRUE )
.head 8 -  Set nLastLen = nLen
.head 7 +  Else
.head 8 -  Set nRow = 0
.head 8 -  Set nLen = 0
.head 8 -  Set nLastLen = 0
.head 7 -  !
.head 7 -  Call SalTblSetContext( hWndItem, nRow )
.head 7 -  Call SalTblScroll( hWndItem, nRow, hWndNULL, TBL_AutoScroll )
.head 7 -  Return TRUE
.head 5 +  Function: SearchSoundex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndFieldParam
.head 7 -  Boolean: bSelectAll
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: oSoundex
.head 8 -  Class: fcSoundex
.head 6 +  Actions
.head 7 -  Set hWndField = hWndFieldParam
.head 7 -  ! Call TblSortIncreasing( nCol )
.head 7 -  Set bCresente = TRUE
.head 7 -  Set nRow = 0
.head 7 -  Call SalGetWindowText( hWndField, sText, 100 )
.head 7 -  Set sText = oSoundex.Soundex( sText )
.head 7 -  Call SalTblSetFlagsAnyRows ( hWndItem, ROW_Selected, FALSE, 0, 0 )
.head 7 -  !
.head 7 -  ! first check for valid 'a' to 'z' or '_' -- search field is lower case
.head 7 +  If NOT SalIsNull( hWndField ) AND SalStrRightX( sText, 1 ) != ' ' AND
   (SalStrRightX( sText, 1 ) < 'A' OR SalStrRightX( sText, 1 ) > 'z') AND
   (SalStrRightX( sText, 1 ) < '.' OR SalStrRightX( sText, 1 ) > '9')
.head 8 -  Return FALSE
.head 7 -  !
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_Selected, FALSE )
.head 7 +  If NOT SalIsNull( hWndField )
.head 8 -  Set nLen = SalStrLength( sText )
.head 8 +  If nLen < nLastLen OR bSelectAll
.head 9 -  Set nStart = 0
.head 9 -  Set nEnd = nRows
.head 8 +  Else
.head 9 -  Set nStart = nRow
.head 9 -  Set nEnd = nRows-1
.head 8 -  !
.head 8 +  Loop
.head 9 -  Set nRow = SalNumberRound( (nStart+nEnd) / 2 )
.head 9 -  Call SalTblFetchRow( hWndItem, nRow )
.head 9 -  Call SalGetWindowText( hWndColSearch, sTag, 100 )
.head 9 -  Set sTag = oSoundex.Soundex( SalStrLeftX( sTag, nLen ) )
.head 9 +  If SalStrUpperX( sText ) > SalStrUpperX( sTag )
.head 10 -  Set nStart = nRow+1
.head 9 +  Else
.head 10 -  Set nEnd = nRow-1
.head 9 -  !
.head 9 +  If ((SalStrUpperX( sText ) = SalStrUpperX( sTag) ) AND (nStart > nEnd)) OR (nStart > nRows) OR nRow = nStart
.head 10 +  If nStart > nRows
.head 11 -  Set nRow = nRows-1
.head 10 -  Break
.head 8 -  !
.head 8 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_Selected, TRUE )
.head 8 -  Set nLastLen = nLen
.head 7 +  Else
.head 8 -  Set nRow = 0
.head 8 -  Set nLen = 0
.head 8 -  Set nLastLen = 0
.head 7 -  !
.head 7 -  Call SalTblSetContext( hWndItem, nRow )
.head 7 -  Call SalTblScroll( hWndItem, nRow, hWndNULL, TBL_AutoScroll )
.head 7 -  Return TRUE
.head 5 +  Function: SetSelecaoMultipla
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bSelecaoMultipla
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bMultiSelect = bSelecaoMultipla
.head 5 +  Function: GetLinhasSelecionadas
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Receive Number: nSelecionadas[*]
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return VisArrayCopy( nLinhasSelecionadas, nSelecionadas, DT_Number )
.head 5 +  Function: SetFocus
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nCol
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nLinha < 0
.head 8 -  Set nLinha = SalTblQueryContext( hWndItem )
.head 7 -  Call SalTblSetFocusCell( hWndItem, nLinha, SalTblGetColumnWindow( hWndItem, nCol, 0 ), -1, -1 )
.head 5 +  Function: CountRow
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nConta
.head 7 -  Number: nLinhaContexto
.head 6 +  Actions
.head 7 -  Set nLinhaContexto = SalTblQueryContext( hWndItem )
.head 7 -  Set nConta = 0
.head 7 +  While SalTblSetContext( hWndItem, nConta )
.head 8 -  Set nConta = nConta + 1
.head 7 -  Call SalTblSetContext( hWndItem, nLinhaContexto )
.head 7 -  Return nConta
.head 5 +  Function: SetContext
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalTblSetContext( hWndItem, nLinha )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 -  !
.head 5 +  Function: EscondeLinha
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nRow
.head 7 -  Boolean: bHide
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_Hidden, bHide )
.head 5 +  Function: EscondeRowHeader
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblDefineRowHeader( hWndItem, '', 0, TBL_RowHdr_Visible, hWndNULL )
.head 5 -  !
.head 5 +  ! Function: ColoreDesabilitadas
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hWndColuna
.head 7 -  Number: nColuna
.head 6 +  Actions
.head 7 -  Set nColuna = 1
.head 7 -  Set hWndColuna = SalTblGetColumnWindow( hWndItem, nColuna, COL_GetPos )
.head 7 +  While hWndColuna != hWndNULL
.head 8 +  If not SalTblQueryColumnFlags( hWndColuna, COL_Editable )
.head 9 -  Call XSalTblSetColumnBackColor( hWndColuna, SalColorFromRGB( 240, 240, 240 ) )
.head 8 -  Set nColuna = nColuna + 1
.head 8 -  Set hWndColuna = SalTblGetColumnWindow( hWndItem, nColuna, COL_GetPos )
.head 4 +  Message Actions
.head 5 +  On PAM_NewRecord
.head 6 -  ! Call SetSelecaoMultipla( TRUE )
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 +  ! If bColorirDesabilitadas
.head 7 -  Call ColoreDesabilitadas( )
.head 5 +  On PAM_RecordExist
.head 6 -  ! Call SetSelecaoMultipla( TRUE )
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 +  ! If bColorirDesabilitadas
.head 7 -  Call ColoreDesabilitadas( )
.head 5 +  On PAM_Reset
.head 6 -  Call SalTblReset( hWndItem )
.head 6 -  Call SetSelecaoMultipla( TRUE )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
.head 6 -  Call SalEnableWindow( hWndItem )
.head 5 +  ! On SAM_KillFocus
.head 6 -  Set hWndDataFieldAnterior = hWndItem
.head 5 +  On PAM_Habilita
.head 6 +  If wParam = TRUE
.head 7 -  Call SalEnableWindow( hWndItem )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( hWndItem )
.head 5 +  On WM_ENABLE
.head 6 +  If wParam
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_White )
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 6 +  Else
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_LightGray )
.head 7 -  Call SalColorSet( hWndItem, COLOR_IndexWindowText, COLOR_Black )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Set nCol = 1
.head 6 +  While SalTblGetColumnWindow( hWndItem, nCol, COL_GetID )
.head 7 +  If SalTblQueryColumnFlags( SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ), COL_Selected )
.head 8 -  Break
.head 7 -  Set nCol = nCol + 1
.head 6 +  If not bCresente
.head 7 -  Call TblSortIncreasing( nCol )
.head 7 -  Set bCresente = TRUE
.head 6 +  Else
.head 7 -  Call TblSortDecreasing( nCol )
.head 7 -  Set bCresente = FALSE
.head 6 -  Call SalTblSetColumnFlags( SalTblGetColumnWindow( hWndItem, nCol, COL_GetID ), COL_Selected, FALSE )
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressRowLines, TRUE )
.head 6 -  ! Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressLastColLine, TRUE )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SelectableCols, TRUE )
.head 6 -  Call ttAttachWindow ( hWndItem, '' )
.head 5 +  On SAM_RowHeaderClick
.head 6 +  If bMultiSelect
.head 7 +  If SalTblQueryRowFlags( hWndItem, SalTblQueryContext( hWndItem ), ROW_MarkDeleted )
.head 8 -  Call SalTblSetRowFlags( hWndItem, SalTblQueryContext( hWndItem ), ROW_MarkDeleted, FALSE )
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags( hWndItem, SalTblQueryContext( hWndItem ), ROW_MarkDeleted, TRUE )
.head 6 +  Else
.head 7 -  Set nRow = SalTblQueryContext( hWndItem )
.head 7 -  Call DesmarcaTodas ()
.head 7 +  If SalTblQueryRowFlags( hWndItem, nRow, ROW_MarkDeleted )
.head 8 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_MarkDeleted, FALSE )
.head 7 +  Else
.head 8 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_MarkDeleted, TRUE )
.head 5 -  !
.head 5 +  ! On AM_TOOLTIP_NeedText
.head 6 -  Return OnToolTipNeedText ()
.head 3 +  Child Table Class: pcChildTableSemLinhaImprimivel
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000000
.head 5 -  Discardable? No
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,N,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcChildTableSemLinha
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  FunctionalVar: Titulos[*]
.head 6 -  Class: fcPrintTblLine
.head 5 -  FunctionalVar: CabecalhosDePagina[*]
.head 6 -  Class: fcPrintTblLine
.head 5 -  FunctionalVar: RodapesDePagina[*]
.head 6 -  Class: fcPrintTblLine
.head 5 -  String: sTituloDaJanelaDePreview
.head 5 -  String: sNomeDaImpressoraDestino
.head 5 -  Number: nNumeroDeCopias
.head 5 -  !
.head 5 -  Number: nMargemInferior
.head 5 -  Number: nMargemSuperior
.head 5 -  Number: nMargemEsquerda
.head 5 -  Number: nMargemDireita
.head 5 -  !
.head 5 -  Number: nOrientacao
.head 5 -  Number: nRowFlagsOnAImprimir
.head 5 -  Number: nRowFlagsOffAImprimir
.head 5 -  Number: nColumnFlagsOnAImprimir
.head 5 -  Number: nColumnFlagsOffAImprimir
.head 5 -  !
.head 5 -  Number: nTipoDeGradeAImprimir
.head 5 -  Number: nEscalaPercentual
.head 5 -  Boolean: bMostraONumeroDaPagina
.head 5 -  Boolean: bAjustaAAlturaDaLinhaAoTexto
.head 5 -  !
.head 5 -  Boolean: bMostraTituloDaColunas
.head 5 -  Window Handle: hWndMenuTblImp
.head 5 -  Boolean: bMenuFlutuante
.head 5 -  Number: nX
.head 5 -  Number: nY
.head 4 +  Functions
.head 5 +  Function: _Imprime
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Boolean: bVisualizarRelatorio_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: P
.head 8 -  Class: fcPrintTblParams
.head 7 -  FunctionalVar: pl
.head 8 -  Class: fcPrintTblLine
.head 7 -  Number: n
.head 7 -  Number: nRet
.head 7 -  Number: nUpper
.head 7 -  String: sText
.head 6 +  Actions
.head 7 -  Call SalWaitCursor( TRUE )
.head 7 -  !
.head 7 +  If NOT SalArrayIsEmpty( Titulos )
.head 8 -  Call SalArrayGetUpperBound( Titulos, 1, nUpper )
.head 8 -  Set n = 0
.head 8 +  While n <= nUpper
.head 9 -  Call P.AddTitle( Titulos[n] )
.head 9 -  Set n = n + 1
.head 7 -  !
.head 7 +  If NOT SalArrayIsEmpty( CabecalhosDePagina )
.head 8 -  Call SalArrayGetUpperBound( CabecalhosDePagina, 1, nUpper )
.head 8 -  Set n = 0
.head 8 +  While n <= nUpper
.head 9 -  Call P.AddPageHeader( CabecalhosDePagina[n] )
.head 9 -  Set n = n + 1
.head 7 -  !
.head 7 +  If NOT SalArrayIsEmpty( RodapesDePagina )
.head 8 -  Call SalArrayGetUpperBound( RodapesDePagina, 1, nUpper )
.head 8 -  Set n = 0
.head 8 +  While n <= nUpper
.head 9 -  Call P.AddPageFooter( RodapesDePagina[n] )
.head 9 -  Set n = n + 1
.head 7 -  !
.head 7 -  Set P.Orientation = nOrientacao
.head 7 -  !
.head 7 -  Set P.RowFlagsOn = nRowFlagsOnAImprimir
.head 7 -  Set P.RowFlagsOff = nRowFlagsOffAImprimir
.head 7 -  !
.head 7 -  Set P.ColFlagsOn = nColumnFlagsOnAImprimir
.head 7 -  Set P.ColFlagsOff = nColumnFlagsOffAImprimir
.head 7 -  !
.head 7 -  Set P.GridType = nTipoDeGradeAImprimir
.head 7 -  !
.head 7 +  If nEscalaPercentual > 0
.head 8 -  Set P.Scale = SalNumberMin( 5, nEscalaPercentual / 100 )
.head 7 +  Else
.head 8 -  Set P.Scale = 0
.head 7 -  !
.head 7 -  Set P.Copies = nNumeroDeCopias
.head 7 -  !
.head 7 -  Set P.LeftMargin = nMargemEsquerda
.head 7 -  Set P.TopMargin = nMargemSuperior
.head 7 -  Set P.RightMargin = nMargemDireita
.head 7 -  Set P.BottomMargin = nMargemInferior
.head 7 -  !
.head 7 +  If sNomeDaImpressoraDestino != STRING_Null
.head 8 -  Set P.PrinterName = sNomeDaImpressoraDestino
.head 7 +  Else
.head 8 -  Set P.PrinterName = STRING_Null
.head 7 -  !
.head 7 +  If sTituloDaJanelaDePreview != STRING_Null
.head 8 -  Set P.PrevWndTitle = sTituloDaJanelaDePreview
.head 7 +  Else If not SalArrayIsEmpty( Titulos )
.head 8 +  If Titulos[0].CenterText != STRING_Null
.head 9 -  Set P.PrevWndTitle = Titulos[0].CenterText
.head 8 +  Else If Titulos[0].LeftText != STRING_Null
.head 9 -  Set P.PrevWndTitle = Titulos[0].LeftText
.head 8 +  Else If Titulos[0].RightText != STRING_Null
.head 9 -  Set P.PrevWndTitle = Titulos[0].RightText
.head 8 +  Else
.head 9 -  Set P.PrevWndTitle = STRING_Null
.head 7 -  !
.head 7 -  Set P.Language = PTBL_LNG_ENGLISH
.head 7 -  !
.head 7 -  Set P.Preview = bVisualizarRelatorio_p
.head 7 -  Set P.PageNrs = bMostraONumeroDaPagina
.head 7 -  Set P.VarRowHeight = bAjustaAAlturaDaLinhaAoTexto
.head 7 -  Set P.ColHeaders = bMostraTituloDaColunas
.head 7 -  ! Print
.head 7 -  Set nRet = PrintTbl( hWndItem, P )
.head 7 -  !
.head 7 +  If nRet < 1
.head 8 +  Select Case nRet
.head 9 +  Case PTBL_ERR_MARGINS_TOO_BIG
.head 10 -  Set sText = "Margens muito grandes."
.head 10 -  Break
.head 9 +  Case PTBL_ERR_NO_COLS_TO_PRINT
.head 10 -  Set sText = "Nenhuma coluna a ser impressa."
.head 10 -  Break
.head 9 +  Case PTBL_ERR_NO_PRINTER
.head 10 -  Set sText = "Não há nenhuma impressora intalada."
.head 10 -  Break
.head 9 +  Case PTBL_ERR_INVALID_PRINTER
.head 10 -  Set sText = "Nome da impressora inválido."
.head 10 -  Break
.head 9 +  Case PTBL_ERR_INITIALIZE
.head 10 -  Set sText = "Erro na inicialização."
.head 10 -  Break
.head 9 +  Default
.head 10 -  Set sText = "Falha de Impressão."
.head 10 -  Break
.head 8 -  Call SalMessageBox( sText, "Erro de impressão", MB_IconHand | MB_Ok )
.head 7 -  !
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  !
.head 7 -  Return nRet
.head 5 +  Function: _AdicionaLinha
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sTextoAlinhadoAEsquerda_p
.head 7 -  String: sTextoCentralizado_p
.head 7 -  String: sTextoAlinhadoADireita_p
.head 7 -  Number: nMultiplicadorDoTamanhoDaFonte_p
.head 7 -  Number: nFormatacaoDaFonte_p
.head 7 -  Number: nCorDaFonte_p
.head 7 -  FunctionalVar: ptLinha_p[*]
.head 8 -  Class: fcPrintTblLine
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( ptLinha_p )
.head 8 -  Call SalArrayGetUpperBound( ptLinha_p, 1, nIndice )
.head 8 -  Set nIndice = nIndice + 1
.head 7 +  Else
.head 8 -  Set nIndice = 0
.head 7 -  !
.head 7 -  Set ptLinha_p[nIndice].LeftText = sTextoAlinhadoAEsquerda_p
.head 7 -  Set ptLinha_p[nIndice].CenterText = sTextoCentralizado_p
.head 7 -  Set ptLinha_p[nIndice].RightText = sTextoAlinhadoADireita_p
.head 7 -  Set ptLinha_p[nIndice].FontSizeMulti = nMultiplicadorDoTamanhoDaFonte_p
.head 7 -  Set ptLinha_p[nIndice].FontEnh = nFormatacaoDaFonte_p
.head 7 -  Set ptLinha_p[nIndice].FontColor = nCorDaFonte_p
.head 7 -  Return nIndice
.head 5 -  !
.head 5 +  Function: AdicionaTitulo
.head 6 -  Description: Podem ser adicionadas várias linhas de título.
Cada uma com possibilidade de personalizar o texto do título, o tamanho da fonte, a formatação e a cor.
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  ! Todos os titulos podem ser usados ao mesmo tempo
.head 7 +  String: sTituloAlinhadoAEsquerda_p
.head 8 -  ! Texto que aparecerá a esquerda como parte do título do relatório
.head 7 +  String: sTituloCentralizado_p
.head 8 -  ! Texto que aparecerá centralizado como parte do título do relatório
.head 7 +  String: sTituloAlinhadoADireita_p
.head 8 -  ! Texto que aparecerá a direita como parte do título do relatório
.head 7 +  Number: nMultiplicadorDoTamanhoDaFonte_p
.head 8 -  ! Usando 1 a fonte terá o tamanho normal
.head 7 +  Number: nFormatacaoDaFonte_p
.head 8 -  ! Podem ser usados  FONT_EnhBold, FONT_EnhItalic, FONT_EnhUnderline, FONT_EnhStrikeOut. Podem ser combinadas com | .
.head 7 +  Number: nCorDaFonte_p
.head 8 -  ! Podem ser usadas as constantes COLOR_*
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return _AdicionaLinha( sTituloAlinhadoAEsquerda_p, sTituloCentralizado_p, sTituloAlinhadoADireita_p, nMultiplicadorDoTamanhoDaFonte_p, nFormatacaoDaFonte_p, nCorDaFonte_p, Titulos )
.head 5 +  Function: LimpaTitulos
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( Titulos, 1, -1 )
.head 5 -  !
.head 5 +  Function: AdicionaCabecalhoDePagina
.head 6 -  Description: Podem ser adicionadas várias linhas de cabeçalho de página.
Cada uma com possibilidade de personalizar o texto, o tamanho da fonte, a formatação e a cor.
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  ! Todos os titulos podem ser usados ao mesmo tempo
.head 7 +  String: sCabecalhoAlinhadoAEsquerda_p
.head 8 -  ! Texto que aparecerá a esquerda como parte do título do relatório
.head 7 +  String: sCabecalhoCentralizado_p
.head 8 -  ! Texto que aparecerá centralizado como parte do título do relatório
.head 7 +  String: sCabecalhoAlinhadoADireita_p
.head 8 -  ! Texto que aparecerá a direita como parte do título do relatório
.head 7 +  Number: nMultiplicadorDoTamanhoDaFonte_p
.head 8 -  ! Usando 1 a fonte terá o tamanho normal
.head 7 +  Number: nFormatacaoDaFonte_p
.head 8 -  ! Podem ser usados  FONT_EnhBold, FONT_EnhItalic, FONT_EnhUnderline, FONT_EnhStrikeOut. Podem ser combinadas com | .
.head 7 +  Number: nCorDaFonte_p
.head 8 -  ! Podem ser usadas as constantes COLOR_*
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return _AdicionaLinha( sCabecalhoAlinhadoAEsquerda_p, sCabecalhoCentralizado_p, sCabecalhoAlinhadoADireita_p, nMultiplicadorDoTamanhoDaFonte_p, nFormatacaoDaFonte_p, nCorDaFonte_p, CabecalhosDePagina )
.head 5 +  Function: LimpaCabecalhosDePagina
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( CabecalhosDePagina, 1, -1 )
.head 5 -  !
.head 5 +  Function: AdicionaRodapeDePagina
.head 6 -  Description: Podem ser adicionadas várias linhas de rodapés de página.
Cada uma com possibilidade de personalizar o texto, o tamanho da fonte, a formatação e a cor.
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  ! Todos os titulos podem ser usados ao mesmo tempo
.head 7 +  String: sRodapeAlinhadoAEsquerda_p
.head 8 -  ! Texto que aparecerá a esquerda como parte do título do relatório
.head 7 +  String: sRodapeCentralizado_p
.head 8 -  ! Texto que aparecerá centralizado como parte do título do relatório
.head 7 +  String: sRodapeAlinhadoADireita_p
.head 8 -  ! Texto que aparecerá a direita como parte do título do relatório
.head 7 +  Number: nMultiplicadorDoTamanhoDaFonte_p
.head 8 -  ! Usando 1 a fonte terá o tamanho normal
.head 7 +  Number: nFormatacaoDaFonte_p
.head 8 -  ! Podem ser usados  FONT_EnhBold, FONT_EnhItalic, FONT_EnhUnderline, FONT_EnhStrikeOut. Podem ser combinadas com | .
.head 7 +  Number: nCorDaFonte_p
.head 8 -  ! Podem ser usadas as constantes COLOR_*
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return _AdicionaLinha( sRodapeAlinhadoAEsquerda_p, sRodapeCentralizado_p, sRodapeAlinhadoADireita_p, nMultiplicadorDoTamanhoDaFonte_p, nFormatacaoDaFonte_p, nCorDaFonte_p, RodapesDePagina )
.head 5 +  Function: LimpaRodapesDePagina
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( RodapesDePagina, 1, -1 )
.head 5 -  !
.head 5 +  Function: AlteraTituloDaJanelaDePreview
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sTituloDaJanelaDePreview_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sTituloDaJanelaDePreview = sTituloDaJanelaDePreview_p
.head 5 +  Function: AlteraTextoTitulo
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 +  String: sTituloAlinhadoAEsquerda_p
.head 8 -  ! Texto que aparecerá a esquerda como parte do título do relatório
.head 7 +  String: sTituloCentralizado_p
.head 8 -  ! Texto que aparecerá centralizado como parte do título do relatório
.head 7 +  String: sTituloAlinhadoADireita_p
.head 8 -  ! Texto que aparecerá a direita como parte do título do relatório
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( Titulos )
.head 8 -  Set Titulos[0].LeftText = sTituloAlinhadoAEsquerda_p
.head 8 -  Set Titulos[0].RightText = sTituloAlinhadoADireita_p
.head 8 -  Set Titulos[0].CenterText = sTituloCentralizado_p
.head 7 +  Else
.head 8 -  Call AdicionaTitulo ( sTituloAlinhadoAEsquerda_p, sTituloCentralizado_p, sTituloAlinhadoADireita_p, 1, FONT_EnhBold, COLOR_Black )
.head 5 +  Function: AlteraNomeDaImpressoraDestino
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeDaImpressoraDestino_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNomeDaImpressoraDestino = sNomeDaImpressoraDestino_p
.head 5 +  Function: AlteraNumeroDeCopias
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nNumeroDeCopias_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nNumeroDeCopias = nNumeroDeCopias_p
.head 5 +  Function: AlteraMargens
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nMargemDireita_p
.head 7 -  Number: nMargemEsquerda_p
.head 7 -  Number: nMargemSuperior_p
.head 7 -  Number: nMargemInferior_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nMargemDireita = nMargemDireita_p
.head 7 -  Set nMargemEsquerda = nMargemEsquerda_p
.head 7 -  Set nMargemInferior = nMargemInferior_p
.head 7 -  Set nMargemSuperior = nMargemSuperior_p
.head 5 +  Function: AlteraOrientacaoParaRetrato
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nOrientacao = PTBL_PORTRAIT
.head 5 +  Function: AlteraOrientacaoParaPaisagem
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nOrientacao = PTBL_LANDSCAPE
.head 5 -  !
.head 5 +  Function: AlteraRowFlagsAImprimir
.head 6 -  Description: Por padrão todas as linhas visiveis ou invisiveis da tabela serão impressas.
É possivel selecionar apenas algumas linhas para imprimir fazendo uso das constantes ROW_*
que são utilizadas para flegar as linhas pelo comando SalTblSetRowFlags
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nRowFlagsOn_p
.head 7 -  Number: nRowFlagsOff_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nRowFlagsOnAImprimir = nRowFlagsOn_p
.head 7 -  Set nRowFlagsOffAImprimir = nRowFlagsOff_p
.head 5 +  Function: AlteraColumnFlagsAImprimir
.head 6 -  Description: Por padrão todas as colunas da tabela serão impressas.
É possivel selecionar apenas algumas colunas para imprimir fazendo uso das constantes COL_*
que são utilizadas para flegar as linhas pelo comando SalTblSetColumnFlags
Constante nao documentada incluida: COL_Visible = 1
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nColumnFlagsOn_p
.head 7 -  Number: nColumnFlagsOff_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nColumnFlagsOnAImprimir = nColumnFlagsOn_p
.head 7 -  Set nColumnFlagsOffAImprimir = nColumnFlagsOff_p
.head 5 -  !
.head 5 +  Function: AlteraImprimirComGrades
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nTipoDeGradeAImprimir = PTBL_GRIDTYPE_TABLE
.head 5 +  Function: AlteraImprimirSemGrades
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nTipoDeGradeAImprimir = PTBL_GRIDTYPE_NO
.head 5 +  Function: AlteraImprimirComLinhasEntreColunas
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nTipoDeGradeAImprimir = PTBL_GRIDTYPE_STANDARD
.head 5 +  Function: AlteraEscalaDeImpressao
.head 6 -  Description: A imagem da tabelas a ser impressa pode aumentada percentualmente.
Caso queira uma imagem 2x maior use alterar a escala para 200% da mesma
maneira é possivel diminuir essa imagem pela metade usando 50%.

Aumentando a imagem também cresce a quantidade de páginas a serem impressas.
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nEscalaPercentual_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nEscalaPercentual = nEscalaPercentual_p
.head 5 -  !
.head 5 +  Function: AlteraMostraONumeroDaPagina
.head 6 -  Description: Além do cabeçalho e do rodapé também é possivel mostrar o número da página.
Ela será apresentada abaixo do rodapé e em Ingles :  Page 1
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bMostraONumeroDaPagina_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bMostraONumeroDaPagina = bMostraONumeroDaPagina_p
.head 5 +  Function: AlteraMostraTituloDasColunas
.head 6 -  Description: É possível imprimir a tabela sem os títulos das colunas
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bMostraTituloDaColunas_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bMostraTituloDaColunas = bMostraTituloDaColunas_p
.head 5 +  Function: AlteraAjustaAlturaDaLinhaAoTexto
.head 6 -  Description: Se a tabela estiver configurada pra usar mais de uma linha é possível tornar a impressão
inteligente fazendo com que apenas as linhas usadas sejam consideradas para definir a
altura da linha.
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: bAjustaAAlturaDaLinhaAoTexto_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bAjustaAAlturaDaLinhaAoTexto = bAjustaAAlturaDaLinhaAoTexto_p
.head 5 -  !
.head 5 +  Function: OnCreate
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hWndPai
.head 7 -  String: sTituloPai
.head 6 +  Actions
.head 7 -  ! Title
.head 7 -  Set hWndPai =  GetParent( hWndItem )
.head 7 -  Call SalGetWindowText( hWndPai, sTituloPai, 500 )
.head 7 -  Call AdicionaTitulo( STRING_Null, sTituloPai, STRING_Null, 1.5, FONT_EnhBold, COLOR_Black )
.head 7 -  ! Blank title line
.head 7 -  Call AdicionaTitulo( STRING_Null, " ", STRING_Null, 1, FONT_EnhBold, COLOR_Black )
.head 7 -  ! Page header
.head 7 -  Call AdicionaCabecalhoDePagina( STRING_Null, STRING_Null, SalFmtFormatDateTime( SalDateCurrent( ), "dd.MM.yyyy" ), 1, FONT_EnhItalic, COLOR_Black )
.head 7 -  ! Blank page header line
.head 7 -  Call AdicionaCabecalhoDePagina( STRING_Null, " ", STRING_Null, 1, NUMBER_Null, NUMBER_Null )
.head 7 -  ! Blank page footer line
.head 7 -  Call AdicionaRodapeDePagina( STRING_Null, " ", STRING_Null, 1, NUMBER_Null, NUMBER_Null )
.head 7 -  ! Extended pagenumber line
.head 7 -  Call AdicionaRodapeDePagina( STRING_Null, "Página %PAGENR% de %PAGECOUNT% ", STRING_Null, 1, NUMBER_Null, NUMBER_Null )
.head 7 -  !
.head 7 -  Call AlteraRowFlagsAImprimir( 0, 0 )
.head 7 -  Call AlteraColumnFlagsAImprimir( COL_Visible, 0 )
.head 7 -  Call AlteraOrientacaoParaRetrato ()
.head 7 -  Call AlteraImprimirComGrades ()
.head 7 -  Call AlteraEscalaDeImpressao( 0 )
.head 7 -  Call AlteraNumeroDeCopias( 1 )
.head 7 -  Call AlteraMargens( 20, 20, 20, 20 )
.head 7 -  Call AlteraNomeDaImpressoraDestino( STRING_Null )
.head 7 -  Call AlteraTituloDaJanelaDePreview( sTituloPai )
.head 7 -  Call AlteraMostraONumeroDaPagina( FALSE )
.head 7 -  Call AlteraAjustaAlturaDaLinhaAoTexto( FALSE )
.head 7 -  Call AlteraMostraTituloDasColunas( TRUE )
.head 7 -  !
.head 7 -  Call _CriaMenuDinamico ()
.head 5 +  Function: VisualizaImpressao
.head 6 -  Description: Chama a tela de visualização de impressão e permite imprimir a partir dela.
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call _Imprime( TRUE )
.head 5 +  Function: ImprimeDireto
.head 6 -  Description: Realiza a impressão do relatório sem mostrar a tela de visualização.
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call _Imprime( FALSE )
.head 5 +  Function: _PrintParamsParaVariaveis
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: PrintParams_p
.head 8 -  Class: fcPrintTblParams
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nMargemEsquerda = PrintParams_p.LeftMargin
.head 7 -  Set nMargemDireita = PrintParams_p.RightMargin
.head 7 -  Set nMargemSuperior= PrintParams_p.TopMargin
.head 7 -  Set nMargemInferior = PrintParams_p.BottomMargin
.head 7 -  !
.head 7 -  Set nNumeroDeCopias = PrintParams_p.Copies
.head 7 -  Set nEscalaPercentual = PrintParams_p.Scale
.head 7 -  Set bMostraTituloDaColunas =  PrintParams_p.ColHeaders
.head 7 -  Set nOrientacao = PrintParams_p.Orientation
.head 7 -  Set nRowFlagsOnAImprimir = PrintParams_p.RowFlagsOn
.head 7 -  Set nRowFlagsOffAImprimir = PrintParams_p.RowFlagsOff
.head 7 -  Set nColumnFlagsOnAImprimir = PrintParams_p.ColFlagsOn
.head 7 -  Set nColumnFlagsOffAImprimir = PrintParams_p.ColFlagsOff
.head 7 -  Set nTipoDeGradeAImprimir = PrintParams_p.GridType
.head 7 -  ! !
.head 7 -  Set bMostraONumeroDaPagina = PrintParams_p.PageNrs
.head 7 -  Set bAjustaAAlturaDaLinhaAoTexto = PrintParams_p.VarRowHeight
.head 7 -  Set sNomeDaImpressoraDestino = PrintParams_p.PrinterName
.head 7 -  Set sTituloDaJanelaDePreview = PrintParams_p.PrevWndTitle
.head 7 -  !
.head 5 +  Function: _CopiaLinhas
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  FunctionalVar: ptLinhaOrigem_p[*]
.head 8 -  Class: fcPrintTblLine
.head 7 -  FunctionalVar: ptLinhaDestino_p[*]
.head 8 -  Class: fcPrintTblLine
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 6 +  Actions
.head 7 -  Set nIndice = 0
.head 7 +  If not SalArrayIsEmpty( ptLinhaOrigem_p )
.head 8 -  Call SalArraySetUpperBound( ptLinhaDestino_p, 1, -1 )
.head 8 -  Call SalArrayGetUpperBound( ptLinhaOrigem_p, 1, nUltimoIndice )
.head 8 -  !
.head 8 +  While nIndice <= nUltimoIndice
.head 9 -  Set ptLinhaDestino_p[nIndice].LeftText = ptLinhaOrigem_p[nIndice].LeftText
.head 9 -  Set ptLinhaDestino_p[nIndice].CenterText = ptLinhaOrigem_p[nIndice].CenterText
.head 9 -  Set ptLinhaDestino_p[nIndice].RightText = ptLinhaOrigem_p[nIndice].RightText
.head 9 -  Set ptLinhaDestino_p[nIndice].FontSizeMulti = ptLinhaOrigem_p[nIndice].FontSizeMulti
.head 9 -  Set ptLinhaDestino_p[nIndice].FontEnh = ptLinhaOrigem_p[nIndice].FontEnh
.head 9 -  Set ptLinhaDestino_p[nIndice].FontColor = ptLinhaOrigem_p[nIndice].FontColor
.head 9 -  Set nIndice = nIndice + 1
.head 7 -  !
.head 7 -  Return nIndice
.head 5 +  Function: _VariaveisParaPrintParams
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: PrintParams_p
.head 8 -  Class: fcPrintTblParams
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set PrintParams_p.LeftMargin = nMargemEsquerda
.head 7 -  Set PrintParams_p.RightMargin = nMargemDireita
.head 7 -  Set PrintParams_p.TopMargin = nMargemSuperior
.head 7 -  Set PrintParams_p.BottomMargin = nMargemInferior
.head 7 -  ! !
.head 7 -  Set PrintParams_p.Copies = nNumeroDeCopias
.head 7 -  Set PrintParams_p.Scale = nEscalaPercentual
.head 7 -  Set PrintParams_p.ColHeaders = bMostraTituloDaColunas
.head 7 -  Set PrintParams_p.Orientation = nOrientacao
.head 7 -  Set PrintParams_p.RowFlagsOn = nRowFlagsOnAImprimir
.head 7 -  Set PrintParams_p.RowFlagsOff = nRowFlagsOffAImprimir
.head 7 -  Set PrintParams_p.ColFlagsOn = nColumnFlagsOnAImprimir
.head 7 -  Set PrintParams_p.ColFlagsOff = nColumnFlagsOffAImprimir
.head 7 -  Set PrintParams_p.GridType = nTipoDeGradeAImprimir
.head 7 -  ! ! !
.head 7 -  Set PrintParams_p.PageNrs = bMostraONumeroDaPagina
.head 7 -  Set PrintParams_p.VarRowHeight = bAjustaAAlturaDaLinhaAoTexto
.head 7 -  Set PrintParams_p.PrinterName = sNomeDaImpressoraDestino
.head 7 -  Set PrintParams_p.PrevWndTitle = sTituloDaJanelaDePreview
.head 5 +  Function: _CriaMenuDinamico
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call DestroyMenu( hWndMenuTblImp )
.head 7 -  Set bMenuFlutuante = TRUE
.head 7 -  ! ! create a new tracking/floating Popup menu for the Form Window
.head 7 -  Set hWndMenuTblImp = CreatePopupMenu()
.head 7 -  ! ! add some menu items
.head 7 -  Call AppendMenuA( hWndMenuTblImp, MF_ENABLED, 1,
		'Visualiza Impressão' )
.head 7 -  Call AppendMenuA( hWndMenuTblImp, MF_ENABLED, 2,
		'Imprime Direto' )
.head 7 -  ! ! add a menu separator
.head 7 -  Call AppendMenuA( hWndMenuTblImp, MF_SEPARATOR, 0, '' )
.head 7 -  ! ! add another menu item
.head 7 -  Call AppendMenuA( hWndMenuTblImp, MF_ENABLED, 3,
		'Configura Impressão' )
.head 5 +  Function: ConfiguraImpressao
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: PParams
.head 8 -  Class: fcPrintTblParams
.head 6 +  Actions
.head 7 -  ! Call _VariaveisParaPrintParams( PParams )
.head 7 -  ! Call SalModalDialog( dlgConfiguraImpressao, hWndForm, PParams, Titulos, CabecalhosDePagina, RodapesDePagina )
.head 7 -  ! Call _PrintParamsParaVariaveis ( PParams )
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call OnCreate ()
.head 5 +  On WM_COMMAND
.head 6 +  If bMenuFlutuante
.head 7 +  If wParam = 1
.head 8 -  Call VisualizaImpressao ()
.head 7 +  Else If wParam = 2
.head 8 -  Call ImprimeDireto ()
.head 7 +  Else If wParam = 3
.head 8 -  Call ConfiguraImpressao ()
.head 7 -  Set bMenuFlutuante = FALSE
.head 5 +  On WM_RBUTTONDOWN
.head 6 -  Set nX = SalNumberLow( lParam )
.head 6 -  Set nY= SalNumberHigh( lParam )
.head 6 -  Call ClientToScreen( hWndItem, nX, nY)
.head 6 -  !
.head 6 -  ! WM_COMMAND's wParam is the menu item chosen when bFloating = TRUE
.head 6 -  Set bMenuFlutuante = TRUE
.head 6 -  !
.head 6 -  Call TrackPopupMenu( hWndMenuTblImp, 0, nX, nY,  0, hWndItem, '' )
.head 5 +  On SAM_Destroy
.head 6 -  Call DestroyMenu( hWndMenuTblImp )
.head 3 +  Child Table Class: pcChildTableSemLinhaSerializavel
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcChildTableSemLinha
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: saNomesColunas[*]
.head 5 -  Number: naTiposDadosColunas[*]
.head 4 +  Functions
.head 5 +  Function: RecuperaLinhaSerializada
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql_p
.head 7 -  FunctionalVar: oDestino_p
.head 8 -  Class: fcSonDestinoObjeto
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: oLinha
.head 8 -  Class: fcSonDadosLinha
.head 7 -  Long String: sObjetoLinha
.head 7 -  Long String: sEstrutura
.head 7 -  Number: nColuna
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  Window Handle: hWndColuna
.head 7 -  !
.head 7 -  String: sNomeTabela
.head 7 -  String: sNomeForm
.head 7 -  !
.head 7 -  Number: nErro
.head 7 -  Number: nPosErro
.head 7 -  Number: nRetorno
.head 7 -  String: sRetorno
.head 7 -  Date/Time: dtRetorno
.head 7 -  Window Handle: hRetorno
.head 7 -  String: sContexto
.head 6 +  Actions
.head 7 +  If oDestino_p.Recupera( hSql_p, sObjetoLinha, sEstrutura )
.head 8 -  Call XSalUdvFromString( oDestino_p.oEstrutura, sEstrutura, 'sss' )
.head 8 -  Call XSalUdvFromString( oLinha, sObjetoLinha, oDestino_p.oEstrutura.sTiposDadosCampos )
.head 8 +  If not SalArrayIsEmpty( oLinha.saColunas )
.head 9 -  !
.head 9 -  Call SalGetItemName( SalParentWindow( hWndForm ), sNomeForm )
.head 9 -  Call SalGetItemName( hWndItem, sNomeTabela )
.head 9 -  Call InsertRow ()
.head 9 -  !
.head 9 -  Call SalArrayGetUpperBound( oLinha.saColunas, 1, nUltimoIndice )
.head 9 -  Set nIndice = 0
.head 9 -  Set sContexto = SalContextCurrent ()
.head 9 +  While nIndice <= nUltimoIndice
.head 10 +  If ColunaValida( oLinha.saColunas[nIndice], oLinha.naTiposDados[nIndice] )
.head 11 +  Select Case oLinha.naTiposDados[nIndice]
.head 12 -  Case DT_Number
.head 12 +  Case DT_Boolean
.head 13 -  Call SalCompileAndEvaluate( 'Set ' || sNomeForm||'.'||sNomeTabela||'.'|| oLinha.saColunas[nIndice] || ' = oLinha.naNumbers[oLinha.naIndices[nIndice]]',
      nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, FALSE, sContexto )
.head 13 -  Break
.head 12 -  Case DT_LongString
.head 12 +  Case DT_String
.head 13 -  Call SalCompileAndEvaluate( 'Set ' || sNomeForm||'.'||sNomeTabela||'.'|| oLinha.saColunas[nIndice] || ' = oLinha.saStrings[oLinha.naIndices[nIndice]]',
      nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, FALSE, sContexto )
.head 13 -  Break
.head 12 +  Case DT_DateTime
.head 13 -  Call SalCompileAndEvaluate( 'Set ' || sNomeForm||'.'||sNomeTabela||'.'|| oLinha.saColunas[nIndice] || ' = oLinha.dtaDates[oLinha.naIndices[nIndice]]',
      nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, FALSE, sContexto )
.head 13 -  Break
.head 10 -  Set nIndice = nIndice + 1
.head 9 -  !
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: InsereLinhaSerializada
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql_p
.head 7 -  FunctionalVar: oDestino_p
.head 8 -  Class: fcSonDestinoObjeto
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: oLinha
.head 8 -  Class: fcSonDadosLinha
.head 7 -  Long String: sObjetoLinha
.head 7 -  Long String: sEstrutura
.head 7 -  Number: nColuna
.head 7 -  Number: nIndice
.head 7 -  String: sNomeColuna
.head 7 -  String: sNomeTabela
.head 7 -  String: sNomeForm
.head 7 -  Window Handle: hWndColuna
.head 7 -  !
.head 7 -  Number: nIndiceNumbers
.head 7 -  Number: nIndiceStrings
.head 7 -  Number: nIndiceDates
.head 7 -  !
.head 7 -  Number: nErro
.head 7 -  Number: nPosErro
.head 7 -  Number: nRetorno
.head 7 -  String: sRetorno
.head 7 -  Date/Time: dtRetorno
.head 7 -  Window Handle: hRetorno
.head 7 -  String: sContexto
.head 6 +  Actions
.head 7 -  !
.head 7 -  Set sContexto = SalContextCurrent ()
.head 7 -  Set nIndice =0
.head 7 -  Set nIndiceNumbers = 0
.head 7 -  Set nIndiceStrings = 0
.head 7 -  Set nIndiceDates = 0
.head 7 -  Call SalGetItemName( hWndItem, sNomeTabela )
.head 7 -  Call SalGetItemName( SalParentWindow( hWndForm ), sNomeForm )
.head 7 -  !
.head 7 -  ! Popula o objeto linha com todos os valores das suas colunas.
.head 7 -  !
.head 7 -  Set nColuna = 1
.head 7 +  Loop
.head 8 -  Set hWndColuna = SalTblGetColumnWindow( hWndItem, nColuna, COL_GetPos )
.head 8 +  If hWndColuna = hWndNULL
.head 9 -  Break
.head 8 +  Else
.head 9 -  Call SalGetItemName( hWndColuna, sNomeColuna )
.head 9 -  Set oLinha.saColunas[nIndice] = sNomeColuna
.head 9 -  Set oLinha.naTiposDados[nIndice] = SalGetDataType( hWndColuna )
.head 9 +  Select Case oLinha.naTiposDados[nIndice]
.head 10 -  Case DT_Number
.head 10 +  Case DT_Boolean
.head 11 -  Call SalCompileAndEvaluate( 'Set oLinha.naNumbers[nIndiceNumbers]'  || ' = ' || sNomeForm||'.'||sNomeTabela||'.'||sNomeColuna, nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, FALSE, sContexto )
.head 11 -  Set oLinha.naIndices[nIndice] = nIndiceNumbers
.head 11 -  Set nIndiceNumbers = nIndiceNumbers + 1
.head 11 -  Break
.head 10 -  Case DT_LongString
.head 10 +  Case DT_String
.head 11 -  Call SalCompileAndEvaluate( 'Set oLinha.saStrings[nIndiceStrings]'  || ' = ' || sNomeForm||'.'||sNomeTabela||'.'||sNomeColuna, nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, FALSE, sContexto )
.head 11 -  Set oLinha.naIndices[nIndice] = nIndiceStrings
.head 11 -  Set nIndiceStrings = nIndiceStrings + 1
.head 11 -  Break
.head 10 +  Case DT_DateTime
.head 11 -  Call SalCompileAndEvaluate( 'Set oLinha.dtaDates[nIndiceDates]'  || ' = ' || sNomeForm||'.'||sNomeTabela||'.'||sNomeColuna, nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, FALSE, sContexto )
.head 11 -  Set oLinha.naIndices[nIndice] = nIndiceDates
.head 11 -  Set nIndiceDates = nIndiceDates + 1
.head 11 -  Break
.head 9 -  Set nColuna = nColuna + 1
.head 9 -  Set nIndice = nIndice + 1
.head 7 -  !
.head 7 -  ! Armazena o objeto linha no destino
.head 7 -  !
.head 7 -  Call oDestino_p.SetaEstrutura( 'fcSonLinha', 'oLinha',  '*n*s*t*s*n*n' )
.head 7 -  Call XSalUdvToString( oDestino_p.oEstrutura, sEstrutura, 'sss' )
.head 7 -  Call XSalUdvToString( oLinha, sObjetoLinha, oDestino_p.oEstrutura.sTiposDadosCampos )
.head 7 -  Return oDestino_p.Insere( hSql_p,  sObjetoLinha, sEstrutura )
.head 5 +  Function: Inicializa
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Receive String: sapNomesColunas[*]
.head 7 -  Receive Number: napTiposDadosColunas[*]
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sNomeColuna
.head 7 -  Number: nIndice
.head 7 -  Window Handle: hWndColuna
.head 7 -  Number: nColuna
.head 6 +  Actions
.head 7 -  Set nColuna = 1
.head 7 -  Set nIndice = 0
.head 7 +  Loop
.head 8 -  Set hWndColuna = SalTblGetColumnWindow( hWndItem, nColuna, COL_GetPos )
.head 8 +  If hWndColuna = hWndNULL
.head 9 -  Break
.head 8 +  Else
.head 9 -  Call SalGetItemName( hWndColuna, sNomeColuna )
.head 9 -  Set sapNomesColunas[nIndice] = sNomeColuna
.head 9 -  Set napTiposDadosColunas[nIndice] = SalGetDataType( hWndColuna )
.head 9 -  Set nColuna = nColuna + 1
.head 9 -  Set nIndice = nIndice + 1
.head 7 -  Return nIndice
.head 5 +  Function: AtualizaLinhaSerializada
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql_p
.head 7 -  FunctionalVar: oDestino_p
.head 8 -  Class: fcSonDestinoObjeto
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: oLinha
.head 8 -  Class: fcSonDadosLinha
.head 7 -  Long String: sObjetoLinha
.head 7 -  Long String: sEstrutura
.head 7 -  Number: nColuna
.head 7 -  Number: nIndice
.head 7 -  String: sNomeColuna
.head 7 -  String: sNomeTabela
.head 7 -  String: sNomeForm
.head 7 -  Window Handle: hWndColuna
.head 7 -  !
.head 7 -  Number: nIndiceNumbers
.head 7 -  Number: nIndiceStrings
.head 7 -  Number: nIndiceDates
.head 7 -  !
.head 7 -  Number: nErro
.head 7 -  Number: nPosErro
.head 7 -  Number: nRetorno
.head 7 -  String: sRetorno
.head 7 -  Date/Time: dtRetorno
.head 7 -  Window Handle: hRetorno
.head 7 -  String: sContexto
.head 6 +  Actions
.head 7 -  !
.head 7 -  Set sContexto = SalContextCurrent ()
.head 7 -  Set nIndice =0
.head 7 -  Set nIndiceNumbers = 0
.head 7 -  Set nIndiceStrings = 0
.head 7 -  Set nIndiceDates = 0
.head 7 -  Call SalGetItemName( hWndItem, sNomeTabela )
.head 7 -  Call SalGetItemName( SalParentWindow( hWndForm ), sNomeForm )
.head 7 -  !
.head 7 -  ! Popula o objeto linha com todos os valores das suas colunas.
.head 7 -  !
.head 7 -  Set nColuna = 1
.head 7 +  Loop
.head 8 -  Set hWndColuna = SalTblGetColumnWindow( hWndItem, nColuna, COL_GetPos )
.head 8 +  If hWndColuna = hWndNULL
.head 9 -  Break
.head 8 +  Else
.head 9 -  Call SalGetItemName( hWndColuna, sNomeColuna )
.head 9 -  Set oLinha.saColunas[nIndice] = sNomeColuna
.head 9 -  Set oLinha.naTiposDados[nIndice] = SalGetDataType( hWndColuna )
.head 9 +  Select Case oLinha.naTiposDados[nIndice]
.head 10 -  Case DT_Number
.head 10 +  Case DT_Boolean
.head 11 -  Call SalCompileAndEvaluate( 'Set oLinha.naNumbers[nIndiceNumbers]'  || ' = ' || sNomeForm||'.'||sNomeTabela||'.'||sNomeColuna, nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, FALSE, sContexto )
.head 11 -  Set oLinha.naIndices[nIndice] = nIndiceNumbers
.head 11 -  Set nIndiceNumbers = nIndiceNumbers + 1
.head 11 -  Break
.head 10 -  Case DT_LongString
.head 10 +  Case DT_String
.head 11 -  Call SalCompileAndEvaluate( 'Set oLinha.saStrings[nIndiceStrings]'  || ' = ' || sNomeForm||'.'||sNomeTabela||'.'||sNomeColuna, nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, FALSE, sContexto )
.head 11 -  Set oLinha.naIndices[nIndice] = nIndiceStrings
.head 11 -  Set nIndiceStrings = nIndiceStrings + 1
.head 11 -  Break
.head 10 +  Case DT_DateTime
.head 11 -  Call SalCompileAndEvaluate( 'Set oLinha.dtaDates[nIndiceDates]'  || ' = ' || sNomeForm||'.'||sNomeTabela||'.'||sNomeColuna, nErro, nPosErro, nRetorno, sRetorno, dtRetorno, hRetorno, FALSE, sContexto )
.head 11 -  Set oLinha.naIndices[nIndice] = nIndiceDates
.head 11 -  Set nIndiceDates = nIndiceDates + 1
.head 11 -  Break
.head 9 -  Set nColuna = nColuna + 1
.head 9 -  Set nIndice = nIndice + 1
.head 7 -  !
.head 7 -  ! Armazena o objeto linha no destino
.head 7 -  !
.head 7 -  Call oDestino_p.SetaEstrutura( 'fcSonLinha', 'oLinha',  '*n*s*t*s*n*n' )
.head 7 -  Call XSalUdvToString( oDestino_p.oEstrutura, sEstrutura, 'sss' )
.head 7 -  Call XSalUdvToString( oLinha, sObjetoLinha, oDestino_p.oEstrutura.sTiposDadosCampos )
.head 7 -  Return oDestino_p.Salva( hSql_p,  sObjetoLinha, sEstrutura )
.head 5 +  Function: ColunaValida
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: spNomeColuna
.head 7 -  Number: npTipoDadoColuna
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndiceEncontrado
.head 6 +  Actions
.head 7 -  Set nIndiceEncontrado =  VisArrayFindString( saNomesColunas, spNomeColuna )
.head 7 +  If nIndiceEncontrado >= 0
.head 8 +  If npTipoDadoColuna = naTiposDadosColunas[nIndiceEncontrado]
.head 9 -  Return TRUE
.head 7 -  Return FALSE
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call Inicializa( saNomesColunas, naTiposDadosColunas )
.head 3 +  Pushbutton Class: pcPbIncluiLinha
.head 4 -  Title: I&nclui Linha
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  1.62"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Gray
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: GetText
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sAux
.head 7 -  Number: nAux
.head 6 +  Actions
.head 7 -  Set sAux = SalGetWindowTextX( hWndItem )
.head 7 -  Set nAux = SalStrScan(sAux, '&')
.head 7 +  If nAux > -1
.head 8 -  Set sAux = SalStrReplaceX( sAux, nAux, 1, '')
.head 7 -  Return sAux
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call XSalToolboxSetButtonStyle( hWndItem, XSalToolbar_ButtonLeftImage | XSalToolbar_ButtonThinBorder )
.head 6 -  Call SalPicSetFile( hWndItem, sPathFigurasSonner || 'GED_Inclui.bmp' )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, GetText() )
.head 3 +  Pushbutton Class: pcPbExcluiLinha
.head 4 -  Title: E&xclui Linha
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  1.62"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: White
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Light Gray
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: GetText
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sAux
.head 7 -  Number: nAux
.head 6 +  Actions
.head 7 -  Set sAux = SalGetWindowTextX( hWndItem )
.head 7 -  Set nAux = SalStrScan(sAux, '&')
.head 7 +  If nAux > -1
.head 8 -  Set sAux = SalStrReplaceX( sAux, nAux, 1, '')
.head 7 -  Return sAux
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call XSalToolboxSetButtonStyle( hWndItem, XSalToolbar_ButtonLeftImage | XSalToolbar_ButtonThinBorder )
.head 6 -  Call SalPicSetFile( hWndItem, sPathFigurasSonner || 'GED_Exclui2.bmp' )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, GetText() )
.head 3 +  Child Table Class: pcPicTable
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  2.667"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.452"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcChildTable
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: picSel
.head 5 -  Number: picDoc
.head 5 -  Number: picDocV
.head 5 -  Number: picDocS
.head 5 -  Number: picPadrao
.head 5 -  Boolean: bMultiSelect
.head 5 -  Boolean: bAux
.head 5 -  Number: nAux
.head 5 -  Number: nLinha
.head 4 +  Functions
.head 5 +  Function: InsereSel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_New, FALSE )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_UserFlag1, TRUE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nRow
.head 5 +  Function: SelecionaSoUm
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 -  Actions
.head 5 +  Function: Ordena
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nColuna
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set bCresente = FALSE
.head 7 -  Call SalTblSetColumnFlags( SalTblGetColumnWindow( hWndItem, nColuna, COL_GetID ), COL_Selected, TRUE )
.head 7 -  Call SalSendClassMessage( SAM_ColumnSelectClick, 0, 0)
.head 5 +  Function: Insere
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 6 +  Actions
.head 7 -  Set nLinha =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_New, FALSE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nLinha
.head 5 +  Function: Marcado
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalTblQueryRowFlags( hWndItem, nLinha , ROW_MarkDeleted)
.head 8 -  Return TRUE
.head 7 -  Return FALSE
.head 5 +  Function: ExcluiMarcado
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinha
.head 6 +  Actions
.head 7 -  Set nLinha = 0
.head 7 +  While SalTblSetContext(hWndItem, nLinha)
.head 8 +  If SalTblQueryRowFlags( hWndItem, nLinha , ROW_MarkDeleted)
.head 9 -  Call SalTblDeleteRow(hWndItem, nLinha, 0)
.head 9 -  Set nLinha = nLinha - 1
.head 8 -  Set nLinha = nLinha + 1
.head 5 +  Function: SetFocus
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nCol
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nLinha < 0
.head 8 -  Set nLinha = SalTblQueryContext( hWndItem )
.head 7 -  Call SalTblSetFocusCell( hWndItem, nLinha, SalTblGetColumnWindow( hWndItem, nCol, 0 ), -1, -1 )
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblReset(hWndItem)
.head 5 +  Function: MudaFigura
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 -  Actions
.head 5 +  Function: InsereDoc
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_New, FALSE )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_UserFlag2, TRUE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nRow
.head 5 +  Function: InsereDocV
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow =  SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_New, FALSE )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nRow, ROW_UserFlag3, TRUE )
.head 7 -  Call SalInvalidateWindow( hWndItem )
.head 7 -  Return nRow
.head 5 +  Function: MudaPic
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nPic
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag1, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag2, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag3, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag4, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_MarkDeleted, 0 )
.head 7 +  If nPic = 1
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag1, 1 )
.head 7 +  Else If nPic = 2
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag2, 1 )
.head 7 +  Else If nPic = 3
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag3, 1 )
.head 7 +  Else If nPic = 4
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_MarkDeleted, 1 )
.head 7 +  Else If nPic = 5
.head 8 -  Call SalTblSetRowFlags( hWndItem, nLinha, ROW_UserFlag4, 1 )
.head 5 +  Function: Exclui
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If nLinha < 0
.head 8 -  Set nLinha = SalTblQueryContext( hWndItem )
.head 7 -  Call SalTblDeleteRow(hWndItem, nLinha, 0 )
.head 5 +  Function: PintaColuna
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nColuna
.head 7 -  Number: nCor
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Window Handle: hCol
.head 7 -  Number: nLinhaAnt
.head 6 +  Actions
.head 7 +  If nLinha > -1
.head 8 -  Set nLinhaAnt = SalTblQueryContext( hWndItem )
.head 8 -  Call SalTblSetContext(hWndItem, nLinha )
.head 7 -  Set hCol = SalTblGetColumnWindow( hWndItem, nColuna, COL_GetID  )
.head 7 -  Call SalTblSetCellTextColor( hCol, nCor, 1 )
.head 7 +  If nLinha > -1
.head 8 -  Call SalTblSetContext(hWndItem, nLinhaAnt )
.head 5 +  Function: IsMarcado
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalTblQueryRowFlags( hWndItem, nLinha , ROW_MarkDeleted)
.head 8 -  Return 1
.head 7 -  Return 0
.head 5 +  Function: NegritaColuna
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nLinha
.head 7 -  Number: nColuna
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLinhaAnt
.head 6 +  Actions
.head 7 -  Set nLinhaAnt = SalTblQueryContext(hWndItem)
.head 7 -  Call SalTblSetContext(hWndItem, nLinha )
.head 7 -  Call XSalTblSetColumnFontName(  SalTblGetColumnWindow( hWndItem, nColuna, COL_GetID ), "Arial", 8, FONT_EnhBold   )
.head 7 -  Call SalTblSetContext(hWndItem, nLinhaAnt )
.head 5 +  Function: ColunaEmTextoSeparadoPorVirgula
.head 6 -  Description: À partir da coluna escolhida, passada por parâmetro, essa função
retorna as linhas dessa coluna em uma string sendo cada linha
separada por vírgula
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nColuna
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sLinha
.head 7 -  Number: nLinha
.head 7 -  String: sTexto
.head 6 +  Actions
.head 7 -  Set nLinha = 0
.head 7 -  Set sTexto = STRING_Null
.head 7 +  While SalTblSetContext( hWndItem, nLinha )
.head 8 +  If SalTblGetColumnText( hWndItem, nColuna, sLinha )
.head 9 +  If SalIsValidNumber(  SalTblGetColumnWindow( hWndItem, nColuna, COL_GetID ) )
.head 10 -  Set sTexto = sTexto || sLinha || ','
.head 9 +  Else
.head 10 -  Set sTexto = sTexto || '\'' || sLinha || '\','
.head 8 -  Set nLinha= nLinha + 1
.head 7 +  If sTexto != STRING_Null
.head 8 +  If SalStrScan( sTexto, ',' ) >= 0
.head 9 -  Set sTexto = SalStrLeftX( sTexto, SalStrLength( sTexto ) -1 )
.head 7 -  !
.head 7 -  Return sTexto
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set picSel = VisPicLoad( PIC_LoadFile | PIC_FormatBitmap, sPathFigurasSonner||'SelecionaMini.bmp', '' )
.head 6 -  Set picDoc = VisPicLoad( PIC_LoadFile | PIC_FormatIcon, sPathFigurasSonner|| 'DocMini.bmp', '' )
.head 6 -  Set picDocV = VisPicLoad( PIC_LoadFile | PIC_FormatBitmap, sPathFigurasSonner|| 'DocVMini.bmp', '' )
.head 6 -  Set picDocS = VisPicLoad( PIC_LoadFile | PIC_FormatBitmap, sPathFigurasSonner|| 'DocSMini.bmp', '' )
.head 6 -  Call VisTblSetRowPicture( hWndItem, ROW_UserFlag1, picSel )
.head 6 -  Call VisTblSetRowPicture( hWndItem, ROW_UserFlag2, picDoc )
.head 6 -  Call VisTblSetRowPicture( hWndItem, ROW_UserFlag3, picDocV )
.head 6 -  Call VisTblSetRowPicture( hWndItem, ROW_UserFlag4, picDocS )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressRowLines, TRUE )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SuppressLastColLine, TRUE )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SizableCols, FALSE )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_SingleSelection, TRUE )
.head 6 -  Call SalTblSetTableFlags( hWndItem, TBL_Flag_MovableCols, FALSE )
.head 6 -  Set bMultiSelect = 1
.head 6 -  Set picPadrao = 0
.head 5 +  On PAM_Reset
.head 6 -  Call SalSendClassMessage( PAM_Reset, 0 ,0)
.head 6 -  Call SalTblReset( hWndItem )
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Set nAux =  SalTblQueryContext( hWndItem )
.head 6 +  If bMultiSelect
.head 7 +  If SalTblQueryRowFlags( hWndItem, nAux , ROW_MarkDeleted)
.head 8 -  Call MudaPic(nAux,  picPadrao )
.head 7 +  Else
.head 8 -  Call MudaPic(nAux, 4)
.head 6 +  Else
.head 7 +  If SalTblQueryRowFlags( hWndItem, nAux , ROW_MarkDeleted)
.head 8 -  Set bAux = 1
.head 7 +  Else
.head 8 -  Set bAux = 0
.head 7 -  Set nLinha = 0
.head 7 +  While SalTblSetContext( hWndItem, nLinha )
.head 8 +  If SalTblQueryRowFlags( hWndItem, nLinha , ROW_MarkDeleted)
.head 9 -  Call MudaPic(nLinha,  picPadrao )
.head 8 -  Set nLinha = nLinha + 1
.head 7 +  If bAux
.head 8 -  Call MudaPic(nAux,  picPadrao )
.head 7 +  Else
.head 8 -  Call MudaPic(nAux, 4)
.head 7 -  Call SalTblSetContext(hWndItem, nAux )
.head 3 +  Column Class: pcColumn
.head 4 -  Title:
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On VTM_KeyDown
.head 6 +  If ( wParam = VK_F9 )
.head 7 -  Set bPAMSelect = TRUE
.head 7 -  Call SalSendMsg( hWndItem, PAM_ValorPadrao, 0, 0 )
.head 7 -  Set bPAMSelect = FALSE
.head 5 +  On PAM_ValorPadrao
.head 6 +  If ( ( SalGetType ( hWndItem ) = TYPE_DataField ) Or (SalGetType ( hWndItem ) = TYPE_MultilineText) )
.head 7 -  Call SalSendMsg( SalParentWindow( hWndItem ), PAM_ValorPadrao, SalWindowHandleToNumber( hWndItem ), 0 )
.head 6 +  If ( (SalGetType ( hWndItem ) = TYPE_TableColumn) )
.head 7 +  If ( SalGetType( SalParentWindow( hWndItem ) ) = TYPE_ChildTable )
.head 8 -  Call SalSendMsg( SalParentWindow( SalParentWindow( hWndItem ) ), PAM_ValorPadrao, SalWindowHandleToNumber( hWndItem ), 0 )
.head 3 +  Column Class: pcColumnX
.head 4 -  Title:
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: __nState
.head 4 -  Functions
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On WM_CHAR
.head 6 +  If wParam = 13
.head 7 +  If SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) + 1, COL_GetPos ) != hWndNULL
.head 8 -  Call SalTblSetFocusCell( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ), SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) + 1, COL_GetPos ), 0, -1 )
.head 7 +  Else
.head 8 +  If Not SalTblSetContext( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ) + 1 )
.head 9 -  Call SalTblInsertRow( SalParentWindow( hWndItem), TBL_MaxRow )
.head 9 -  Call SalTblSetFocusCell( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ), SalTblGetColumnWindow( SalParentWindow( hWndItem),  1, COL_GetPos ), 0, -1 )
.head 8 +  Else
.head 9 -  Call SalTblSetFocusCell( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ), SalTblGetColumnWindow( SalParentWindow( hWndItem),  1, COL_GetPos ), 0, -1 )
.head 5 +  On WM_KEYDOWN
.head 6 -  Set __nState = VisGetKeyState( VK_Control )
.head 6 +  If __nState & KS_Down
.head 7 +  If wParam = 39
.head 8 +  If SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) + 1, COL_GetPos ) != hWndNULL
.head 9 -  Call SalTblSetFocusCell( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ), SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) + 1, COL_GetPos ), 0, -1 )
.head 7 +  If wParam = 37
.head 8 +  If SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) - 1, COL_GetPos ) != hWndNULL
.head 9 -  Call SalTblSetFocusCell( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ), SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) - 1, COL_GetPos ), 0, -1 )
.head 3 +  Column Class: pcColumnCodBarrasX
.head 4 -  Title:
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: __nState
.head 5 -  String: __sLeitura
.head 4 +  Functions
.head 5 +  Function: GetLeitura
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return __sLeitura
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On WM_KEYDOWN
.head 6 -  Set __nState = VisGetKeyState( VK_Control )
.head 6 +  If __nState & KS_Down
.head 7 +  If wParam = 39
.head 8 +  If SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) + 1, COL_GetPos ) != hWndNULL
.head 9 -  Call SalTblSetFocusCell( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ), SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) + 1, COL_GetPos ), 0, -1 )
.head 7 +  If wParam = 37
.head 8 +  If SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) - 1, COL_GetPos ) != hWndNULL
.head 9 -  Call SalTblSetFocusCell( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ), SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) - 1, COL_GetPos ), 0, -1 )
.head 5 +  On WM_CHAR
.head 6 +  If wParam = 10 Or wParam = 13
.head 7 -  Call SalGetWindowText( hWndItem, __sLeitura, 255 )
.head 7 +  If __sLeitura != STRING_Null
.head 8 -  Call SalClearField( hWndItem )
.head 8 -  Call SalSendMsg( hWndItem, PAM_Enter, 0, 0 )
.head 8 -  Set __sLeitura = STRING_Null
.head 7 +  If SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) + 1, COL_GetPos ) != hWndNULL
.head 8 -  Call SalTblSetFocusCell( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ), SalTblGetColumnWindow( SalParentWindow( hWndItem),  SalTblQueryColumnPos( hWndItem ) + 1, COL_GetPos ), 0, -1 )
.head 7 +  Else
.head 8 +  If Not SalTblSetContext( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ) + 1 )
.head 9 -  Call SalTblInsertRow( SalParentWindow( hWndItem), TBL_MaxRow )
.head 9 -  Call SalTblSetFocusCell( SalParentWindow( hWndItem), SalTblQueryContext( SalParentWindow( hWndItem) ), SalTblGetColumnWindow( SalParentWindow( hWndItem),  1, COL_GetPos ), 0, -1 )
.head 3 +  Child Table Class: pcChildTableX2
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template: SonProp.exe,dlgSonProp,Propriedades Sonner,,Y,N
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: pcClasse
.head 5 -  Class: pcMouseWheel
.head 4 -  Contents
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: __nContext
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On WM_KEYDOWN
.head 6 +  If wParam = 45
.head 7 -  Call SalTblInsertRow( hWndItem, TBL_MaxRow )
.head 6 +  Else If wParam = 46
.head 7 -  Set __nContext = SalTblQueryContext( hWndItem )
.head 7 -  Call SalTblDeleteRow( hWndItem, SalTblQueryContext( hWndItem ), TBL_NoAdjust )
.head 7 +  If Not SalTblSetFocusRow( hWndItem, __nContext )
.head 8 -  Call SalTblSetFocusRow( hWndItem, __nContext - 1 )
.head 6 +  Else
.head 7 +  If SalTblSetContext( hWndItem, SalTblQueryContext( hWndItem ) )
.head 8 -  Call SalTblSetFocusCell( hWndItem, SalTblQueryContext( hWndItem ), SalTblGetColumnWindow( hWndItem,  1, COL_GetPos ), 0, -1 )
.head 3 +  General Window Class: pcMouseWheel
.head 4 -  Description: base class for mouse wheel support
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: OnMouseWheel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: p_nKeys
.head 7 -  Number: p_nDelta
.head 7 -  Number: p_nMouseX
.head 7 -  Number: p_nMouseY
.head 6 +  Static Variables
.head 7 -  Number: s_nDeltaAcc
.head 6 +  Local variables
.head 7 -  Boolean: bPageScroll
.head 7 -  Number: nScrollUnits
.head 7 -  Number: nwParam
.head 7 -  Number: nCount
.head 6 +  Actions
.head 7 +  If p_nKeys & MK_CONTROL
.head 8 -  Set bPageScroll = TRUE
.head 7 +  If p_nDelta > 32767
.head 8 -  Set p_nDelta = p_nDelta - 65536
.head 7 -  Set s_nDeltaAcc = s_nDeltaAcc + p_nDelta
.head 7 -  Set nScrollUnits = SalNumberTruncate( s_nDeltaAcc / WHEEL_DELTA, 3, 0 )
.head 7 -  Set s_nDeltaAcc = SalNumberMod( s_nDeltaAcc, WHEEL_DELTA )
.head 7 +  If nScrollUnits < 0
.head 8 +  If bPageScroll
.head 9 -  Set nwParam = SB_PageDown
.head 8 +  Else
.head 9 -  Set nwParam = SB_LineDown
.head 7 +  Else
.head 8 +  If bPageScroll
.head 9 -  Set nwParam = SB_PageUp
.head 8 +  Else
.head 9 -  Set nwParam = SB_LineUp
.head 7 -  Set nCount = SalNumberAbs( nScrollUnits )
.head 7 +  While nCount
.head 8 -  Call SalSendMsg( hWndItem, WM_VSCROLL, nwParam, 0 )
.head 8 -  Set nCount = nCount - 1
.head 7 -  Return nScrollUnits
.head 4 +  Message Actions
.head 5 +  On WM_MOUSEWHEEL
.head 6 -  Call ..OnMouseWheel( SalNumberLow( wParam ), SalNumberHigh( wParam ), SalNumberLow( lParam ), SalNumberHigh( lParam ) )
.head 6 -  Return 0
.head 3 +  Functional Class: fcSoundexStruct
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sLetter
.head 5 -  Number: nScore
.head 5 -  Number: nIgnore
.head 4 -  Functions
.head 3 +  Functional Class: fcSoundex
.head 4 -  Description:
.head 4 -  Derived From
.head 4 +  Class Variables
.head 5 -  FunctionalVar: struct[*]
.head 6 -  Class: fcSoundexStruct
.head 4 +  Instance Variables
.head 5 -  Boolean: bInited
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: H & W also ignored, but treated differently than vowels.
Other non A-Z chars ignored.
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sUppers
.head 7 -  String: sScores
.head 7 -  String: sIgnore
.head 7 -  Number: n
.head 6 +  Actions
.head 7 -  Set sUppers = '@ABCDEFGHIJKLMNOPQRSTUVWXYZ'	! @ = ASCII 64 used as placeholder below
.head 7 -  Set sScores = '901230120022455012623010202'
.head 7 -  Set sIgnore = '110001002100000100000102010'
.head 7 -  Set n = 64			! start with 64 = ASCII "@"
.head 7 +  While SalStrLength( sUppers )
.head 8 -  Set struct[n].sLetter = SalStrLeftX( sUppers, 1 )
.head 8 -  Set struct[n].nScore  = SalStrToNumber( SalStrLeftX( sScores, 1 ) )
.head 8 -  Set struct[n].nIgnore = SalStrToNumber( SalStrLeftX( sIgnore, 1 ) )
.head 8 -  !
.head 8 -  Set sUppers = SalStrRightX( sUppers, SalStrLength( sUppers )-1 )
.head 8 -  Set sScores = SalStrRightX( sScores, SalStrLength( sScores )-1 )
.head 8 -  Set sIgnore = SalStrRightX( sIgnore, SalStrLength( sIgnore )-1 )
.head 8 -  Set n = n+1
.head 5 +  Function: Soundex
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sIn
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nSO
.head 7 -  Number: nLen
.head 7 -  Number: n
.head 7 -  Number: nChar
.head 7 -  Number: nInitialChar
.head 7 -  Number: nPrevScore
.head 7 -  Number: x
.head 7 -  String: sCode
.head 6 +  Actions
.head 7 +  If NOT bInited
.head 8 -  Call Init()
.head 8 -  Set bInited = TRUE
.head 7 -  !
.head 7 +  If SalStrLength( sIn ) > 0
.head 8 -  Set sIn = SalStrTrimX( SalStrUpperX( sIn ) )
.head 8 -  Set sCode = SalStrLeftX( sIn, 1 )
.head 8 -  Set nInitialChar = SalStrLop( sIn )		! remove 1st letter - sCode set to it already
.head 8 +  If nInitialChar < 65 OR nInitialChar > 90
.head 9 -  Return '0000'
.head 8 -  ! special-case for "st."
.head 8 +  If struct[nInitialChar].sLetter = 'S' AND
   SalStrMidX( sIn, 0, 1 ) = 'T' AND SalStrMidX( sIn, 1, 1 ) = '.'
.head 9 +  If SalStrLength( sIn ) = 3
.head 10 -  Return 'S530'
.head 9 +  Else
.head 10 -  Set sIn = SalStrRightX( sIn, SalStrLength( sIn )-2 )
.head 10 -  Set sCode = 'S53'
.head 10 -  Set nInitialChar = 64		! "@"
.head 8 -  !
.head 8 -  Set nLen = SalStrLength( sIn )
.head 8 -  Set nSO = 0					! initialise last char as 0
.head 8 -  Set n = 1
.head 8 +  While n <= nLen AND SalStrLength( sIn ) > 0
.head 9 -  Set nChar = SalStrLop( sIn )
.head 9 +  If ( struct[nChar].nScore  != struct[nInitialChar].nScore ) AND
     struct[nChar].nIgnore != 1 AND
     struct[nChar].nIgnore != 2
.head 10 +  If nChar >= 65 AND nChar <= 90
.head 11 -  Set x = struct[nChar].nScore
.head 11 +  If x > 0
.head 12 +  If ( x != nSO ) 		! OR ( n = 1 AND
.head 13 -  Set sCode = sCode || SalNumberToStrX( x, 0 )
.head 13 +  If SalStrLength( sCode ) = 4
.head 14 -  Break
.head 13 -  Set nSO = x
.head 13 -  Set nPrevScore = x
.head 12 +  Else
.head 13 +  If struct[nChar].nIgnore = 1
.head 14 -  Set nSO = 0
.head 11 +  Else
.head 12 +  If struct[nChar].nIgnore = 1 OR
   struct[nChar].sLetter = ''
.head 13 -  Set nSO = 0
.head 10 +  Else
.head 11 +  If struct[nChar].nIgnore = 1 OR nPrevScore != 2
.head 12 -  Set nSO = 0
.head 9 +  Else
.head 10 +  If struct[nChar].nIgnore = 1 OR
   struct[nChar].sLetter = ''
.head 11 -  Set nSO = 0
.head 9 -  Set nInitialChar = 64		! "@"
.head 9 -  Set n = n+1
.head 8 -  !
.head 8 +  While SalStrLength( sCode ) < 4		! pad with zero(s)
.head 9 -  Set sCode = sCode || '0'
.head 8 -  !
.head 8 -  Return sCode
.head 7 +  Else
.head 8 -  Return '0000'
.head 3 +  Functional Class: fcSonDadosLinha
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: naNumbers[*]
.head 5 -  String: saStrings[*]
.head 5 -  Date/Time: dtaDates[*]
.head 5 -  String: saColunas[*]
.head 5 -  Number: naTiposDados[*]
.head 5 -  Number: naIndices[*]
.head 4 -  Functions
.head 3 +  Functional Class: fcSonDestinoObjeto
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sNomeTabelaDestino
.head 5 -  FunctionalVar: oaCamposValores[*]
.head 6 -  Class: fcSonEstruturaCampoValor
.head 5 -  String: sCampoObjeto
.head 5 -  String: sCampoEstrutura
.head 5 -  FunctionalVar: oEstrutura
.head 6 -  Class: fcSonEstruturaObjeto
.head 4 +  Functions
.head 5 +  Function: Salva
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql_p
.head 7 -  Receive Long String: sObjeto_p
.head 7 -  Receive Long String: sEstrutura_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSql
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  String: sCamposChaveEValores
.head 7 -  String: sDemaisCamposEValores
.head 7 -  String: sValor
.head 6 +  Actions
.head 7 -  !
.head 7 +  If not SalArrayIsEmpty( oaCamposValores )
.head 8 -  Call SalArrayGetUpperBound( oaCamposValores, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 +  If oaCamposValores[nIndice].sTipoDados = 'n'
.head 10 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].nNumber'
.head 9 +  Else If oaCamposValores[nIndice].sTipoDados  = 's'
.head 10 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].sString'
.head 9 +  Else If oaCamposValores[nIndice].sTipoDados  = 't'
.head 10 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].dtDateTime'
.head 9 +  If oaCamposValores[nIndice].bChave
.head 10 -  Set sCamposChaveEValores = sCamposChaveEValores || oaCamposValores[nIndice].sCampo || ' = ' || sValor || ' and '
.head 9 +  Else
.head 10 -  Set sDemaisCamposEValores = sDemaisCamposEValores || oaCamposValores[nIndice].sCampo || ' = ' || sValor || ','
.head 9 -  Set nIndice = nIndice + 1
.head 8 +  If sCamposChaveEValores != STRING_Null
.head 9 -  Set sCamposChaveEValores = SalStrLeftX( sCamposChaveEValores, SalStrLength( sCamposChaveEValores ) - 4 )
.head 8 +  If sDemaisCamposEValores != STRING_Null
.head 9 -  Set sDemaisCamposEValores = ',' || SalStrLeftX( sDemaisCamposEValores, SalStrLength( sDemaisCamposEValores ) - 1 )
.head 8 -  Set sSql = 'update ' || sNomeTabelaDestino || ' set ' ||
sCampoObjeto || ' = :sObjeto_p, '||
sCampoEstrutura || ' = :sEstrutura_p ' || sDemaisCamposEValores ||
' where ' || sCamposChaveEValores
.head 8 -  Call SqlPrepare( hSql_p, sSql )
.head 8 -  Call SqlSetLongBindDatatype( 1, 23 )
.head 8 -  Call SqlSetLongBindDatatype( 2, 23 )
.head 8 +  If SqlExecute( hSql_p )
.head 9 -  Call SqlCommit ( hSql_p )
.head 9 -  Call SqlSetLongBindDatatype( 1, 22 )
.head 9 -  Call SqlSetLongBindDatatype( 2, 22 )
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Call SqlSetLongBindDatatype( 1, 22 )
.head 9 -  Call SqlSetLongBindDatatype( 2, 22 )
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: Insere
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql_p
.head 7 -  Receive Long String: sObjeto_p
.head 7 -  Receive Long String: sEstrutura_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSql
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  String: sCampos
.head 7 -  String: sValor
.head 7 -  String: sValores
.head 6 +  Actions
.head 7 -  !
.head 7 +  If not SalArrayIsEmpty( oaCamposValores )
.head 8 -  Call SalArrayGetUpperBound( oaCamposValores, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 +  If oaCamposValores[nIndice].sTipoDados = 'n'
.head 10 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].nNumber'
.head 9 +  Else If oaCamposValores[nIndice].sTipoDados  = 's'
.head 10 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].sString'
.head 9 +  Else If oaCamposValores[nIndice].sTipoDados  = 't'
.head 10 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].dtDateTime'
.head 9 -  Set sCampos = sCampos ||  oaCamposValores[nIndice].sCampo || ','
.head 9 -  Set sValores = sValores || sValor || ','
.head 9 -  Set nIndice = nIndice + 1
.head 7 -  !
.head 7 +  If sCampos != STRING_Null
.head 8 -  Set sCampos =  ',' ||  SalStrLeftX( sCampos, SalStrLength( sCampos ) -1 )
.head 8 -  Set sValores =  ',' ||  SalStrLeftX( sValores, SalStrLength( sValores ) -1 )
.head 8 -  Set sCampos = sCampoObjeto || ',' || sCampoEstrutura || sCampos
.head 8 -  Set sValores = ':sObjeto_p,:sEstrutura_p' || sValores
.head 8 -  Set sSql = 'insert into ' || sNomeTabelaDestino ||
' ( ' || sCampos || ' ) values ( ' || sValores || ' ) '
.head 8 -  Call SqlPrepare( hSql_p, sSql )
.head 8 -  Call SqlSetLongBindDatatype( 1, 23 )
.head 8 -  Call SqlSetLongBindDatatype( 2, 23 )
.head 8 +  If SqlExecute( hSql_p )
.head 9 -  Call SqlCommit ( hSql_p )
.head 9 -  Call SqlSetLongBindDatatype( 1, 22 )
.head 9 -  Call SqlSetLongBindDatatype( 2, 22 )
.head 9 -  Return TRUE
.head 8 +  Else
.head 9 -  Call SqlSetLongBindDatatype( 1, 22 )
.head 9 -  Call SqlSetLongBindDatatype( 2, 22 )
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: SetaDestino
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeTabelaDestino_p
.head 7 -  String: sCampoObjeto_p
.head 7 -  String: sCampoEstrutura_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNomeTabelaDestino = sNomeTabelaDestino_p
.head 7 -  Set sCampoObjeto = sCampoObjeto_p
.head 7 -  Set sCampoEstrutura = sCampoEstrutura_p
.head 5 +  Function: SetaEstrutura
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNomeClasse_p
.head 7 -  String: sValorNomesCampos_p
.head 7 -  String: sValorTiposDadosCampos_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set oEstrutura.sNomeClasse = sNomeClasse_p
.head 7 -  Set oEstrutura.sNomesCampos = sValorNomesCampos_p
.head 7 -  Set oEstrutura.sTiposDadosCampos = sValorTiposDadosCampos_p
.head 5 +  Function: Recupera
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql_p
.head 7 -  Receive Long String: sObjeto_p
.head 7 -  Receive Long String: sEstrutura_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSql
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  String: sCamposChaveEValores
.head 7 -  String: sDemaisCampos
.head 7 -  String: sDemaisValores
.head 7 -  String: sValor
.head 7 -  Number: nFetchLocal
.head 6 +  Actions
.head 7 -  !
.head 7 +  If not SalArrayIsEmpty( oaCamposValores )
.head 8 -  Call SalArrayGetUpperBound( oaCamposValores, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 +  If oaCamposValores[nIndice].sTipoDados = 'n'
.head 10 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].nNumber'
.head 9 +  Else If oaCamposValores[nIndice].sTipoDados  = 's'
.head 10 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].sString'
.head 9 +  Else If oaCamposValores[nIndice].sTipoDados  = 't'
.head 10 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].dtDateTime'
.head 9 +  If oaCamposValores[nIndice].bChave
.head 10 -  Set sCamposChaveEValores = sCamposChaveEValores || oaCamposValores[nIndice].sCampo || ' = ' || sValor || ' and '
.head 9 +  Else
.head 10 -  Set sDemaisCampos = sDemaisCampos || oaCamposValores[nIndice].sCampo || ','
.head 10 -  Set sDemaisValores = sDemaisValores || sValor || ','
.head 9 -  Set nIndice = nIndice + 1
.head 8 +  If sCamposChaveEValores != STRING_Null
.head 9 -  Set sCamposChaveEValores = SalStrLeftX( sCamposChaveEValores, SalStrLength( sCamposChaveEValores ) - 4 )
.head 8 +  If sDemaisCampos != STRING_Null
.head 9 -  Set sDemaisCampos = ',' || SalStrLeftX( sDemaisCampos, SalStrLength( sDemaisCampos ) -1 )
.head 9 -  Set sDemaisValores = ',' || SalStrLeftX( sDemaisValores, SalStrLength( sDemaisValores ) -1 )
.head 7 -  Set sSql = 'select ' || sCampoObjeto || ', ' ||  sCampoEstrutura || sDemaisCampos ||
' into :sObjeto_p , :sEstrutura_p' || sDemaisValores ||
' from ' || sNomeTabelaDestino ||
' where ' || sCamposChaveEValores
.head 7 -  !
.head 7 +  If sCamposChaveEValores != STRING_Null
.head 8 -  Call SqlSetLongBindDatatype( 1, 23 )
.head 8 -  Call SqlSetLongBindDatatype( 2, 23 )
.head 8 -  Call SqlPrepareAndExecute( hSql_p, sSql )
.head 8 -  !
.head 8 -  Call SqlSetLongBindDatatype( 1, 22 )
.head 8 -  Call SqlSetLongBindDatatype( 2, 22 )
.head 8 -  Return SqlFetchNext( hSql_p, nFetchLocal )
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: Existe
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSql
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  String: sCamposChaveEValores
.head 7 -  String: sCamposChave
.head 7 -  String: sValor
.head 7 -  Number: nFetchLocal
.head 6 +  Actions
.head 7 -  !
.head 7 +  If not SalArrayIsEmpty( oaCamposValores )
.head 8 -  Call SalArrayGetUpperBound( oaCamposValores, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 +  If oaCamposValores[nIndice].bChave
.head 10 +  If oaCamposValores[nIndice].sTipoDados = 'n'
.head 11 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].nNumber'
.head 10 +  Else If oaCamposValores[nIndice].sTipoDados  = 's'
.head 11 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].sString'
.head 10 +  Else If oaCamposValores[nIndice].sTipoDados  = 't'
.head 11 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].dtDateTime'
.head 10 -  Set sCamposChaveEValores = sCamposChaveEValores || oaCamposValores[nIndice].sCampo || ' = ' || sValor || ' and '
.head 10 -  Set sCamposChave = sCamposChave || oaCamposValores[nIndice].sCampo || ','
.head 9 -  Set nIndice = nIndice + 1
.head 8 +  If sCamposChaveEValores != STRING_Null
.head 9 -  Set sCamposChaveEValores = SalStrLeftX( sCamposChaveEValores, SalStrLength( sCamposChaveEValores ) - 4 )
.head 9 -  Set sCamposChave = SalStrLeftX( sCamposChave, SalStrLength( sCamposChave ) - 1 )
.head 7 -  Set sSql = 'select  ' || sCamposChave ||
' from ' || sNomeTabelaDestino ||
' where ' || sCamposChaveEValores
.head 7 -  !
.head 7 +  If sCamposChaveEValores != STRING_Null
.head 8 -  Call SqlPrepareAndExecute( hSql_p, sSql )
.head 8 -  !
.head 8 -  Return SqlFetchNext( hSql_p, nFetchLocal )
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sNomeTabelaDestino  = STRING_Null
.head 7 -  Call SalArraySetUpperBound( oaCamposValores,1, -1 )
.head 7 -  Set sCampoObjeto = STRING_Null
.head 7 -  Set sCampoEstrutura = STRING_Null
.head 7 -  Set oEstrutura.sNomesCampos = STRING_Null
.head 7 -  Set oEstrutura.sTiposDadosCampos = STRING_Null
.head 5 +  Function: ModificaValorNumero
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sCampo_p
.head 7 -  Number: nValor_p
.head 7 -  Boolean: bChave_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaCamposValores )
.head 8 -  Set nIndice = LocalizaCampo( sCampo_p, oaCamposValores )
.head 8 +  If nIndice < 0
.head 9 -  Call SalArrayGetUpperBound( oaCamposValores, 1, nIndice )
.head 9 -  Set nIndice = nIndice + 1
.head 7 +  Else
.head 8 -  Set nIndice = 0
.head 7 -  !
.head 7 -  Set oaCamposValores[nIndice].sCampo = sCampo_p
.head 7 -  Set oaCamposValores[nIndice].sTipoDados = 'n'
.head 7 -  Set oaCamposValores[nIndice].nNumber = nValor_p
.head 7 -  Set oaCamposValores[nIndice].bChave = bChave_p
.head 7 -  Return nIndice
.head 5 +  Function: ModificaValorString
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sCampo_p
.head 7 -  String: sValor_p
.head 7 -  Boolean: bChave_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaCamposValores )
.head 8 -  Set nIndice = LocalizaCampo( sCampo_p, oaCamposValores )
.head 8 +  If nIndice < 0
.head 9 -  Call SalArrayGetUpperBound( oaCamposValores, 1, nIndice )
.head 9 -  Set nIndice = nIndice + 1
.head 7 +  Else
.head 8 -  Set nIndice = 0
.head 7 -  !
.head 7 -  Set oaCamposValores[nIndice].sCampo = sCampo_p
.head 7 -  Set oaCamposValores[nIndice].sTipoDados = 's'
.head 7 -  Set oaCamposValores[nIndice].sString = sValor_p
.head 7 -  Set oaCamposValores[nIndice].bChave = bChave_p
.head 7 -  Return nIndice
.head 5 +  Function: ModificaValorData
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sCampo_p
.head 7 -  Date/Time: dtValor_p
.head 7 -  Boolean: bChave_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaCamposValores )
.head 8 -  Set nIndice = LocalizaCampo( sCampo_p, oaCamposValores )
.head 8 +  If nIndice < 0
.head 9 -  Call SalArrayGetUpperBound( oaCamposValores, 1, nIndice )
.head 9 -  Set nIndice = nIndice + 1
.head 7 +  Else
.head 8 -  Set nIndice = 0
.head 7 -  !
.head 7 -  Set oaCamposValores[nIndice].sCampo = sCampo_p
.head 7 -  Set oaCamposValores[nIndice].sTipoDados = 't'
.head 7 -  Set oaCamposValores[nIndice].dtDateTime = dtValor_p
.head 7 -  Set oaCamposValores[nIndice].bChave = bChave_p
.head 7 -  Return nIndice
.head 5 +  Function: LocalizaCampo
.head 6 -  Description: 


.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  String: sCampoValor_p
.head 7 -  FunctionalVar: oaCamposValores_p[*]
.head 8 -  Class: fcSonEstruturaCampoValor
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRet
.head 7 -  Number: nLast
.head 7 -  Number: nIndex
.head 6 +  Actions
.head 7 -  Set nRet = -1
.head 7 +  If not SalArrayIsEmpty( oaCamposValores_p )
.head 8 -  Call SalArrayGetUpperBound( oaCamposValores_p,1, nLast )
.head 8 -  Set nIndex = 0
.head 8 +  While nIndex <= nLast
.head 9 +  If oaCamposValores_p[nIndex].sCampo= sCampoValor_p
.head 10 -  Set nRet = nIndex
.head 10 -  Break
.head 9 -  Set nIndex = nIndex + 1
.head 7 -  Return nRet
.head 5 +  Function: RetornaNomeClasse
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSql
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  String: sCamposChaveEValores
.head 7 -  String: sCamposChave
.head 7 -  String: sValor
.head 7 -  Number: nFetchLocal
.head 7 -  Long String: sBufferEstrutura
.head 6 +  Actions
.head 7 -  !
.head 7 +  If not SalArrayIsEmpty( oaCamposValores )
.head 8 -  Call SalArrayGetUpperBound( oaCamposValores, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 +  If oaCamposValores[nIndice].bChave
.head 10 +  If oaCamposValores[nIndice].sTipoDados = 'n'
.head 11 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].nNumber'
.head 10 +  Else If oaCamposValores[nIndice].sTipoDados  = 's'
.head 11 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].sString'
.head 10 +  Else If oaCamposValores[nIndice].sTipoDados  = 't'
.head 11 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].dtDateTime'
.head 10 -  Set sCamposChaveEValores = sCamposChaveEValores || oaCamposValores[nIndice].sCampo || ' = ' || sValor || ' and '
.head 10 -  Set sCamposChave = sCamposChave || oaCamposValores[nIndice].sCampo || ','
.head 9 -  Set nIndice = nIndice + 1
.head 8 +  If sCamposChaveEValores != STRING_Null
.head 9 -  Set sCamposChaveEValores = SalStrLeftX( sCamposChaveEValores, SalStrLength( sCamposChaveEValores ) - 4 )
.head 9 -  Set sCamposChave = SalStrLeftX( sCamposChave, SalStrLength( sCamposChave ) - 1 )
.head 7 -  Set sSql = 'select  ' || sCampoEstrutura ||
' into :sBufferEstrutura ' ||
' from ' || sNomeTabelaDestino ||
' where ' || sCamposChaveEValores
.head 7 -  !
.head 7 +  If sCamposChaveEValores != STRING_Null
.head 8 -  Call SqlSetLongBindDatatype( 1, 23 )
.head 8 -  Call SqlPrepareAndExecute( hSql_p, sSql )
.head 8 -  Call SqlFetchNext( hSql_p, nFetchLocal )
.head 8 -  Call SqlSetLongBindDatatype( 1, 22 )
.head 8 -  !
.head 8 -  Call XSalUdvFromString( oEstrutura, sBufferEstrutura, 'sss' )
.head 8 -  !
.head 8 -  Return oEstrutura.sNomeClasse
.head 7 +  Else
.head 8 -  Return STRING_Null
.head 5 +  Function: Exclui
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: hSql_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sSql
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  String: sCamposChaveEValores
.head 7 -  String: sValor
.head 6 +  Actions
.head 7 -  !
.head 7 +  If not SalArrayIsEmpty( oaCamposValores )
.head 8 -  Call SalArrayGetUpperBound( oaCamposValores, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 +  If oaCamposValores[nIndice].bChave
.head 10 +  If oaCamposValores[nIndice].sTipoDados = 'n'
.head 11 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].nNumber'
.head 10 +  Else If oaCamposValores[nIndice].sTipoDados  = 's'
.head 11 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].sString'
.head 10 +  Else If oaCamposValores[nIndice].sTipoDados  = 't'
.head 11 -  Set sValor = ':oaCamposValores[' || SalNumberToStrX( nIndice, 0 ) || '].dtDateTime'
.head 10 -  Set sCamposChaveEValores = sCamposChaveEValores || oaCamposValores[nIndice].sCampo || ' = ' || sValor || ' and '
.head 9 -  Set nIndice = nIndice + 1
.head 8 +  If sCamposChaveEValores != STRING_Null
.head 9 -  Set sCamposChaveEValores = SalStrLeftX( sCamposChaveEValores, SalStrLength( sCamposChaveEValores ) - 4 )
.head 9 -  Set sSql = 'delete from ' || sNomeTabelaDestino ||
' where ' || sCamposChaveEValores
.head 9 +  If SqlPrepareAndExecute( hSql_p, sSql )
.head 10 -  Call SqlCommit ( hSql_p )
.head 10 -  Return TRUE
.head 9 +  Else
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Return FALSE
.head 3 +  Functional Class: fcSonEstruturaObjeto
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sNomeClasse
.head 5 -  String: sNomesCampos
.head 5 -  String: sTiposDadosCampos
.head 4 -  Functions
.head 3 +  Functional Class: fcSonEstruturaCampoValor
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nNumber
.head 5 -  Date/Time: dtDateTime
.head 5 -  String: sString
.head 5 -  String: sCampo
.head 5 -  Boolean: bChave
.head 5 -  String: sTipoDados
.head 4 -  Functions
.head 3 +  Functional Class: cTagReplace
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sPage
.head 5 -  String: sToken
.head 5 -  String: saParamList[*]
.head 5 -  String: saNames[*]
.head 5 -  String: saValues[*]
.head 5 -  String: sReplace
.head 4 +  Functions
.head 5 +  Function: SolveTags
.head 6 -  Description: Altera o Source. Caso existam tokens proprietários. Do tipo <# >
dispara o evento para tratar o token encontrado.
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sSource
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sNewSource
.head 7 -  Number: nChar
.head 7 -  Boolean: bEndSource
.head 7 -  String: sToken
.head 7 -  String: sParam
.head 7 -  String: saParamList[*]
.head 7 -  String: sReplace
.head 6 +  Actions
.head 7 -  Set sNewSource = STRING_Null
.head 7 +  Loop
.head 8 -  Set nChar = 0
.head 8 +  While SalStrFirstC( sSource, nChar )
.head 9 +  If nChar = 60 ! ( < )
.head 10 -  Break
.head 9 -  Set sNewSource = sNewSource || SalNumberToChar( nChar )
.head 8 +  If nChar = 0
.head 9 -  Break
.head 8 +  If nChar = 60 ! ( < )
.head 9 -  Call SalStrFirstC( sSource, nChar )
.head 9 +  If nChar  = 35 ! ( # )
.head 10 +  If ExtractTag( sSource, sToken, sParam )
.head 11 -  Call ExtractFields ( sParam, saParamList , saNames, saValues)
.head 11 -  Set sReplace = ..OnTagReplace( sToken, saNames, saValues )
.head 11 -  Set sNewSource = sNewSource || sReplace
.head 9 +  Else
.head 10 -  Set sNewSource = sNewSource || '<' || SalNumberToChar( nChar )
.head 7 -  !
.head 7 -  Return sNewSource
.head 5 +  Function: ExtractFields
.head 6 -  Description: Extrai todos os tokens do html
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sParam
.head 7 -  String: saStrings[*]
.head 7 -  String: saNames[*]
.head 7 -  String: saValues[*]
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sCopy
.head 7 -  Number: nChar
.head 7 -  String: sTemp
.head 7 -  Number: nIndex
.head 7 -  Boolean: bEndString
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  Number: nIndNames
.head 7 -  Number: nIndValues
.head 7 -  Boolean: bAposIgual
.head 7 -  Boolean: bSalta
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( saStrings, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( saNames, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( saValues, 1, -1 )
.head 7 -  !
.head 7 -  ! Substitui todos os caracteres inválidos como token por um espaço em branco
.head 7 -  !
.head 7 -  Set sParam = VisStrSubstitute( sParam, SalNumberToChar( 0 ), ' ' )
.head 7 -  Set sParam = VisStrSubstitute( sParam, SalNumberToChar( 9 ), ' ' )
.head 7 -  Set sParam = VisStrSubstitute( sParam, SalNumberToChar( 10 ), ' ' )
.head 7 -  Set sParam = VisStrSubstitute( sParam, SalNumberToChar( 13 ), ' ' )
.head 7 -  !
.head 7 -  ! Substitui todos as duplas de espaços em branco por um único espaço em branco
.head 7 -  !
.head 7 -  Set sParam = VisStrSubstitute( sParam, '  ', ' ' )
.head 7 -  !
.head 7 -  ! Tokeniza as tags considerando que dentro de uma aspas duplas (") tudo o que fica
dentro até ser encontrado outras (") é um único token
.head 7 -  !
.head 7 -  Set sTemp = STRING_Null
.head 7 -  Set nIndex = 0
.head 7 -  Set sCopy= sParam
.head 7 -  Set bEndString = FALSE
.head 7 +  While SalStrFirstC( sCopy, nChar )
.head 8 +  If nChar = 32 or nChar = 61 ! Espaço em branco or ( = )
.head 9 +  If sTemp != STRING_Null
.head 10 -  Set saStrings[nIndex] = sTemp
.head 10 -  Set sTemp = STRING_Null
.head 10 -  Set nIndex = nIndex + 1
.head 9 +  If nChar = 61
.head 10 -  Set saStrings[nIndex] = '='
.head 10 -  Set nIndex = nIndex + 1
.head 8 +  Else If nChar = 34 or nChar = 39 ! ('') Aspas duplas ou (') aspas simples
.head 9 +  Loop
.head 10 -  Set bEndString = not SalStrFirstC( sCopy, nChar )
.head 10 +  If nChar = 34 or nChar = 39 or bEndString
.head 11 -  Break
.head 10 -  Set sTemp = sTemp || SalNumberToChar( nChar )
.head 8 +  Else
.head 9 -  Set sTemp = sTemp || SalNumberToChar( nChar )
.head 7 -  !
.head 7 +  If sTemp != STRING_Null
.head 8 -  Set saStrings[nIndex] = sTemp
.head 7 -  !
.head 7 -  Set bAposIgual = FALSE
.head 7 +  If not SalArrayIsEmpty( saStrings )
.head 8 -  Call SalArrayGetUpperBound( saStrings, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 -  Set nIndNames = 0
.head 8 -  Set nIndValues = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 -  Set bSalta = FALSE
.head 9 +  If SalStrScan( saStrings[nIndice], '=' ) >= 0
.head 10 -  Set bAposIgual = TRUE
.head 10 -  Set bSalta = TRUE
.head 9 +  If not bSalta
.head 10 +  If not bAposIgual
.head 11 -  Set saNames[nIndNames] = saStrings[nIndice]
.head 11 -  Set nIndNames = nIndNames + 1
.head 10 +  Else
.head 11 -  Set saValues[nIndValues] = saStrings[nIndice]
.head 11 -  Set nIndValues = nIndValues + 1
.head 11 -  Set bAposIgual = FALSE
.head 9 -  Set nIndice = nIndice + 1
.head 5 +  Function: ExtractTag
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Receive String: sSource_p
.head 7 -  Receive String: sToken_p
.head 7 -  Receive String: sParam_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nChar
.head 7 -  String: sTag
.head 6 +  Actions
.head 7 -  !
.head 7 -  Set sToken_p = STRING_Null
.head 7 -  Set sParam_p = STRING_Null
.head 7 +  Loop
.head 8 +  If SalStrFirstC( sSource_p, nChar )
.head 9 +  If nChar = 34
.head 10 +  Loop
.head 11 -  Set sTag = sTag || SalNumberToChar( nChar )
.head 11 +  If SalStrFirstC( sSource_p, nChar )
.head 12 +  If nChar = 34
.head 13 -  Set sTag = sTag || SalNumberToChar( nChar )
.head 13 -  Break
.head 11 +  Else
.head 12 -  Break
.head 9 +  Else If nChar = 39
.head 10 +  Loop
.head 11 -  Set sTag = sTag || SalNumberToChar( nChar )
.head 11 +  If SalStrFirstC( sSource_p, nChar )
.head 12 +  If nChar = 39
.head 13 -  Set sTag = sTag || SalNumberToChar( nChar )
.head 13 -  Break
.head 11 +  Else
.head 12 -  Break
.head 9 +  Else
.head 10 +  If nChar = 62 ! ( > )
.head 11 -  Break
.head 10 +  Else
.head 11 -  Set sTag = sTag || SalNumberToChar( nChar )
.head 8 +  Else
.head 9 -  Break
.head 7 -  !
.head 7 +  Loop
.head 8 +  If SalStrFirstC( sTag, nChar )
.head 9 +  If (nChar = 32 or nChar=34 or nChar = 39 ) ! espaço em branco ou ( ' ) ou ( " )
.head 10 -  Break
.head 9 +  Else
.head 10 -  Set sToken_p = sToken_p || SalNumberToChar (nChar )
.head 8 +  Else
.head 9 -  Break
.head 7 -  !
.head 7 -  Set sParam_p = sTag
.head 7 -  !
.head 7 -  Return ( SalStrLength( sToken_p ) > 0 or SalStrLength( sParam_p ) > 0 )
.head 5 +  Function: returnValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sName
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndFind
.head 7 -  String: sValue
.head 6 +  Actions
.head 7 -  Set sValue = STRING_Null
.head 7 -  Set nIndFind = VisArrayFindString( saNames, sName )
.head 7 +  If nIndFind >= 0
.head 8 -  Set sValue = saValues[nIndFind]
.head 7 -  Return sValue
.head 5 +  Function: OnTagReplace
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sToken_p
.head 7 -  String: saNames_p[*]
.head 7 -  String: saValues_p[*]
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return STRING_Null
.head 3 +  Functional Class: cCodeGeneration
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cTagReplace
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  FunctionalVar: aModelFile
.head 6 -  Class: cdkApplication
.head 5 -  FunctionalVar: aCustomFile
.head 6 -  Class: cdkApplication
.head 5 -  FunctionalVar: oTable
.head 6 -  Class: fcDBTabela
.head 5 -  FunctionalVar: oaConditions[*]
.head 6 -  Class: cCondition
.head 4 +  Functions
.head 5 +  Function: ListDistinctFunctions
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: aModelClass_p
.head 8 -  Class: cdkClass
.head 7 -  FunctionalVar: aCustomClass_p
.head 8 -  Class: cdkClass
.head 7 -  Receive String: saModelFunctionsToUpdate_p[*]
.head 7 -  Receive String: sPreviousCustomFunction_p
.head 7 -  Receive String: saModelFunctionsToAdd_p[*]
.head 7 -  Receive String: sPreviousProtectedCustomFunction_p
.head 7 -  Receive String: saModelProtectedFunctionsToAdd_p[*]
.head 7 -  Receive String: saModelProtectedFunctionsToChangeParameters_p[*]
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bCustomBegin
.head 7 -  Boolean: bCustomEnd
.head 7 -  String: saModelFunctions[*]
.head 7 -  String: saModelProtectedFunctions[*]
.head 7 -  String: saCustomFunctions[*]
.head 7 -  String: saCustomProtectedFunctions[*]
.head 7 -  FunctionalVar: aItem
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aParent
.head 8 -  Class: cdkItem
.head 7 -  String: sText
.head 7 -  Number: nItem
.head 7 -  Number: nOutline
.head 7 -  Number: nType
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  Number: nInd
.head 7 -  Number: nIndFunction
.head 7 -  FunctionalVar: aModelFunction
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: aCustomFunction
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: oaModelParameters[*]
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: oaCustomParameters[*]
.head 8 -  Class: cdkItem
.head 7 -  Number: nNumberOfModelParams
.head 7 -  Number: nNumberOfCustomParams
.head 7 -  Number: nIndParams
.head 7 -  Number: nUltimoIndParams
.head 7 -  String: sClassNameModel
.head 7 -  String: sClassNameCustom
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( saModelFunctionsToUpdate_p, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( saModelFunctionsToAdd_p, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( saModelProtectedFunctionsToAdd_p, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( saModelProtectedFunctionsToChangeParameters_p, 1, -1 )
.head 7 -  !
.head 7 -  ! Getting custom protected functions
.head 7 -  Set nOutline =  aCustomClass_p.GetOutline ()
.head 7 -  Set nItem = aCustomClass_p.GetItem ()
.head 7 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  Set nIndice = 0
.head 7 +  While nItem > 0
.head 8 -  Call aItem.Initialize( nOutline, nItem )
.head 8 -  Call aItem.GetParent( aParent )
.head 8 +  If aParent.GetItemType () = CDK_IT_ClassDefinitions
.head 9 -  Break
.head 8 +  If not aItem.IsReadOnly ()
.head 9 -  Set sText = aItem.GetText()
.head 9 +  If SalStrScan( sText, '@' ) >= 0 and SalStrScan( sText, 'Custom' ) >= 0 and SalStrScan( sText, 'Begin' ) >= 0
.head 10 -  Set bCustomBegin = TRUE
.head 10 -  Set bCustomEnd = FALSE
.head 9 +  If SalStrScan( sText, '@' ) >= 0 and SalStrScan( sText, 'Custom' ) >= 0 and SalStrScan( sText, 'End' ) >= 0
.head 10 -  Set bCustomBegin = FALSE
.head 10 -  Set bCustomEnd = TRUE
.head 9 +  If bCustomBegin
.head 10 -  Set nType = aItem.GetItemType ()
.head 10 +  If nType = CDK_IT_Function
.head 11 -  Set saCustomProtectedFunctions[nIndice] = aItem.GetName ()
.head 11 -  Set nIndice = nIndice + 1
.head 9 +  If bCustomEnd
.head 10 -  Set bCustomBegin = FALSE
.head 10 -  Set bCustomEnd = FALSE
.head 8 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  !
.head 7 -  ! Getting model protected functions
.head 7 -  Set nOutline =  aModelClass_p.GetOutline ()
.head 7 -  Set nItem = aModelClass_p.GetItem ()
.head 7 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  Set nIndice = 0
.head 7 +  While nItem > 0
.head 8 -  Call aItem.Initialize( nOutline, nItem )
.head 8 -  Call aItem.GetParent( aParent )
.head 8 +  If aParent.GetItemType () = CDK_IT_ClassDefinitions
.head 9 -  Break
.head 8 +  If not aItem.IsReadOnly ()
.head 9 -  Set sText = aItem.GetText()
.head 9 +  If SalStrScan( sText, '@' ) >= 0 and SalStrScan( sText, 'Custom' ) >= 0 and SalStrScan( sText, 'Begin' ) >= 0
.head 10 -  Set bCustomBegin = TRUE
.head 10 -  Set bCustomEnd = FALSE
.head 9 +  If SalStrScan( sText, '@' ) >= 0 and SalStrScan( sText, 'Custom' ) >= 0 and SalStrScan( sText, 'End' ) >= 0
.head 10 -  Set bCustomBegin = FALSE
.head 10 -  Set bCustomEnd = TRUE
.head 9 +  If bCustomBegin
.head 10 -  Set nType = aItem.GetItemType ()
.head 10 +  If nType = CDK_IT_Function
.head 11 -  Set saModelProtectedFunctions[nIndice] = aItem.GetName ()
.head 11 -  Set nIndice = nIndice + 1
.head 9 +  If bCustomEnd
.head 10 -  Set bCustomBegin = FALSE
.head 10 -  Set bCustomEnd = FALSE
.head 8 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  !
.head 7 -  Call aCustomClass_p.EnumFunctions( saCustomFunctions )
.head 7 -  ! Getting ModelFunctionsToUpdate
.head 7 -  Set nInd = 0
.head 7 -  Call aModelClass_p.EnumFunctions( saModelFunctions )
.head 7 +  If not SalArrayIsEmpty( saModelFunctions )
.head 8 -  Call SalArrayGetUpperBound( saModelFunctions, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 +  If VisArrayFindString( saCustomProtectedFunctions, saModelFunctions[nIndice] ) < 0 and
   VisArrayFindString( saModelProtectedFunctions, saModelFunctions[nIndice] ) < 0 and
   VisArrayFindString( saCustomFunctions, saModelFunctions[nIndice] ) >= 0
.head 10 -  Set saModelFunctionsToUpdate_p[nInd] = saModelFunctions[nIndice]
.head 10 -  Set nInd = nInd + 1
.head 9 -  Set nIndice = nIndice + 1
.head 8 -  !
.head 7 -  ! Getting ModelFunctionsToAdd
.head 7 -  Set nInd = 0
.head 7 +  If not SalArrayIsEmpty( saModelFunctions )
.head 8 -  Call SalArrayGetUpperBound( saModelFunctions, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 +  If VisArrayFindString( saCustomFunctions, saModelFunctions[nIndice] ) < 0 and
   VisArrayFindString( saModelProtectedFunctions, saModelFunctions[nIndice] ) < 0
.head 10 -  Set saModelFunctionsToAdd_p[nInd] = saModelFunctions[nIndice]
.head 10 -  Set nInd = nInd + 1
.head 9 -  Set nIndice = nIndice + 1
.head 8 -  !
.head 7 -  ! Getting ModelProtectedFunctionsToAdd
.head 7 -  Set nInd = 0
.head 7 +  If not SalArrayIsEmpty( saModelFunctions )
.head 8 -  Call SalArrayGetUpperBound( saModelFunctions, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 +  If VisArrayFindString( saCustomFunctions, saModelFunctions[nIndice] ) < 0 and
   VisArrayFindString( saModelProtectedFunctions, saModelFunctions[nIndice] ) >=0
.head 10 -  Set saModelProtectedFunctionsToAdd_p[nInd] = saModelFunctions[nIndice]
.head 10 -  Set nInd = nInd + 1
.head 9 -  Set nIndice = nIndice + 1
.head 8 -  !
.head 7 -  ! Getting sPreviousCustomFunction_p
.head 7 +  If not SalArrayIsEmpty( saCustomFunctions )
.head 8 -  Set nInd = VisArrayFindString( saCustomFunctions, saCustomProtectedFunctions[0] )
.head 8 -  Set nInd = nInd - 1
.head 8 +  If nInd >=0
.head 9 -  Set sPreviousCustomFunction_p = saCustomFunctions[nInd]
.head 8 +  Else
.head 9 -  Call SalArrayGetUpperBound( saCustomFunctions, 1, nInd )
.head 9 -  Set sPreviousCustomFunction_p = saCustomFunctions[nInd]
.head 7 -  ! Getting sPreviousProtectedCustomFunction_p
.head 7 +  If not SalArrayIsEmpty( saCustomProtectedFunctions )
.head 8 -  Call SalArrayGetUpperBound( saCustomProtectedFunctions, 1, nUltimoIndice )
.head 8 -  Set sPreviousProtectedCustomFunction_p = saCustomProtectedFunctions[nUltimoIndice]
.head 7 -  ! Getting saModelProtectedFunctionsToChangeParameters_p
.head 7 -  Set nInd = 0
.head 7 +  If ( not SalArrayIsEmpty( saModelProtectedFunctions ) ) and ( not SalArrayIsEmpty( saCustomProtectedFunctions ) )
.head 8 -  Call SalArrayGetUpperBound( saModelProtectedFunctions, 1, nUltimoIndice )
.head 8 -  Set nIndice = 0
.head 8 +  While nIndice <= nUltimoIndice
.head 9 -  Set nIndFunction = VisArrayFindString( saCustomProtectedFunctions, saModelProtectedFunctions[nIndice] )
.head 9 +  If nIndFunction >= 0
.head 10 -  Call aModelClass_p.GetFunction( saModelProtectedFunctions[nIndice], aModelFunction )
.head 10 -  Set nNumberOfModelParams =  aModelFunction.EnumChildObjects( CDK_IT_Parameters, oaModelParameters )
.head 10 -  Call aCustomClass_p.GetFunction( saModelProtectedFunctions[nIndice], aCustomFunction )
.head 10 -  Set nNumberOfCustomParams =  aCustomFunction.EnumChildObjects( CDK_IT_Parameters, oaCustomParameters )
.head 10 +  If nNumberOfModelParams != nNumberOfCustomParams
.head 11 -  Set saModelProtectedFunctionsToChangeParameters_p[nInd] = saModelProtectedFunctions[nIndice]
.head 11 -  Set nInd = nInd + 1
.head 10 +  Else
.head 11 +  If not SalArrayIsEmpty( oaModelParameters )
.head 12 -  Set nIndParams = 0
.head 12 -  Call SalArrayGetUpperBound( oaModelParameters, 1, nUltimoIndParams )
.head 12 +  While nIndParams <= nUltimoIndParams
.head 13 +  If oaModelParameters[nIndParams].GetName () != oaCustomParameters[nIndParams].GetName () or
   oaModelParameters[nIndParams].GetItemType () != oaCustomParameters[nIndParams].GetItemType ()
.head 14 -  Set saModelProtectedFunctionsToChangeParameters_p[nInd] = saModelProtectedFunctions[nIndice]
.head 14 -  Set nInd = nInd + 1
.head 13 +  Else If oaModelParameters[nIndParams].GetItemType () = CDK_IT_ClassObject
.head 14 +  If oaModelParameters[nIndParams].GetObjectClass () != oaCustomParameters[nIndParams].GetObjectClass ()
.head 15 -  Set saModelProtectedFunctionsToChangeParameters_p[nInd] = saModelProtectedFunctions[nIndice]
.head 15 -  Set nInd = nInd + 1
.head 13 -  Set nIndParams = nIndParams + 1
.head 9 -  Set nIndice = nIndice + 1
.head 7 -  !
.head 5 +  Function: CopyVariables
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: aClassSource_p
.head 8 -  Class: cdkClass
.head 7 -  FunctionalVar: aClassTarget_p
.head 8 -  Class: cdkClass
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: aaItens[*]
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aItem
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aCustomClassVariables
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aCustomInstanceVariables
.head 8 -  Class: cdkItem
.head 7 -  String: saVariables[*]
.head 7 -  String: saTypes[*]
.head 7 -  Number: nIndex
.head 7 -  Number: nLastIndex
.head 7 -  String: sClassName
.head 7 -  String: saProtectedInstanceVariables[*]
.head 7 -  String: saProtectedClassVariables[*]
.head 7 -  Number: nItem
.head 7 -  Number: nOutline
.head 7 -  FunctionalVar: aParent
.head 8 -  Class: cdkItem
.head 7 -  Number: nType
.head 7 -  String: sText
.head 7 -  String: sName
.head 7 -  Boolean: bCustomBegin
.head 7 -  Boolean: bCustomEnd
.head 6 +  Actions
.head 7 -  ! Getting custom protected variables
.head 7 -  Set nOutline =  aClassTarget_p.GetOutline ()
.head 7 -  Set nItem = aClassTarget_p.GetItem ()
.head 7 -  ! Find Class Variables
.head 7 +  While nItem > 0
.head 8 -  Call aItem.Initialize( nOutline, nItem )
.head 8 +  If aItem.GetItemType () = CDK_IT_ClassVariables
.head 9 -  Call aCustomClassVariables.InitializeFromObject( aItem )
.head 9 -  Break
.head 8 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  Set nIndex = 0
.head 7 +  While nItem > 0
.head 8 -  Call aItem.Initialize( nOutline, nItem )
.head 8 -  Call aItem.GetParent( aParent )
.head 8 +  If aParent.GetItemType () != CDK_IT_ClassVariables
.head 9 -  Break
.head 8 +  If not aItem.IsReadOnly ()
.head 9 -  Set sText = aItem.GetText()
.head 9 +  If SalStrScan( sText, '@' ) >= 0 and SalStrScan( sText, 'Custom' ) >= 0 and SalStrScan( sText, 'Begin' ) >= 0
.head 10 -  Set bCustomBegin = TRUE
.head 10 -  Set bCustomEnd = FALSE
.head 9 +  If SalStrScan( sText, '@' ) >= 0 and SalStrScan( sText, 'Custom' ) >= 0 and SalStrScan( sText, 'End' ) >= 0
.head 10 -  Set bCustomBegin = FALSE
.head 10 -  Set bCustomEnd = TRUE
.head 9 +  If bCustomBegin
.head 10 -  Set nType = aItem.GetItemType ()
.head 10 +  If nType = CDK_IT_Number or nType = CDK_IT_String or nType = CDK_IT_LongString or nType = CDK_IT_DateTime or nType = CDK_IT_ClassObject
.head 11 -  Set saProtectedClassVariables[nIndex] = aItem.GetName ()
.head 11 -  Set nIndex = nIndex + 1
.head 9 +  If bCustomEnd
.head 10 -  Set bCustomBegin = FALSE
.head 10 -  Set bCustomEnd = FALSE
.head 8 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  !
.head 7 -  ! Find Instance Variables
.head 7 +  While nItem > 0
.head 8 -  Call aItem.Initialize( nOutline, nItem )
.head 8 +  If aItem.GetItemType () = CDK_IT_InstanceVars
.head 9 -  Call aCustomInstanceVariables.InitializeFromObject( aItem )
.head 9 -  Break
.head 8 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  Set nIndex = 0
.head 7 +  While nItem > 0
.head 8 -  Call aItem.Initialize( nOutline, nItem )
.head 8 -  Call aItem.GetParent( aParent )
.head 8 +  If aParent.GetItemType () != CDK_IT_InstanceVars
.head 9 -  Break
.head 8 +  If not aItem.IsReadOnly ()
.head 9 -  Set sText = aItem.GetText()
.head 9 +  If SalStrScan( sText, '@' ) >= 0 and SalStrScan( sText, 'Custom' ) >= 0 and SalStrScan( sText, 'Begin' ) >= 0
.head 10 -  Set bCustomBegin = TRUE
.head 10 -  Set bCustomEnd = FALSE
.head 9 +  If SalStrScan( sText, '@' ) >= 0 and SalStrScan( sText, 'Custom' ) >= 0 and SalStrScan( sText, 'End' ) >= 0
.head 10 -  Set bCustomBegin = FALSE
.head 10 -  Set bCustomEnd = TRUE
.head 9 +  If bCustomBegin
.head 10 -  Set nType = aItem.GetItemType ()
.head 10 +  If nType = CDK_IT_Number or nType = CDK_IT_String or nType = CDK_IT_LongString or nType = CDK_IT_DateTime or nType = CDK_IT_ClassObject
.head 11 -  Set saProtectedInstanceVariables[nIndex] = aItem.GetName ()
.head 11 -  Set nIndex = nIndex + 1
.head 9 +  If bCustomEnd
.head 10 -  Set bCustomBegin = FALSE
.head 10 -  Set bCustomEnd = FALSE
.head 8 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  !
.head 7 -  ! Clear target variables
.head 7 -  Call SalArraySetUpperBound( saVariables, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( saTypes, 1, -1 )
.head 7 +  If aClassTarget_p.EnumClassVariables( saVariables, saTypes ) > 0
.head 8 +  If not SalArrayIsEmpty( saVariables )
.head 9 -  Call SalArrayGetUpperBound( saVariables, 1, nLastIndex )
.head 9 -  Set nIndex = 0
.head 9 +  While nIndex <= nLastIndex
.head 10 +  If VisArrayFindString( saProtectedClassVariables,  saVariables[nIndex] ) < 0
.head 11 -  Call aClassTarget_p.DeleteClassVariable( saVariables[nIndex] )
.head 10 -  Set nIndex = nIndex + 1
.head 7 -  Call SalArraySetUpperBound( saVariables, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( saTypes, 1, -1 )
.head 7 +  If aClassTarget_p.EnumInstanceVariables( saVariables, saTypes ) > 0
.head 8 +  If not SalArrayIsEmpty( saVariables )
.head 9 -  Call SalArrayGetUpperBound( saVariables, 1, nLastIndex )
.head 9 -  Set nIndex = 0
.head 9 +  While nIndex <= nLastIndex
.head 10 +  If VisArrayFindString( saProtectedInstanceVariables,  saVariables[nIndex] ) < 0
.head 11 -  Call aClassTarget_p.DeleteInstanceVariable( saVariables[nIndex] )
.head 10 -  Set nIndex = nIndex + 1
.head 7 -  ! Copy source variables
.head 7 -  Call SalArraySetUpperBound( aaItens, 1, -1 )
.head 7 +  If aClassSource_p.EnumChildObjects( CDK_IT_ClassVariables, aaItens ) > 0
.head 8 +  If not SalArrayIsEmpty( aaItens )
.head 9 -  Call SalArrayGetUpperBound( aaItens, 1, nLastIndex )
.head 9 -  Set nIndex = 0
.head 9 +  While nIndex <= nLastIndex
.head 10 +  If nIndex = 0
.head 11 -  Call aCustomClassVariables.InsertFirstItem( aCustomClassVariables, aaItens[nIndex].GetItemType (), aItem )
.head 10 +  Else
.head 11 -  Call aCustomClassVariables.InsertItemAfter( aCustomClassVariables, aaItens[nIndex].GetItemType (), aItem, aItem )
.head 10 -  !
.head 10 -  Set sName =  aaItens[nIndex].GetName ()
.head 10 -  Set sText = aaItens[nIndex].GetText ()
.head 10 -  Call aItem.SetName( sName )
.head 10 -  Call aItem.SetText( sText )
.head 10 +  If aaItens[nIndex].GetItemType () = CDK_IT_ClassObject
.head 11 -  Set sClassName = aaItens[nIndex].GetObjectClass ()
.head 11 -  Call aItem.SetObjectClass( sClassName )
.head 10 -  Set nIndex = nIndex + 1
.head 7 -  Call SalArraySetUpperBound( aaItens, 1, -1 )
.head 7 +  If aClassSource_p.EnumChildObjects( CDK_IT_InstanceVars, aaItens ) > 0
.head 8 +  If not SalArrayIsEmpty( aaItens )
.head 9 -  Call SalArrayGetUpperBound( aaItens, 1, nLastIndex )
.head 9 -  Set nIndex = 0
.head 9 +  While nIndex <= nLastIndex
.head 10 +  If nIndex = 0
.head 11 -  Call aCustomInstanceVariables.InsertFirstItem( aCustomInstanceVariables, aaItens[nIndex].GetItemType (), aItem )
.head 10 +  Else
.head 11 -  Call aCustomInstanceVariables.InsertItemAfter( aCustomInstanceVariables, aaItens[nIndex].GetItemType (), aItem, aItem )
.head 10 -  !
.head 10 -  Set sName =  aaItens[nIndex].GetName ()
.head 10 -  Set sText = aaItens[nIndex].GetText ()
.head 10 -  Call aItem.SetName( sName )
.head 10 -  Call aItem.SetText( sText )
.head 10 +  If aaItens[nIndex].GetItemType () = CDK_IT_ClassObject
.head 11 -  Set sClassName = aaItens[nIndex].GetObjectClass ()
.head 11 -  Call aItem.SetObjectClass( sClassName )
.head 10 -  Set nIndex = nIndex + 1
.head 5 +  Function: ClearFunction
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: aFunction_p
.head 8 -  Class: cdkFunction
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: aItem
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aParent
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: oaItensClear[*]
.head 8 -  Class: cdkItem
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  Number: naSections[*]
.head 7 -  Number: nOutline
.head 7 -  Number: nItem
.head 6 +  Actions
.head 7 -  Set naSections[0] = CDK_IT_Description
.head 7 -  Set naSections[1] = CDK_IT_Returns
.head 7 -  Set naSections[2] = CDK_IT_Parameters
.head 7 -  Set naSections[3] = CDK_IT_StaticVariables
.head 7 -  Set naSections[4] = CDK_IT_LocalVariables
.head 7 -  Set naSections[5] = CDK_IT_ActionsBlock
.head 7 -  !
.head 7 -  Set nOutline = aFunction_p.GetOutline ()
.head 7 -  Set nItem = aFunction_p.GetItem ()
.head 7 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  !
.head 7 -  Set nIndice = 0
.head 7 +  While nItem > 0
.head 8 -  Call aItem.Initialize( nOutline, nItem )
.head 8 -  Call aItem.GetParent( aParent )
.head 8 +  If aParent.GetItemType () = CDK_IT_ClassFunctions
.head 9 -  Break
.head 8 +  If VisArrayFindNumber( naSections, aItem.GetItemType () ) < 0
.head 9 -  Call oaItensClear[nIndice].InitializeFromObject( aItem )
.head 9 -  Set nIndice = nIndice + 1
.head 8 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  !
.head 7 +  If not SalArrayIsEmpty( oaItensClear )
.head 8 -  Call SalArrayGetUpperBound( oaItensClear, 1, nUltimoIndice )
.head 8 -  Set nIndice = nUltimoIndice
.head 8 +  While nIndice >= 0
.head 9 -  Call oaItensClear[nIndice].Delete ()
.head 9 -  Set nIndice = nIndice - 1
.head 7 -  !
.head 5 +  Function: CopyFunction
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: aSource_p
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: aTarget_p
.head 8 -  Class: cdkFunction
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nSourceItem
.head 7 -  Number: nSourceOutline
.head 7 -  Number: nTargetItem
.head 7 -  Number: nTargetOutline
.head 7 -  Number: naSections[*]
.head 7 -  String: sDescription
.head 6 +  Actions
.head 7 -  Set naSections[0] = CDK_IT_Description
.head 7 -  Set naSections[1] = CDK_IT_Returns
.head 7 -  Set naSections[2] = CDK_IT_Parameters
.head 7 -  Set naSections[3] = CDK_IT_StaticVariables
.head 7 -  Set naSections[4] = CDK_IT_LocalVariables
.head 7 -  Set naSections[5] = CDK_IT_ActionsBlock
.head 7 -  !
.head 7 -  Set nSourceOutline = aSource_p.GetOutline ()
.head 7 -  Set nSourceItem = aSource_p.GetItem ()
.head 7 -  !
.head 7 -  Set nTargetOutline = aTarget_p.GetOutline ()
.head 7 -  Set nTargetItem = aTarget_p.GetItem ()
.head 7 -  !
.head 7 -  Call aSource_p.GetAttribute( CDK_IT_Description, sDescription )
.head 7 -  Call aTarget_p.SetAttribute( CDK_IT_Description, sDescription )
.head 7 -  !
.head 7 -  Set nSourceItem = SalOutlineNextLine( nSourceOutline, nSourceItem )
.head 7 -  !
.head 7 -  Call CopyChildreen( aSource_p.GetItem (), nSourceOutline, nSourceItem, naSections, nTargetOutline, nTargetItem, nTargetItem)
.head 7 -  !
.head 5 +  Function: CopyChildreen
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nSourceParent_p
.head 7 -  Receive Number: nSourceOutline_p
.head 7 -  Receive Number: nSourceItem_p
.head 7 -  Receive Number: naSections_p[*]
.head 7 -  Receive Number: nTargetOutline_p
.head 7 -  Number: nTargetParent_p
.head 7 -  Receive Number: nTargetPreviousItem_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: aSourceChild
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aTargetNewItem
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aSourceParent
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aSourceItem
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aTargetParent
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aTargetItem
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aTargetPreviousItem
.head 8 -  Class: cdkItem
.head 7 -  String: sClassName
.head 6 +  Actions
.head 7 -  !
.head 7 +  While nSourceItem_p > 0
.head 8 -  Call aSourceItem.Initialize( nSourceOutline_p, nSourceItem_p)
.head 8 -  Call aSourceItem.GetParent( aSourceParent )
.head 8 -  ! Criterio de parada da funcao
.head 8 +  If aSourceParent.GetItemType () = CDK_IT_ClassFunctions
.head 9 -  Break
.head 8 -  !
.head 8 -  Call aTargetPreviousItem.Initialize( nTargetOutline_p, nTargetPreviousItem_p )
.head 8 -  Call aTargetParent.Initialize( nTargetOutline_p, nTargetParent_p )
.head 8 +  If nSourceParent_p != aSourceParent.GetItem ()
.head 9 -  Break
.head 8 -  ! Se os item analisado for uma das secoes: Inicializa o pai e o anterior do destino
.head 8 +  If VisArrayFindNumber( naSections_p, aSourceItem.GetItemType () ) < 0
.head 9 +  If nTargetParent_p = nTargetPreviousItem_p
.head 10 -  Call aTargetParent.InsertFirstItem( aTargetParent, aSourceItem.GetItemType (), aTargetNewItem )
.head 9 +  Else
.head 10 -  Call aTargetParent.InsertItemAfter( aTargetParent, aSourceItem.GetItemType (), aTargetPreviousItem, aTargetNewItem )
.head 9 -  Call aTargetNewItem.SetText( aSourceItem.GetText () )
.head 9 +  If aSourceItem.GetItemType () = CDK_IT_ClassObject or
   aSourceItem.GetItemType () = CDK_IT_ClassObjectComProxy
.head 10 -  Set sClassName = aSourceItem.GetObjectClass ()
.head 10 -  Call aTargetNewItem.SetObjectClass( sClassName )
.head 9 -  Call aTargetPreviousItem.InitializeFromObject( aTargetNewItem )
.head 9 -  Set nTargetPreviousItem_p = aTargetPreviousItem.GetItem ()
.head 9 -  Set nSourceItem_p =  SalOutlineNextLine( nSourceOutline_p, nSourceItem_p )
.head 9 +  If aSourceItem.GetFirstChild( aSourceChild )
.head 10 -  Call aTargetParent.InitializeFromObject( aTargetNewItem )
.head 10 -  Call CopyChildreen( aSourceItem.GetItem (),  nSourceOutline_p, nSourceItem_p, naSections_p, nTargetOutline_p,   aTargetParent.GetItem () , nTargetPreviousItem_p )
.head 8 +  Else
.head 9 +  If aSourceItem.GetFirstChild( aSourceChild )
.head 10 -  Call aTargetParent.GetChildOfType( aSourceItem.GetItemType (), aTargetPreviousItem, FALSE)
.head 10 -  Set nTargetPreviousItem_p = aTargetPreviousItem.GetItem ()
.head 10 -  Call aTargetParent.GetChildOfType( aSourceItem.GetItemType (), aTargetParent, FALSE )
.head 10 -  Set nSourceItem_p =  SalOutlineNextLine( nSourceOutline_p, nSourceItem_p )
.head 10 -  Call CopyChildreen( aSourceItem.GetItem (),  nSourceOutline_p, nSourceItem_p, naSections_p, nTargetOutline_p, aTargetParent.GetItem (), nTargetPreviousItem_p )
.head 9 +  Else
.head 10 -  Call aTargetParent.GetChildOfType( aSourceItem.GetItemType (), aTargetPreviousItem, FALSE)
.head 10 -  Set nTargetPreviousItem_p = aTargetPreviousItem.GetItem ()
.head 10 -  Set nSourceItem_p =  SalOutlineNextLine( nSourceOutline_p, nSourceItem_p )
.head 5 +  Function: ReplaceTagsFromModel
.head 6 -  Description: Processa o arquivo modelo
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: aItem
.head 8 -  Class: cdkItem
.head 7 -  Number: nIndice
.head 7 -  Number: nOutline
.head 7 -  Number: nItem
.head 7 -  String: sText
.head 7 -  String: sClassName
.head 7 -  !
.head 7 -  FunctionalVar: aFunction
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: aClassFunction
.head 8 -  Class: cdkClass
.head 7 -  FunctionalVar: aActionBlock
.head 8 -  Class: cdkActionBlock
.head 7 -  Number: nType
.head 7 -  Boolean: baSkeepLines[*]
.head 7 -  Number: nIndSkeepLines
.head 6 +  Actions
.head 7 -  ! start at the top
.head 7 +  If aModelFile.GetTopItem( aItem )
.head 8 -  ! get the outline handle
.head 8 -  Set nOutline = aItem.GetOutline()
.head 8 -  Set nIndSkeepLines = -1
.head 8 -  ! get the item handle
.head 8 -  Set nItem = aItem.GetItem()
.head 8 +  While nItem > 0
.head 9 -  Call aItem.Initialize( nOutline, nItem )
.head 9 -  ! Apenas itens que estejam no arquivo aberto. Exclui os itens que vem de outras bibliotecas.
.head 9 +  If Not aItem.IsReadOnly()
.head 10 -  Set sText = aItem.GetText()
.head 10 -  Set sText = SolveTags( sText )
.head 10 -  Set nType = aItem.GetItemType()
.head 10 -  !
.head 10 +  Select Case nType
.head 11 +  Case CDK_IT_ClassFunction
.head 12 -  Call aClassFunction.InitializeFromObject( aItem )
.head 12 -  Break
.head 11 +  Case CDK_IT_Function
.head 12 -  Call aFunction.InitializeFromObject( aItem )
.head 12 -  Break
.head 11 +  Case CDK_IT_ActionsBlock
.head 12 -  Call aActionBlock.InitializeFromObject( aItem )
.head 12 -  Break
.head 11 +  Case CDK_IT_ClassObject
.head 12 -  Set sClassName = aItem.GetObjectClass ()
.head 12 -  Set sClassName = SolveTags( sClassName )
.head 12 -  Call aItem.SetObjectClass( sClassName )
.head 12 -  Break
.head 10 -  !
.head 10 +  If SalStrScan( sText, 'IfCondition' ) >= 0
.head 11 +  If ..OnConditions( oTable )
.head 12 -  Set nIndSkeepLines = nIndSkeepLines + 1
.head 12 -  Set baSkeepLines[nIndSkeepLines] = FALSE
.head 11 +  Else
.head 12 -  Set nIndSkeepLines = nIndSkeepLines + 1
.head 12 -  Set baSkeepLines[nIndSkeepLines] = TRUE
.head 11 -  Set sText = '@$%'
.head 10 +  If SalStrScan( sText, 'ElseCondition' ) >= 0
.head 11 -  Set baSkeepLines[nIndSkeepLines] = not baSkeepLines[nIndSkeepLines]
.head 11 -  Set sText = '@$%'
.head 10 +  If SalStrScan( sText, 'EndCondition' ) >= 0
.head 11 -  Set baSkeepLines[nIndSkeepLines] = FALSE
.head 11 -  Set nIndSkeepLines = nIndSkeepLines - 1
.head 11 -  Set sText = '@$%'
.head 10 -  !
.head 10 +  If nIndSkeepLines >= 0
.head 11 +  If not baSkeepLines[nIndSkeepLines]
.head 12 +  If ..OnCodeTagReplace( oTable, sText, aClassFunction, aFunction, aActionBlock, aItem )
.head 13 -  Set sText = '@$%'
.head 11 +  Else
.head 12 -  Set sText = '@$%'
.head 10 +  Else
.head 11 +  If ..OnCodeTagReplace( oTable, sText, aClassFunction, aFunction, aActionBlock, aItem )
.head 12 -  Set sText = '@$%'
.head 10 -  !
.head 10 -  ! get the next item
.head 10 -  Call aItem.SetText( sText )
.head 9 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: CloseModelFile
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call aModelFile.CloseApp ()
.head 7 -  Call aModelFile.CloseFrameWork ()
.head 5 +  Function: OpenModelFile
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sModelFile_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If aModelFile.InitFromFile( sModelFile_p )
.head 8 -  ! refresh the included stuff (needed if text format)
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: OnCodeTagReplace
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  FunctionalVar: oTable_p
.head 8 -  Class: fcDBTabela
.head 7 -  String: sTag_p
.head 7 -  FunctionalVar: aClass_p
.head 8 -  Class: cdkClass
.head 7 -  FunctionalVar: aFunction_p
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: aActionBlock_p
.head 8 -  Class: cdkActionBlock
.head 7 -  FunctionalVar: aItem_p
.head 8 -  Class: cdkItem
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: OnConditions
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  FunctionalVar: oTable_p
.head 8 -  Class: fcDBTabela
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return TRUE
.head 5 +  Function: OnTagReplace
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: sToken_p
.head 7 -  String: saNames_p[*]
.head 7 -  String: saValues_p[*]
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return ..OnTextTagReplace( oTable, sToken_p, saNames_p, saValues_p )
.head 5 +  Function: OnTextTagReplace
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  FunctionalVar: oTable_p
.head 8 -  Class: fcDBTabela
.head 7 -  String: sToken_p
.head 7 -  String: saNames_p[*]
.head 7 -  String: saValues_p[*]
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return STRING_Null
.head 5 +  Function: MergeFiles
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sPath_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: saClasses[*]
.head 7 -  String: saBibliotecas[*]
.head 7 -  String: saModelFunctionsToAdd[*]
.head 7 -  String: saModelFunctionsToUpdate[*]
.head 7 -  String: saModelProtectedFunctionsToAdd[*]
.head 7 -  String: saModelProtectedFunctionsToChangeParameters[*]
.head 7 -  String: sPreviousCustomFunction
.head 7 -  String: sPrevicouCustomProtectedFunction
.head 7 -  String: sFunctionName
.head 7 -  !
.head 7 -  FunctionalVar: aParent
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aModelFunction
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: aModelClass
.head 8 -  Class: cdkClass
.head 7 -  FunctionalVar: aCustomFunction
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: aPreviousCustomFunction
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: aCustomClass
.head 8 -  Class: cdkClass
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  Number: nIndFunctions
.head 7 -  Number: nUltimoIndFunctions
.head 7 -  FunctionalVar: oaItens[*]
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aLibrary
.head 8 -  Class: cdkLibrary
.head 7 -  Boolean: bLibraryExists
.head 7 -  String: saConditionsAndLibraries[*,2]
.head 7 -  !
.head 6 +  Actions
.head 7 +  If aCustomFile.InitFromFile( sPath_p || oTable.sNOME || '.apl' )
.head 8 -  Call aCustomFile.SetAppDescription(  aModelFile.GetAppDescription () )
.head 8 -  ! Call aCustomFile.RefreshLibraries ()
.head 8 -  !
.head 8 -  ! Verificando/adicionando APLs
.head 8 -  Call aCustomFile.EnumLibraries( saBibliotecas )
.head 8 +  If VisArrayFindString( saBibliotecas, 'SonVariaveis.apl' ) < 0
.head 9 -  Call aCustomFile.AddLibraryFileInclude( 'SonVariaveis.apl', aLibrary )
.head 8 +  If VisArrayFindString( saBibliotecas, 'SonConstantes.apl' ) < 0
.head 9 -  Call aCustomFile.AddLibraryFileInclude( 'SonConstantes.apl', aLibrary )
.head 8 +  If VisArrayFindString( saBibliotecas, 'VtArray.apl' ) < 0
.head 9 -  Call aCustomFile.AddLibraryFileInclude( 'VtArray.apl', aLibrary )
.head 8 -  !
.head 8 -  Set saConditionsAndLibraries[0,0] = 'UsaXML'
.head 8 -  Set saConditionsAndLibraries[0,1] = 'Microsoft XML.apl'
.head 8 -  Set saConditionsAndLibraries[1,0] = 'UsaSerializacao'
.head 8 -  Set saConditionsAndLibraries[1,1] = 'SonSerializaObjeto.apl'
.head 8 -  !
.head 8 +  If not SalArrayIsEmpty( saConditionsAndLibraries )
.head 9 -  Call SalArrayGetUpperBound( saConditionsAndLibraries, 1, nUltimoIndice )
.head 9 -  Set nIndice = 0
.head 9 +  While nIndice <= nUltimoIndice
.head 10 -  Set bLibraryExists =  VisArrayFindString( saBibliotecas, 'Microsoft XML.apl' ) >= 0
.head 10 +  If IsUsed( saConditionsAndLibraries[nIndice, 0] )
.head 11 +  If not bLibraryExists
.head 12 -  Call aCustomFile.AddLibraryFileInclude( saConditionsAndLibraries[nIndice, 1] , aLibrary )
.head 10 +  Else
.head 11 +  If bLibraryExists
.head 12 -  Call aCustomFile.RemoveLibrary( saConditionsAndLibraries[nIndice, 1] )
.head 10 -  Set nIndice = nIndice + 1
.head 8 -  !
.head 8 -  Call aModelFile.EnumClasses( saClasses )
.head 8 +  If not SalArrayIsEmpty( saClasses )
.head 9 -  Call SalArrayGetUpperBound( saClasses, 1, nUltimoIndice )
.head 9 -  Set nIndice = 0
.head 9 +  While nIndice <= nUltimoIndice
.head 10 -  Call aModelFile.GetClass( saClasses[nIndice], aModelClass )
.head 10 +  If not aModelClass.IsReadOnly ()
.head 11 +  If aCustomFile.GetClass( saClasses[nIndice], aCustomClass )
.head 12 -  Call CopyVariables( aModelClass, aCustomClass )
.head 12 -  Set sPreviousCustomFunction = ''
.head 12 -  Call ListDistinctFunctions( aModelClass, aCustomClass, saModelFunctionsToUpdate, sPreviousCustomFunction, saModelFunctionsToAdd, sPrevicouCustomProtectedFunction, saModelProtectedFunctionsToAdd,
saModelProtectedFunctionsToChangeParameters )
.head 12 +  If not SalArrayIsEmpty( saModelFunctionsToUpdate )
.head 13 -  Call SalArrayGetUpperBound( saModelFunctionsToUpdate, 1, nUltimoIndFunctions )
.head 13 -  Set nIndFunctions = 0
.head 13 +  While nIndFunctions <= nUltimoIndFunctions
.head 14 +  If aModelClass.GetFunction( saModelFunctionsToUpdate[nIndFunctions], aModelFunction )
.head 15 +  If aCustomClass.GetFunction( saModelFunctionsToUpdate[nIndFunctions], aCustomFunction )
.head 16 -  Call ClearFunction( aCustomFunction )
.head 16 -  Call CopyFunction( aModelFunction, aCustomFunction )
.head 15 +  Else
.head 16 -  Call aCustomClass.AddFunction( aModelFunction.GetName (), aCustomFunction )
.head 16 -  Call CopyFunction( aModelFunction, aCustomFunction )
.head 14 -  Set nIndFunctions = nIndFunctions + 1
.head 12 +  If not SalArrayIsEmpty( saModelFunctionsToAdd )
.head 13 -  Call aCustomClass.GetFunction( sPreviousCustomFunction, aPreviousCustomFunction )
.head 13 -  Call aPreviousCustomFunction.GetParent( aParent )
.head 13 -  Call SalArrayGetUpperBound( saModelFunctionsToAdd, 1, nUltimoIndFunctions )
.head 13 -  Set nIndFunctions = 0
.head 13 +  While nIndFunctions <= nUltimoIndFunctions
.head 14 +  If aCustomClass.InsertItemAfter( aParent, aPreviousCustomFunction.GetItemType (), aPreviousCustomFunction, aCustomFunction )
.head 15 -  Call aModelClass.GetFunction( saModelFunctionsToAdd[nIndFunctions], aModelFunction )
.head 15 -  Set sFunctionName = aModelFunction.GetName ()
.head 15 -  Call aCustomFunction.SetName( sFunctionName )
.head 15 -  Call CopyFunction( aModelFunction, aCustomFunction )
.head 15 -  Call aPreviousCustomFunction.InitializeFromObject( aCustomFunction )
.head 14 -  Set nIndFunctions = nIndFunctions + 1
.head 12 +  If not SalArrayIsEmpty( saModelProtectedFunctionsToAdd )
.head 13 -  Call aCustomClass.GetFunction( sPrevicouCustomProtectedFunction, aPreviousCustomFunction)
.head 13 -  Call aPreviousCustomFunction.GetParent( aParent )
.head 13 -  Call SalArrayGetUpperBound( saModelProtectedFunctionsToAdd, 1, nUltimoIndFunctions )
.head 13 -  Set nIndFunctions = 0
.head 13 +  While nIndFunctions <= nUltimoIndFunctions
.head 14 +  If aCustomClass.InsertItemAfter( aParent, aPreviousCustomFunction.GetItemType (), aPreviousCustomFunction, aCustomFunction )
.head 15 -  Call aModelClass.GetFunction( saModelProtectedFunctionsToAdd[nIndFunctions], aModelFunction )
.head 15 -  Set sFunctionName = aModelFunction.GetName ()
.head 15 -  Call aCustomFunction.SetName( sFunctionName )
.head 15 -  Call CopyFunction( aModelFunction, aCustomFunction )
.head 15 -  Call aPreviousCustomFunction.InitializeFromObject( aCustomFunction )
.head 14 -  Set nIndFunctions = nIndFunctions + 1
.head 12 +  If not SalArrayIsEmpty( saModelProtectedFunctionsToChangeParameters )
.head 13 -  Call SalArrayGetUpperBound( saModelProtectedFunctionsToChangeParameters, 1, nUltimoIndFunctions )
.head 13 -  Set nIndFunctions = 0
.head 13 +  While nIndFunctions <= nUltimoIndFunctions
.head 14 +  If aModelClass.GetFunction( saModelProtectedFunctionsToChangeParameters[nIndFunctions], aModelFunction )
.head 15 +  If aCustomClass.GetFunction( saModelProtectedFunctionsToChangeParameters[nIndFunctions], aCustomFunction )
.head 16 -  Call CopyParameters( aModelFunction, aCustomFunction )
.head 14 -  Set nIndFunctions = nIndFunctions + 1
.head 10 -  Set nIndice = nIndice + 1
.head 8 -  !
.head 8 -  Call aCustomFile.SaveOutlineAsText( sPath_p || oTable.sNOME || '.apl' , FALSE )
.head 8 -  Call aCustomFile.CloseApp ()
.head 5 +  Function: CheckClassesConditionsUsed
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  FunctionalVar: oTable_p
.head 8 -  Class: fcDBTabela
.head 7 -  String: sPath_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: saClasses[*]
.head 7 -  String: saCustomFunctions[*]
.head 7 -  !
.head 7 -  FunctionalVar: aCustomFunction
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: aCustomClass
.head 8 -  Class: cdkClass
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  Number: nIndConditions
.head 7 -  Number: nUltimoIndConditions
.head 7 -  !
.head 7 -  Number: nLenPath
.head 6 +  Actions
.head 7 -  Set nLenPath = SalStrLength( sPath_p )
.head 7 +  If VisStrScanReverse( sPath_p, -1, '\\' ) != nLenPath - 1
.head 8 -  Set sPath_p = sPath_p || '\\'
.head 7 -  Set oTable = oTable_p
.head 7 -  !
.head 7 -  ! Nenhuma das funções da lista foram encontradas inicialmente
.head 7 +  If not SalArrayIsEmpty( oaConditions )
.head 8 -  Call SalArrayGetUpperBound( oaConditions, 1, nUltimoIndConditions  )
.head 8 -  Set nIndConditions = 0
.head 8 +  While nIndConditions <= nUltimoIndConditions
.head 9 -  Set oaConditions[nIndConditions].bUse= FALSE
.head 9 -  Set nIndConditions = nIndConditions + 1
.head 7 -  !
.head 7 +  If aCustomFile.InitFromFile( sPath_p || oTable.sNOME || '.apl' )
.head 8 -  !
.head 8 -  Call aCustomFile.EnumClasses( saClasses )
.head 8 +  If not SalArrayIsEmpty( saClasses )
.head 9 -  Call SalArrayGetUpperBound( saClasses, 1, nUltimoIndice )
.head 9 -  Set nIndice = 0
.head 9 +  While nIndice <= nUltimoIndice
.head 10 -  Call aCustomFile.GetClass( saClasses[nIndice], aCustomClass )
.head 10 +  If not aCustomClass.IsReadOnly ()
.head 11 -  Call SalArraySetUpperBound( saCustomFunctions, 1, -1 )
.head 11 +  If aCustomClass.EnumFunctions( saCustomFunctions ) > 0
.head 12 +  If not SalArrayIsEmpty( oaConditions )
.head 13 -  Call SalArrayGetUpperBound( oaConditions, 1, nUltimoIndConditions)
.head 13 -  Set nIndConditions = 0
.head 13 +  While nIndConditions <= nUltimoIndConditions
.head 14 +  If not oaConditions[nIndConditions].bUse
.head 15 -  Set oaConditions[nIndConditions].bUse = VisArrayFindString( saCustomFunctions, oaConditions[nIndConditions].saFunctions[0] ) >= 0
.head 14 -  Set nIndConditions = nIndConditions + 1
.head 10 -  Set nIndice = nIndice + 1
.head 8 -  !
.head 8 -  Call aCustomFile.CloseApp ()
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: DeleteUnusedFunctions
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sPath_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: saClasses[*]
.head 7 -  String: saCustomFunctions[*]
.head 7 -  !
.head 7 -  FunctionalVar: aCustomFunction
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: aCustomClass
.head 8 -  Class: cdkClass
.head 7 -  Number: nIndex
.head 7 -  Number: nLastIndex
.head 7 -  Number: nIndConditions
.head 7 -  Number: nLastIndConditions
.head 7 -  Number: nIndFunction
.head 7 -  Number: nLastIndFunction
.head 7 -  !
.head 7 -  Number: nLenPath
.head 6 +  Actions
.head 7 -  !
.head 7 +  If aCustomFile.InitFromFile( sPath_p || oTable.sNOME || '.apl' )
.head 8 -  !
.head 8 -  Call aCustomFile.EnumClasses( saClasses )
.head 8 +  If not SalArrayIsEmpty( saClasses )
.head 9 -  Call SalArrayGetUpperBound( saClasses, 1, nLastIndex )
.head 9 -  Set nIndex = 0
.head 9 +  While nIndex <= nLastIndex
.head 10 -  Call aCustomFile.GetClass( saClasses[nIndex], aCustomClass )
.head 10 +  If not aCustomClass.IsReadOnly ()
.head 11 -  Call SalArraySetUpperBound( saCustomFunctions, 1, -1 )
.head 11 +  If aCustomClass.EnumFunctions( saCustomFunctions ) > 0
.head 12 +  If not SalArrayIsEmpty( oaConditions )
.head 13 -  Call SalArrayGetUpperBound( oaConditions, 1, nLastIndConditions)
.head 13 -  Set nIndConditions = 0
.head 13 +  While nIndConditions <= nLastIndConditions
.head 14 +  If not oaConditions[nIndConditions].bUse
.head 15 +  If not SalArrayIsEmpty( oaConditions[nIndConditions].saFunctions )
.head 16 -  Call SalArrayGetUpperBound( oaConditions[nIndConditions].saFunctions, 1, nLastIndFunction )
.head 16 -  Set nIndFunction = 0
.head 16 +  While nIndFunction <= nLastIndFunction
.head 17 +  If VisArrayFindString( saCustomFunctions, oaConditions[nIndConditions].saFunctions[nIndFunction] ) >= 0
.head 18 -  Call aCustomClass.GetFunction( oaConditions[nIndConditions].saFunctions[nIndFunction], aCustomFunction )
.head 18 -  Call aCustomFunction.Delete ()
.head 17 -  Set nIndFunction = nIndFunction + 1
.head 14 -  Set nIndConditions = nIndConditions + 1
.head 10 -  Set nIndex = nIndex + 1
.head 8 -  !
.head 8 -  Call aCustomFile.SaveOutlineAsText( sPath_p || oTable.sNOME || '.apl' , FALSE )
.head 8 -  Call aCustomFile.CloseApp ()
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: RemoveTextTags
.head 6 -  Description: Processa o arquivo modelo
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: aItem
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: oaItensDelete[*]
.head 8 -  Class: cdkItem
.head 7 -  Number: nOutline
.head 7 -  Number: nItem
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 6 +  Actions
.head 7 -  ! start at the top
.head 7 -  Call aModelFile.GetTopItem( aItem )
.head 7 -  ! refresh the included stuff (needed if text format)
.head 7 -  Set nOutline = aItem.GetOutline()
.head 7 -  ! get the item handle
.head 7 -  Set nItem = aItem.GetItem ()
.head 7 -  Set nIndice = 0
.head 7 +  While nItem > 0
.head 8 -  Call aItem.Initialize( nOutline, nItem )
.head 8 -  ! Apenas itens que estejam no arquivo aberto. Ignora os itens que vem de outras bibliotecas.
.head 8 +  If Not aItem.IsReadOnly()
.head 9 +  If SalStrScan( aItem.GetText (), '@$%' ) >= 0
.head 10 -  Call oaItensDelete[nIndice].InitializeFromObject( aItem )
.head 10 -  Set nIndice = nIndice + 1
.head 8 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 7 -  !
.head 7 +  If not SalArrayIsEmpty( oaItensDelete )
.head 8 -  Call SalArrayGetUpperBound( oaItensDelete, 1, nUltimoIndice )
.head 8 -  Set nIndice = nUltimoIndice
.head 8 +  While nIndice >= 0
.head 9 -  Call oaItensDelete[nIndice].Delete ()
.head 9 -  Set nIndice = nIndice - 1
.head 5 +  Function: SaveClass
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sPath_p
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call aModelFile.SaveOutlineAsText( sPath_p || oTable.sNOME || '.apl' , FALSE )
.head 5 +  Function: GearClass
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  FunctionalVar: oTable_p
.head 8 -  Class: fcDBTabela
.head 7 -  String: sPath_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nLenPath
.head 6 +  Actions
.head 7 -  Set nLenPath = SalStrLength( sPath_p )
.head 7 +  If VisStrScanReverse( sPath_p, -1, '\\' ) != nLenPath - 1
.head 8 -  Set sPath_p = sPath_p || '\\'
.head 7 -  Set oTable = oTable_p
.head 7 +  If ReplaceTagsFromModel ()
.head 8 -  Call RemoveTextTags ()
.head 8 +  If VisDosExist( sPath_p || oTable.sNOME || '.apl' )
.head 9 -  Call MergeFiles ( sPath_p )
.head 9 -  Call DeleteUnusedFunctions( sPath_p )
.head 8 +  Else
.head 9 -  Call SaveClass ( sPath_p )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: CopyParameters
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  FunctionalVar: aSourceFunction_p
.head 8 -  Class: cdkFunction
.head 7 -  FunctionalVar: aTargetFunction_p
.head 8 -  Class: cdkFunction
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: saParameters[*]
.head 7 -  String: saTypeParameters[*]
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 7 -  FunctionalVar: aSourceItem
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aTargetItem
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aSectionParameters
.head 8 -  Class: cdkItem
.head 7 -  String: sName
.head 7 -  String: sText
.head 7 -  String: sClassName
.head 6 +  Actions
.head 7 +  If aTargetFunction_p.EnumParameters( saParameters, saTypeParameters ) > 0
.head 8 +  If not SalArrayIsEmpty( saParameters )
.head 9 -  Call SalArrayGetUpperBound( saParameters, 1, nUltimoIndice )
.head 9 -  Set nIndice = 0
.head 9 +  While nIndice <= nUltimoIndice
.head 10 -  Call aTargetFunction_p.DeleteChildObjectByName( CDK_IT_Parameters, saParameters[nIndice] )
.head 10 -  Set nIndice = nIndice + 1
.head 7 -  !
.head 7 -  Call SalArraySetUpperBound( saParameters, 1, -1 )
.head 7 -  Call SalArraySetUpperBound( saTypeParameters, 1, -1 )
.head 7 +  If aSourceFunction_p.EnumParameters( saParameters, saTypeParameters ) > 0
.head 8 +  If not SalArrayIsEmpty( saParameters )
.head 9 -  Call aTargetFunction_p.GetChildOfType( CDK_IT_Parameters, aSectionParameters, FALSE )
.head 9 -  Call SalArrayGetUpperBound( saParameters, 1, nUltimoIndice )
.head 9 -  Set nIndice = 0
.head 9 +  While nIndice <= nUltimoIndice
.head 10 -  Call aSourceFunction_p.GetChildObjectByName( CDK_IT_Parameters, saParameters[nIndice], aSourceItem )
.head 10 +  If nIndice = 0
.head 11 -  Call aSectionParameters.InsertFirstItem( aSectionParameters, aSourceItem.GetItemType (), aTargetItem )
.head 10 +  Else
.head 11 -  Call aSectionParameters.InsertItemAfter( aSectionParameters, aSourceItem.GetItemType (), aTargetItem, aTargetItem )
.head 10 -  Set sName = aSourceItem.GetName ()
.head 10 -  Call aTargetItem.SetName ( sName )
.head 10 -  Set sText = aSourceItem.GetText ()
.head 10 -  Call aTargetItem.SetText( sText )
.head 10 +  If aSourceItem.GetItemType () = CDK_IT_ClassObject
.head 11 -  Set sClassName = aSourceItem.GetClassName ()
.head 11 -  Call aTargetItem.SetObjectClass( sClassName )
.head 10 -  Set nIndice = nIndice + 1
.head 5 +  Function: LoadClassesConditions
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sModelFile_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bConditionBegin
.head 7 -  Boolean: bConditionEnd
.head 7 -  Number: nPosEqual
.head 7 -  String: sText
.head 7 -  Number: nOutline
.head 7 -  Number: nItem
.head 7 -  FunctionalVar: aItem
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aParent
.head 8 -  Class: cdkItem
.head 7 -  FunctionalVar: aModelClass
.head 8 -  Class: cdkClass
.head 7 -  Number: nType
.head 7 -  !
.head 7 -  Number: nIndConditions
.head 7 -  String: sCondition
.head 7 -  String: saClasses[*]
.head 7 -  !
.head 7 -  Number: nIndice
.head 7 -  Number: nUltimoIndice
.head 6 +  Actions
.head 7 +  If OpenModelFile(  sModelFile_p )
.head 8 -  Call SalArraySetUpperBound( oaConditions, 1, -1 )
.head 8 -  Set nIndConditions = 0
.head 8 -  !
.head 8 -  Call aModelFile.EnumClasses( saClasses )
.head 8 +  If not SalArrayIsEmpty( saClasses )
.head 9 -  Call SalArrayGetUpperBound( saClasses, 1, nUltimoIndice )
.head 9 -  Set nIndice = 0
.head 9 +  While nIndice <= nUltimoIndice
.head 10 -  Call aModelFile.GetClass( saClasses[nIndice], aModelClass )
.head 10 +  If not aModelClass.IsReadOnly ()
.head 11 -  !
.head 11 -  Set nOutline =  aModelClass.GetOutline ()
.head 11 -  Set nItem = aModelClass.GetItem ()
.head 11 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 11 +  While nItem > 0
.head 12 -  Call aItem.Initialize( nOutline, nItem )
.head 12 -  Call aItem.GetParent( aParent )
.head 12 +  If aParent.GetItemType () = CDK_IT_ClassDefinitions
.head 13 -  Break
.head 12 +  If not aItem.IsReadOnly ()
.head 13 +  If aParent.GetItemType () = CDK_IT_ClassFunctions
.head 14 -  Set sText = aItem.GetText()
.head 14 +  If SalStrScan( sText, 'IfCondition' ) >= 0
.head 15 -  Set nPosEqual = SalStrScan( sText, '>')
.head 15 -  Set sText = SalStrReplaceX( sText, nPosEqual, 1, '' )
.head 15 -  Set nPosEqual = SalStrScan( sText, '=' )
.head 15 -  Set sCondition = SalStrRightX( sText, SalStrLength( sText ) - nPosEqual - 1)
.head 15 -  Set oaConditions[nIndConditions].sCondition = SalStrTrimX (sCondition )
.head 15 -  !
.head 15 -  Set bConditionBegin = TRUE
.head 15 -  Set bConditionEnd = FALSE
.head 14 +  If SalStrScan( sText, 'EndCondition' ) >= 0
.head 15 -  Set bConditionBegin = FALSE
.head 15 -  Set bConditionEnd = TRUE
.head 15 -  Set nIndConditions = nIndConditions + 1
.head 14 +  If bConditionBegin
.head 15 -  Set nType = aItem.GetItemType ()
.head 15 +  If nType = CDK_IT_Function
.head 16 -  Call oaConditions[nIndConditions].AddFunction( aItem.GetName () )
.head 14 +  If bConditionEnd
.head 15 -  Set bConditionBegin = FALSE
.head 15 -  Set bConditionEnd = FALSE
.head 12 -  Set nItem = SalOutlineNextLine( nOutline, nItem )
.head 10 -  Set nIndice = nIndice + 1
.head 8 -  !
.head 8 -  Call CloseModelFile ()
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return FALSE
.head 5 +  Function: IsUsed
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sConditon_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 7 -  Number: nLastIndex
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaConditions )
.head 8 -  Call SalArrayGetUpperBound( oaConditions, 1, nLastIndex )
.head 8 -  Set nIndex = 0
.head 8 +  While nIndex <= nLastIndex
.head 9 +  If oaConditions[nIndex].sCondition = sConditon_p
.head 10 -  Return oaConditions[nIndex].bUse
.head 9 -  Set nIndex = nIndex + 1
.head 7 -  !
.head 7 -  Return FALSE
.head 5 +  Function: SetUse
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sConditon_p
.head 7 -  Boolean: bUse_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndex
.head 7 -  Number: nLastIndex
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( oaConditions )
.head 8 -  Call SalArrayGetUpperBound( oaConditions, 1, nLastIndex )
.head 8 -  Set nIndex = 0
.head 8 +  While nIndex <= nLastIndex
.head 9 +  If oaConditions[nIndex].sCondition = sConditon_p
.head 10 -  Set oaConditions[nIndex].bUse = bUse_p
.head 10 -  Return TRUE
.head 9 -  Set nIndex = nIndex + 1
.head 7 -  !
.head 7 -  Return FALSE
.head 3 +  Dialog Box Class: dlgCodeGear
.head 4 -  Title:
.head 4 -  Accessories Enabled? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Display Settings
.head 5 -  Display Style? Class Default
.head 5 -  Visible at Design time? Yes
.head 5 -  Type of Dialog: Class Default
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Absolute Screen Location? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Next Class Child Key: 0
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Tool Bar
.head 5 -  Display Settings
.head 6 -  Display Style? Class Default
.head 6 -  Location? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Size: Class Default
.head 6 -  Size Editable? Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 5 -  Contents
.head 4 -  Contents
.head 4 +  Derived From
.head 5 -  Class: cCodeGeneration
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 -  Functions
.head 4 -  Message Actions
.head 3 +  Functional Class: cCondition
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sCondition
.head 5 -  String: saFunctions[*]
.head 5 -  Boolean: bUse
.head 4 +  Functions
.head 5 +  Function: AddFunction
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sFunction_p
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nIndice
.head 6 +  Actions
.head 7 +  If not SalArrayIsEmpty( saFunctions )
.head 8 -  Call SalArrayGetUpperBound( saFunctions, 1, nIndice )
.head 8 -  Set nIndice = nIndice + 1
.head 7 +  Else
.head 8 -  Set nIndice = 0
.head 7 -  !
.head 7 -  Set saFunctions[nIndice] = sFunction_p
.head 3 +  Functional Class: cErro
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fcDBObjeto
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nTipoErro[*]
.head 5 -  String: sMessage[*]
.head 4 +  Functions
.head 5 +  Function: Initialize
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If Not bInitialized
.head 8 -  Call Reset( )
.head 8 -  Return TRUE
.head 7 +  Else
.head 8 -  Return TRUE
.head 5 +  Function: Reset
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( sMessage, 1, -1 )
.head 7 -  Return TRUE
.head 5 +  Function: GetMessage
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return sMessage[nIndex]
.head 5 +  Function: GetErro
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: nIndex
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return nTipoErro[nIndex]
.head 5 +  Function: GetQtdeErro
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 -  Call SalArrayGetUpperBound( sMessage, 1, nMax )
.head 7 +  If SalStrTrimX( sMessage[nMax] ) != ''
.head 8 -  Set nMax = nMax + 1
.head 7 -  Return nMax
.head 5 +  Function: AddMessage
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nErro
.head 7 -  String: sErro
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMax
.head 6 +  Actions
.head 7 -  Set nMax = GetQtdeErro()
.head 7 -  Set nTipoErro[nMax] = nErro
.head 7 -  Set sMessage[nMax] = sErro
.head 5 +  Function: ShowError
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 6 +  Actions
.head 7 +  If GetQtdeErro( ) > 0
.head 8 -  ! Set bOk = SalSendMsg( hWndForm, PAM_ShowError, 0, 0 )
.head 8 -  Call Reset( )
.head 8 -  Return Not bOk
.head 7 -  Return FALSE
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 3 -  ActiveX:
.head 2 -  Application Actions
.head 1 +  Dialog Box: dlgSeleciona
.head 2 -  Class: pcDialogDefault
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Modulo de Seleção
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: 1.113"
.head 4 -  Top: 0.573"
.head 4 -  Width:  9.583"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.155"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Dialog Box de consulta em base de dados. Deve ser usada para visualizar
os registro de determinado arquivo.  Retornará TRUE caso um registro
tenha sido escolhido e o valor retornado estará no último parâmetro da
função
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: White
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblRecords
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: -0.017"
.head 6 -  Top: 0.321"
.head 6 -  Width:  9.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.524"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? No
.head 4 -  Contents
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set nLinha = 0
.head 6 -  Call SalArrayGetUpperBound( naTamanhoCol, 1, nMax )
.head 6 -  Set nColunas = nMax+1
.head 6 -  Set nUltimo = 0
.head 6 +  While nLinha <= nMax
.head 7 -  Call SalTblCreateColumn( hWndItem, 0, ( naTamanhoCol[ nLinha ]/2.54 ), 1, saTituloCol[ nLinha ] )
.head 7 +  If naTamanhoCol[ nLinha ] > 0
.head 8 -  Call SalListAdd( cmbOrdem, saTituloCol[ nLinha ] )
.head 7 -  Set nLinha = nLinha + 1
.head 6 -  Call SalTblPopulate( hWndItem, hSqlAux, sConsulta, TBL_FillNormal )
.head 6 -  Set nLinha = 1
.head 6 +  While TRUE
.head 7 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nLinha, COL_GetPos )
.head 7 -  Call SalDisableWindow( hWndCol )
.head 7 +  If hWndCol = hWndNULL
.head 8 -  Break
.head 7 -  Set nLinha = nLinha + 1
.head 6 -  Set nLinha = 0
.head 6 -  Set nLinhaTabela = 0
.head 6 -  Set nMax = nUltimo - 1
.head 6 +  While SalTblSetContext( hWndItem, nLinhaTabela )
.head 7 -  Set nLinha = 1
.head 7 +  While TRUE
.head 8 -  Set hWndCol = SalTblGetColumnWindow( hWndItem, nLinha, COL_GetPos )
.head 8 +  If saFormatoCol[nLinha-1] != ''
.head 9 +  If SalIsValidNumber( hWndCol )
.head 10 -  Call SalTblGetColumnText( hWndItem, nLinha, sValor )
.head 10 -  Set dfNumero = SalStrToNumber( sValor )
.head 10 -  Call SalTblSetColumnText( hWndItem, nLinha, SalFmtFormatNumber( dfNumero, saFormatoCol[nLinha-1] ) )
.head 9 +  Else If SalIsValidDateTime( hWndCol )
.head 10 -  Call SalTblGetColumnText( hWndItem, nLinha, sValor )
.head 10 -  Set dfData = SalStrToDate( sValor )
.head 10 -  Call SalTblSetColumnText( hWndItem, nLinha, SalFmtFormatDateTime( dfData, saFormatoCol[nLinha-1] ) )
.head 8 -  Call SalDisableWindow( hWndCol )
.head 8 +  If hWndCol = hWndNULL
.head 9 -  Break
.head 8 -  Set nLinha = nLinha + 1
.head 7 -  Set nLinhaTabela = nLinhaTabela + 1
.head 6 -  Call SalTblSetContext( hWndItem, 0 )
.head 6 -  Call SalDisableWindow( pbOk )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If SalTblAnyRows( tblRecords, 0 , 0 )
.head 7 -  Call SalSendMsg( hWndItem, SAM_Click, wParam, lParam )
.head 7 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(tblRecords, SAM_RowHeaderDoubleClick, 0, 0)
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalEnableWindow( pbOk )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 51
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pcDialogDefault
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 6.733"
.head 5 -  Top: 3.917"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SetValores( )  ! preenche o valor dos campos passados no vetor
.head 6 -  Call SalEndDialog( hWndForm,TRUE )
.head 3 +  Pushbutton: pbCancela
.head 4 -  Class Child Ref Key: 24
.head 4 -  Class ChildKey: 0
.head 4 -  Class: pcDialogDefault
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 8.133"
.head 5 -  Top: 3.917"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Ordenar por:
.head 4 -  Resource Id: 56667
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.133"
.head 5 -  Top: 0.095"
.head 5 -  Width:  1.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: White
.head 3 -  Background Text: Buscar:
.head 4 -  Resource Id: 56668
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.317"
.head 5 -  Top: 0.095"
.head 5 -  Width:  0.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: White
.head 3 +  Combo Box: cmbOrdem
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.233"
.head 5 -  Top: 0.06"
.head 5 -  Width:  3.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.595"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not SalIsNull( cmbOrdem ) and sOrdem != cmbOrdem
.head 7 +  If 1     !not SalTblSortRows( tblRecords, SalListQuerySelection( cmbOrdem )+1, TBL_SortIncreasing  )
.head 8 -  ! Call SonOrdenaTabela( tblRecords, SalListQuerySelection( cmbOrdem )+1, nColunas )
.head 8 -  Call SalTblSortRows( tblRecords, SalListQuerySelection( cmbOrdem )+1, TBL_SortIncreasing  )
.head 7 -  Call SalTblSetFlagsAnyRows( tblRecords, ROW_New, FALSE, 0, 0 )
.head 6 -  Call SalClearField( dfBusca )
.head 6 -  Call SalEnableWindow( dfBusca )
.head 6 -  Call SalSetFocus( dfBusca )
.head 5 +  On SAM_SetFocus
.head 6 -  Set sOrdem = cmbOrdem
.head 5 +  On SAM_Create
.head 6 -  Call SalSetFocus( hWndItem )
.head 3 +  Data Field: dfBusca
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 5.983"
.head 6 -  Top: 0.06"
.head 6 -  Width:  3.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: System Window Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 +  If Not SalIsNull( dfBusca )
.head 7 +  If SalStrLength( dfBusca ) > nLengthAchou
.head 8 -  Set nLinha = nLinhaAchou
.head 7 +  Else
.head 8 -  Set nLinha = 0
.head 8 -  Set nLinhaAchou = 0
.head 8 -  Set nLengthAchou = 0
.head 7 +  While SalTblSetContext( tblRecords, nLinha )
.head 8 -  Call SalTblGetColumnText( tblRecords, SalListQuerySelection( cmbOrdem )+1, sData )
.head 8 +  If SalStrUpperX( dfBusca ) = SalStrUpperX( SalStrLeftX( sData, SalStrLength( dfBusca ) ) )
.head 9 -  Call SalTblScroll( tblRecords, nLinha, hWndNULL, TBL_AutoScroll )
.head 9 -  Call SalTblSetFlagsAnyRows ( tblRecords, ROW_Selected, FALSE, 0, 0 )
.head 9 -  Call SalTblSetRowFlags ( tblRecords, nLinha, ROW_Selected, TRUE )
.head 9 -  Call SalSendMsg( tblRecords, SAM_RowHeaderClick, 0, 0 )
.head 9 -  Set nLinhaAchou = nLinha
.head 9 -  Set nLengthAchou = SalStrLength( dfBusca )
.head 9 -  Break
.head 8 -  Set nLinha = nLinha + 1
.head 5 +  On PAM_Reset
.head 6 -  Call SalDisableWindow( hWndItem )
.head 3 +  Data Field: dfData
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: Default
.head 6 -  Top: Default
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNumero
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: Default
.head 6 -  Top: Default
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: InverteStrDataStr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sData
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDia
.head 5 -  String: sMes
.head 5 -  String: sAno
.head 5 -  Date/Time: dtDataTemp
.head 4 +  Actions
.head 5 -  Set dtDataTemp = SalStrToDate( sData )
.head 5 -  Set sDia = SalNumberToStrX( SalDateDay( dtDataTemp ), 0 )
.head 5 -  Set sMes = SalNumberToStrX( SalDateMonth( dtDataTemp ), 0 )
.head 5 -  Set sAno = SalNumberToStrX( SalDateYear( dtDataTemp ), 0 )
.head 5 +  If SalDateDay( dtDataTemp ) < 10
.head 6 -  Set sDia = '0' || SalNumberToStrX( SalDateDay( dtDataTemp ), 0 )
.head 5 +  If SalDateMonth( dtDataTemp ) < 10
.head 6 -  Set sMes = '0' || SalNumberToStrX( SalDateMonth( dtDataTemp ), 0 )
.head 5 -  Set sData = sDia||'-'||sMes||'-'||sAno
.head 5 -  Return sData
.head 3 +  Function: SetValores
.head 4 -  Description: percorre o vetor de objetos atribuindo a eles os valores dos campos
da linha escolhida na tabela
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndCol
.head 5 -  Number: nNroCampos
.head 5 -  Number: nCampo
.head 4 +  Actions
.head 5 -  Set hWndCol = SalGetFirstChild( tblRecords, TYPE_TableColumn )
.head 5 -  Call SalArrayGetUpperBound( haWndFields, 1, nNroCampos )
.head 5 -  Set nCampo = 0
.head 5 +  While nCampo <= nNroCampos
.head 6 -  Call SalTblGetColumnText( tblRecords, nCampo + 1, sValor )
.head 6 -  Set sValor = SalStrTrimX( sValor )
.head 6 -  Call SalSetWindowText( haWndFields[ nCampo ], sValor  )
.head 6 -  Call SalSendMsg( haWndFields[ nCampo ], SAM_AnyEdit, 0, 0 )
.head 6 -  Set hWndCol = SalGetNextChild( hWndCol, TYPE_TableColumn )
.head 6 -  Call SalDisableWindow( hWndCol )
.head 6 -  Set nCampo = nCampo + 1
.head 2 +  Window Parameters
.head 3 +  String: cTitulo
.head 4 -  ! Titulo a ser apresentado no cabeçalho da lista de registro
.head 3 +  Sql Handle: hSqlAux
.head 4 -  ! handle da conecção com a base de dados
.head 3 +  String: sConsulta
.head 4 -  ! Consulta Sql a ser executada para prencher o listbox
.head 2 +  Window Variables
.head 3 -  Number: nColunas
.head 3 -  Number: nRow
.head 3 -  Number: nMax
.head 3 -  Number: nLinha
.head 3 -  String: sValor
.head 3 -  String: sOrdem
.head 3 -  String: sData
.head 3 -  Number: nLinhaTabela
.head 3 -  Number: nUltimo
.head 3 -  Number: nLengthAchou
.head 3 -  Number: nLinhaAchou
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText( hWndForm, cTitulo )
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendClassMessage( SAM_CreateComplete, 0, 0 )
.head 4 +  If nOrdemCol != NUMBER_Null
.head 5 -  Call SalListSetSelect( cmbOrdem, nOrdemCol )
.head 5 -  Call SalEnableWindow( dfBusca )
.head 5 -  Call SalSetFocus( dfBusca )
.head 3 +  On SAM_Destroy
.head 4 -  Call SalArraySetUpperBound( haWndFields, 1, -1 )
.head 4 -  Call SalArraySetUpperBound( saTituloCol, 1, -1 )
.head 4 -  Call SalArraySetUpperBound( naTamanhoCol, 1, -1 )
.head 4 -  Call SalArraySetUpperBound( saFormatoCol, 1, -1 )
.head 4 -  Set nOrdemCol = NUMBER_Null
